# Execution stats for each query

- [AirlineData](#AirlineData)
- [AirlineData_ARR_DELAY](#AirlineData_ARR_DELAY)
- [AirlineData_ARR_DELAY_range](#AirlineData_ARR_DELAY_range)
- [AirlineData_DEST](#AirlineData_DEST)
- [AirlineData_DEST_range](#AirlineData_DEST_range)
- [AirlineData_FL_DATE](#AirlineData_FL_DATE)
- [AirlineData_FL_DATE_range](#AirlineData_FL_DATE_range)
- [AirlineData_MKT_UNIQUE_CARRIER](#AirlineData_MKT_UNIQUE_CARRIER)
- [AirlineData_MKT_UNIQUE_CARRIER_range](#AirlineData_MKT_UNIQUE_CARRIER_range)
- [AirlineData_ORIGIN](#AirlineData_ORIGIN)
- [AirlineData_ORIGIN_range](#AirlineData_ORIGIN_range)
- [AirlineData_X](#AirlineData_X)
- [AirlineData_range](#AirlineData_range)

## AirlineData<a name="AirlineData"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 1007,
            "totalKeysExamined": 0,
            "totalDocsExamined": 372498,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 293,
               "works": 372500,
               "advanced": 0,
               "needTime": 372499,
               "needYield": 0,
               "saveState": 373,
               "restoreState": 373,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 293,
                  "works": 372500,
                  "advanced": 0,
                  "needTime": 372499,
                  "needYield": 0,
                  "saveState": 373,
                  "restoreState": 373,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 372498
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 1129,
            "totalKeysExamined": 0,
            "totalDocsExamined": 364605,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 331,
               "works": 364607,
               "advanced": 1,
               "needTime": 364605,
               "needYield": 0,
               "saveState": 365,
               "restoreState": 365,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 329,
                  "works": 364607,
                  "advanced": 1,
                  "needTime": 364605,
                  "needYield": 0,
                  "saveState": 365,
                  "restoreState": 365,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 364605
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 1253,
            "totalKeysExamined": 0,
            "totalDocsExamined": 372316,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 370,
               "works": 372318,
               "advanced": 1,
               "needTime": 372316,
               "needYield": 0,
               "saveState": 373,
               "restoreState": 373,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 370,
                  "works": 372318,
                  "advanced": 1,
                  "needTime": 372316,
                  "needYield": 0,
                  "saveState": 373,
                  "restoreState": 373,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 372316
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425309,
         "i": 984
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425309,
            "i": 984
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372316,
                     "executionTimeMillis": 1738,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372316,
                        "executionTimeMillisEstimate": 365,
                        "works": 372318,
                        "advanced": 372316,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 394,
                        "restoreState": 394,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372316,
                           "executionTimeMillisEstimate": 304,
                           "works": 372318,
                           "advanced": 372316,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 394,
                           "restoreState": 394,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372316,
                              "executionTimeMillisEstimate": 70,
                              "works": 372318,
                              "advanced": 372316,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 394,
                              "restoreState": 394,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 372316,
               "executionTimeMillisEstimate": 1373
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1736
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 364605,
                     "executionTimeMillis": 1751,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 364605,
                        "executionTimeMillisEstimate": 416,
                        "works": 364607,
                        "advanced": 364605,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 386,
                        "restoreState": 386,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 364605,
                           "executionTimeMillisEstimate": 369,
                           "works": 364607,
                           "advanced": 364605,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 386,
                           "restoreState": 386,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 364605,
                              "executionTimeMillisEstimate": 71,
                              "works": 364607,
                              "advanced": 364605,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 386,
                              "restoreState": 386,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 364605,
               "executionTimeMillisEstimate": 1354
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1743
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372498,
                     "executionTimeMillis": 1895,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372498,
                        "executionTimeMillisEstimate": 454,
                        "works": 372500,
                        "advanced": 372498,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 393,
                        "restoreState": 393,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372498,
                           "executionTimeMillisEstimate": 306,
                           "works": 372500,
                           "advanced": 372498,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 393,
                           "restoreState": 393,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372498,
                              "executionTimeMillisEstimate": 76,
                              "works": 372500,
                              "advanced": 372498,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 393,
                              "restoreState": 393,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 372498,
               "executionTimeMillisEstimate": 1488
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1893
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425311,
         "i": 493
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425311,
            "i": 493
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372316,
                     "executionTimeMillis": 1071,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372316,
                        "executionTimeMillisEstimate": 121,
                        "works": 372318,
                        "advanced": 372316,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 387,
                        "restoreState": 387,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372316,
                           "executionTimeMillisEstimate": 100,
                           "works": 372318,
                           "advanced": 372316,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 387,
                           "restoreState": 387,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372316,
                              "executionTimeMillisEstimate": 19,
                              "works": 372318,
                              "advanced": 372316,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 387,
                              "restoreState": 387,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 372316,
               "executionTimeMillisEstimate": 831
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1069
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 364605,
                     "executionTimeMillis": 1093,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 364605,
                        "executionTimeMillisEstimate": 91,
                        "works": 364607,
                        "advanced": 364605,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 379,
                        "restoreState": 379,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 364605,
                           "executionTimeMillisEstimate": 75,
                           "works": 364607,
                           "advanced": 364605,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 379,
                           "restoreState": 379,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 364605,
                              "executionTimeMillisEstimate": 20,
                              "works": 364607,
                              "advanced": 364605,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 379,
                              "restoreState": 379,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 364605,
               "executionTimeMillisEstimate": 825
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1087
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372498,
                     "executionTimeMillis": 1191,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372498,
                        "executionTimeMillisEstimate": 154,
                        "works": 372500,
                        "advanced": 372498,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 387,
                        "restoreState": 387,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372498,
                           "executionTimeMillisEstimate": 127,
                           "works": 372500,
                           "advanced": 372498,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 387,
                           "restoreState": 387,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372498,
                              "executionTimeMillisEstimate": 26,
                              "works": 372500,
                              "advanced": 372498,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 387,
                              "restoreState": 387,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 372498,
               "executionTimeMillisEstimate": 858
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1188
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425313,
         "i": 1915
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425313,
            "i": 1915
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 364605,
                     "executionTimeMillis": 1062,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 364605,
                        "executionTimeMillisEstimate": 103,
                        "works": 364607,
                        "advanced": 364605,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 384,
                        "restoreState": 384,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 364605,
                           "executionTimeMillisEstimate": 77,
                           "works": 364607,
                           "advanced": 364605,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 384,
                           "restoreState": 384,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 364605,
                              "executionTimeMillisEstimate": 20,
                              "works": 364607,
                              "advanced": 364605,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 384,
                              "restoreState": 384,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 364605,
               "executionTimeMillisEstimate": 834
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1055
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372316,
                     "executionTimeMillis": 1066,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372316,
                        "executionTimeMillisEstimate": 99,
                        "works": 372318,
                        "advanced": 372316,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 392,
                        "restoreState": 392,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372316,
                           "executionTimeMillisEstimate": 77,
                           "works": 372318,
                           "advanced": 372316,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 392,
                           "restoreState": 392,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372316,
                              "executionTimeMillisEstimate": 8,
                              "works": 372318,
                              "advanced": 372316,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 392,
                              "restoreState": 392,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 372316,
               "executionTimeMillisEstimate": 830
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1055
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372498,
                     "executionTimeMillis": 1170,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372498,
                        "executionTimeMillisEstimate": 102,
                        "works": 372500,
                        "advanced": 372498,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 392,
                        "restoreState": 392,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372498,
                           "executionTimeMillisEstimate": 82,
                           "works": 372500,
                           "advanced": 372498,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 392,
                           "restoreState": 392,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372498,
                              "executionTimeMillisEstimate": 14,
                              "works": 372500,
                              "advanced": 372498,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 392,
                              "restoreState": 392,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 372498,
               "executionTimeMillisEstimate": 895
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1161
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425313,
         "i": 1923
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425313,
            "i": 1924
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 70788,
                     "executionTimeMillis": 494,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 70788,
                        "executionTimeMillisEstimate": 52,
                        "works": 364607,
                        "advanced": 70788,
                        "needTime": 293818,
                        "needYield": 0,
                        "saveState": 368,
                        "restoreState": 368,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 70788,
                           "executionTimeMillisEstimate": 51,
                           "works": 364607,
                           "advanced": 70788,
                           "needTime": 293818,
                           "needYield": 0,
                           "saveState": 368,
                           "restoreState": 368,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 70788,
                              "executionTimeMillisEstimate": 30,
                              "works": 364607,
                              "advanced": 70788,
                              "needTime": 293818,
                              "needYield": 0,
                              "saveState": 368,
                              "restoreState": 368,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 70788,
               "executionTimeMillisEstimate": 404
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 488
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 72480,
                     "executionTimeMillis": 519,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 72480,
                        "executionTimeMillisEstimate": 53,
                        "works": 372318,
                        "advanced": 72480,
                        "needTime": 299837,
                        "needYield": 0,
                        "saveState": 377,
                        "restoreState": 377,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 72480,
                           "executionTimeMillisEstimate": 37,
                           "works": 372318,
                           "advanced": 72480,
                           "needTime": 299837,
                           "needYield": 0,
                           "saveState": 377,
                           "restoreState": 377,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 72480,
                              "executionTimeMillisEstimate": 30,
                              "works": 372318,
                              "advanced": 72480,
                              "needTime": 299837,
                              "needYield": 0,
                              "saveState": 377,
                              "restoreState": 377,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 72480,
               "executionTimeMillisEstimate": 455
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 367,
               "executionTimeMillisEstimate": 508
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 72247,
                     "executionTimeMillis": 565,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 72247,
                        "executionTimeMillisEstimate": 81,
                        "works": 372500,
                        "advanced": 72247,
                        "needTime": 300252,
                        "needYield": 0,
                        "saveState": 376,
                        "restoreState": 376,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 72247,
                           "executionTimeMillisEstimate": 78,
                           "works": 372500,
                           "advanced": 72247,
                           "needTime": 300252,
                           "needYield": 0,
                           "saveState": 376,
                           "restoreState": 376,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 72247,
                              "executionTimeMillisEstimate": 42,
                              "works": 372500,
                              "advanced": 72247,
                              "needTime": 300252,
                              "needYield": 0,
                              "saveState": 376,
                              "restoreState": 376,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 72247,
               "executionTimeMillisEstimate": 486
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 565
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425315,
         "i": 1
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425315,
            "i": 9
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 70788,
                     "executionTimeMillis": 473,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 70788,
                        "executionTimeMillisEstimate": 30,
                        "works": 364607,
                        "advanced": 70788,
                        "needTime": 293818,
                        "needYield": 0,
                        "saveState": 368,
                        "restoreState": 368,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 70788,
                           "executionTimeMillisEstimate": 27,
                           "works": 364607,
                           "advanced": 70788,
                           "needTime": 293818,
                           "needYield": 0,
                           "saveState": 368,
                           "restoreState": 368,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 70788,
                              "executionTimeMillisEstimate": 16,
                              "works": 364607,
                              "advanced": 70788,
                              "needTime": 293818,
                              "needYield": 0,
                              "saveState": 368,
                              "restoreState": 368,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 70788,
               "executionTimeMillisEstimate": 421
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 361,
               "executionTimeMillisEstimate": 467
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 72480,
                     "executionTimeMillis": 487,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 72480,
                        "executionTimeMillisEstimate": 35,
                        "works": 372318,
                        "advanced": 72480,
                        "needTime": 299837,
                        "needYield": 0,
                        "saveState": 376,
                        "restoreState": 376,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 72480,
                           "executionTimeMillisEstimate": 31,
                           "works": 372318,
                           "advanced": 72480,
                           "needTime": 299837,
                           "needYield": 0,
                           "saveState": 376,
                           "restoreState": 376,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 72480,
                              "executionTimeMillisEstimate": 18,
                              "works": 372318,
                              "advanced": 72480,
                              "needTime": 299837,
                              "needYield": 0,
                              "saveState": 376,
                              "restoreState": 376,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 72480,
               "executionTimeMillisEstimate": 421
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 484
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 72247,
                     "executionTimeMillis": 516,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 72247,
                        "executionTimeMillisEstimate": 38,
                        "works": 372500,
                        "advanced": 72247,
                        "needTime": 300252,
                        "needYield": 0,
                        "saveState": 376,
                        "restoreState": 376,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 72247,
                           "executionTimeMillisEstimate": 38,
                           "works": 372500,
                           "advanced": 72247,
                           "needTime": 300252,
                           "needYield": 0,
                           "saveState": 376,
                           "restoreState": 376,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 72247,
                              "executionTimeMillisEstimate": 22,
                              "works": 372500,
                              "advanced": 72247,
                              "needTime": 300252,
                              "needYield": 0,
                              "saveState": 376,
                              "restoreState": 376,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 72247,
               "executionTimeMillisEstimate": 446
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 515
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425315,
         "i": 9
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425315,
            "i": 9
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 70788,
                     "executionTimeMillis": 472,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 70788,
                        "executionTimeMillisEstimate": 38,
                        "works": 364607,
                        "advanced": 70788,
                        "needTime": 293818,
                        "needYield": 0,
                        "saveState": 368,
                        "restoreState": 368,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 70788,
                           "executionTimeMillisEstimate": 36,
                           "works": 364607,
                           "advanced": 70788,
                           "needTime": 293818,
                           "needYield": 0,
                           "saveState": 368,
                           "restoreState": 368,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 70788,
                              "executionTimeMillisEstimate": 22,
                              "works": 364607,
                              "advanced": 70788,
                              "needTime": 293818,
                              "needYield": 0,
                              "saveState": 368,
                              "restoreState": 368,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 70788,
               "executionTimeMillisEstimate": 419
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 469
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 72480,
                     "executionTimeMillis": 477,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 72480,
                        "executionTimeMillisEstimate": 35,
                        "works": 372318,
                        "advanced": 72480,
                        "needTime": 299837,
                        "needYield": 0,
                        "saveState": 376,
                        "restoreState": 376,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 72480,
                           "executionTimeMillisEstimate": 33,
                           "works": 372318,
                           "advanced": 72480,
                           "needTime": 299837,
                           "needYield": 0,
                           "saveState": 376,
                           "restoreState": 376,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 72480,
                              "executionTimeMillisEstimate": 24,
                              "works": 372318,
                              "advanced": 72480,
                              "needTime": 299837,
                              "needYield": 0,
                              "saveState": 376,
                              "restoreState": 376,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 72480,
               "executionTimeMillisEstimate": 422
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 475
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 72247,
                     "executionTimeMillis": 497,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 72247,
                        "executionTimeMillisEstimate": 31,
                        "works": 372500,
                        "advanced": 72247,
                        "needTime": 300252,
                        "needYield": 0,
                        "saveState": 376,
                        "restoreState": 376,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 72247,
                           "executionTimeMillisEstimate": 26,
                           "works": 372500,
                           "advanced": 72247,
                           "needTime": 300252,
                           "needYield": 0,
                           "saveState": 376,
                           "restoreState": 376,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 72247,
                              "executionTimeMillisEstimate": 18,
                              "works": 372500,
                              "advanced": 72247,
                              "needTime": 300252,
                              "needYield": 0,
                              "saveState": 376,
                              "restoreState": 376,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 72247,
               "executionTimeMillisEstimate": 441
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 490
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425315,
         "i": 9
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425315,
            "i": 9
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 115361,
                     "executionTimeMillis": 546,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 115361,
                        "executionTimeMillisEstimate": 66,
                        "works": 372318,
                        "advanced": 115361,
                        "needTime": 256956,
                        "needYield": 0,
                        "saveState": 376,
                        "restoreState": 376,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 115361,
                           "executionTimeMillisEstimate": 50,
                           "works": 372318,
                           "advanced": 115361,
                           "needTime": 256956,
                           "needYield": 0,
                           "saveState": 376,
                           "restoreState": 376,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 115361,
                              "executionTimeMillisEstimate": 22,
                              "works": 372318,
                              "advanced": 115361,
                              "needTime": 256956,
                              "needYield": 0,
                              "saveState": 376,
                              "restoreState": 376,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 115361,
               "executionTimeMillisEstimate": 453
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 540
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 113929,
                     "executionTimeMillis": 536,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 113929,
                        "executionTimeMillisEstimate": 56,
                        "works": 364607,
                        "advanced": 113929,
                        "needTime": 250677,
                        "needYield": 0,
                        "saveState": 369,
                        "restoreState": 369,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 113929,
                           "executionTimeMillisEstimate": 48,
                           "works": 364607,
                           "advanced": 113929,
                           "needTime": 250677,
                           "needYield": 0,
                           "saveState": 369,
                           "restoreState": 369,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 113929,
                              "executionTimeMillisEstimate": 17,
                              "works": 364607,
                              "advanced": 113929,
                              "needTime": 250677,
                              "needYield": 0,
                              "saveState": 369,
                              "restoreState": 369,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 113929,
               "executionTimeMillisEstimate": 448
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 532
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 116004,
                     "executionTimeMillis": 587,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 116004,
                        "executionTimeMillisEstimate": 88,
                        "works": 372500,
                        "advanced": 116004,
                        "needTime": 256495,
                        "needYield": 0,
                        "saveState": 376,
                        "restoreState": 376,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 116004,
                           "executionTimeMillisEstimate": 79,
                           "works": 372500,
                           "advanced": 116004,
                           "needTime": 256495,
                           "needYield": 0,
                           "saveState": 376,
                           "restoreState": 376,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 116004,
                              "executionTimeMillisEstimate": 35,
                              "works": 372500,
                              "advanced": 116004,
                              "needTime": 256495,
                              "needYield": 0,
                              "saveState": 376,
                              "restoreState": 376,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 116004,
               "executionTimeMillisEstimate": 478
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 579
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425316,
         "i": 3163
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425316,
            "i": 3163
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 113929,
                     "executionTimeMillis": 507,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 113929,
                        "executionTimeMillisEstimate": 42,
                        "works": 364607,
                        "advanced": 113929,
                        "needTime": 250677,
                        "needYield": 0,
                        "saveState": 370,
                        "restoreState": 370,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 113929,
                           "executionTimeMillisEstimate": 36,
                           "works": 364607,
                           "advanced": 113929,
                           "needTime": 250677,
                           "needYield": 0,
                           "saveState": 370,
                           "restoreState": 370,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 113929,
                              "executionTimeMillisEstimate": 23,
                              "works": 364607,
                              "advanced": 113929,
                              "needTime": 250677,
                              "needYield": 0,
                              "saveState": 370,
                              "restoreState": 370,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 113929,
               "executionTimeMillisEstimate": 425
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 504
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 115361,
                     "executionTimeMillis": 513,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 115361,
                        "executionTimeMillisEstimate": 58,
                        "works": 372318,
                        "advanced": 115361,
                        "needTime": 256956,
                        "needYield": 0,
                        "saveState": 378,
                        "restoreState": 378,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 115361,
                           "executionTimeMillisEstimate": 52,
                           "works": 372318,
                           "advanced": 115361,
                           "needTime": 256956,
                           "needYield": 0,
                           "saveState": 378,
                           "restoreState": 378,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 115361,
                              "executionTimeMillisEstimate": 21,
                              "works": 372318,
                              "advanced": 115361,
                              "needTime": 256956,
                              "needYield": 0,
                              "saveState": 378,
                              "restoreState": 378,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 115361,
               "executionTimeMillisEstimate": 437
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 504
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 116004,
                     "executionTimeMillis": 541,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 116004,
                        "executionTimeMillisEstimate": 64,
                        "works": 372500,
                        "advanced": 116004,
                        "needTime": 256495,
                        "needYield": 0,
                        "saveState": 378,
                        "restoreState": 378,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 116004,
                           "executionTimeMillisEstimate": 57,
                           "works": 372500,
                           "advanced": 116004,
                           "needTime": 256495,
                           "needYield": 0,
                           "saveState": 378,
                           "restoreState": 378,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 116004,
                              "executionTimeMillisEstimate": 15,
                              "works": 372500,
                              "advanced": 116004,
                              "needTime": 256495,
                              "needYield": 0,
                              "saveState": 378,
                              "restoreState": 378,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 116004,
               "executionTimeMillisEstimate": 446
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 534
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425316,
         "i": 3185
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425316,
            "i": 3185
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 113929,
                     "executionTimeMillis": 517,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 113929,
                        "executionTimeMillisEstimate": 53,
                        "works": 364607,
                        "advanced": 113929,
                        "needTime": 250677,
                        "needYield": 0,
                        "saveState": 370,
                        "restoreState": 370,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 113929,
                           "executionTimeMillisEstimate": 46,
                           "works": 364607,
                           "advanced": 113929,
                           "needTime": 250677,
                           "needYield": 0,
                           "saveState": 370,
                           "restoreState": 370,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 113929,
                              "executionTimeMillisEstimate": 16,
                              "works": 364607,
                              "advanced": 113929,
                              "needTime": 250677,
                              "needYield": 0,
                              "saveState": 370,
                              "restoreState": 370,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 113929,
               "executionTimeMillisEstimate": 443
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 509
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 115361,
                     "executionTimeMillis": 524,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 115361,
                        "executionTimeMillisEstimate": 45,
                        "works": 372318,
                        "advanced": 115361,
                        "needTime": 256956,
                        "needYield": 0,
                        "saveState": 379,
                        "restoreState": 379,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 115361,
                           "executionTimeMillisEstimate": 42,
                           "works": 372318,
                           "advanced": 115361,
                           "needTime": 256956,
                           "needYield": 0,
                           "saveState": 379,
                           "restoreState": 379,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 115361,
                              "executionTimeMillisEstimate": 21,
                              "works": 372318,
                              "advanced": 115361,
                              "needTime": 256956,
                              "needYield": 0,
                              "saveState": 379,
                              "restoreState": 379,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 115361,
               "executionTimeMillisEstimate": 459
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 523
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 116004,
                     "executionTimeMillis": 546,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 116004,
                        "executionTimeMillisEstimate": 55,
                        "works": 372500,
                        "advanced": 116004,
                        "needTime": 256495,
                        "needYield": 0,
                        "saveState": 379,
                        "restoreState": 379,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 116004,
                           "executionTimeMillisEstimate": 49,
                           "works": 372500,
                           "advanced": 116004,
                           "needTime": 256495,
                           "needYield": 0,
                           "saveState": 379,
                           "restoreState": 379,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 116004,
                              "executionTimeMillisEstimate": 25,
                              "works": 372500,
                              "advanced": 116004,
                              "needTime": 256495,
                              "needYield": 0,
                              "saveState": 379,
                              "restoreState": 379,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 116004,
               "executionTimeMillisEstimate": 475
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 544
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425316,
         "i": 3185
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425316,
            "i": 3185
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372316,
                     "executionTimeMillis": 1539,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372316,
                        "executionTimeMillisEstimate": 161,
                        "works": 372318,
                        "advanced": 372316,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 391,
                        "restoreState": 391,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372316,
                           "executionTimeMillisEstimate": 125,
                           "works": 372318,
                           "advanced": 372316,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 391,
                           "restoreState": 391,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372316,
                              "executionTimeMillisEstimate": 33,
                              "works": 372318,
                              "advanced": 372316,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 391,
                              "restoreState": 391,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 372316,
               "executionTimeMillisEstimate": 970
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1200,
               "executionTimeMillisEstimate": 1532
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 364605,
                     "executionTimeMillis": 1548,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 364605,
                        "executionTimeMillisEstimate": 161,
                        "works": 364607,
                        "advanced": 364605,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 383,
                        "restoreState": 383,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 364605,
                           "executionTimeMillisEstimate": 123,
                           "works": 364607,
                           "advanced": 364605,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 383,
                           "restoreState": 383,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 364605,
                              "executionTimeMillisEstimate": 28,
                              "works": 364607,
                              "advanced": 364605,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 383,
                              "restoreState": 383,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 364605,
               "executionTimeMillisEstimate": 941
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1201,
               "executionTimeMillisEstimate": 1545
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372498,
                     "executionTimeMillis": 1668,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372498,
                        "executionTimeMillisEstimate": 186,
                        "works": 372500,
                        "advanced": 372498,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 391,
                        "restoreState": 391,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372498,
                           "executionTimeMillisEstimate": 149,
                           "works": 372500,
                           "advanced": 372498,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 391,
                           "restoreState": 391,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372498,
                              "executionTimeMillisEstimate": 37,
                              "works": 372500,
                              "advanced": 372498,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 391,
                              "restoreState": 391,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 372498,
               "executionTimeMillisEstimate": 983
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1200,
               "executionTimeMillisEstimate": 1662
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425318,
         "i": 3838
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425319,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372316,
                     "executionTimeMillis": 1445,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372316,
                        "executionTimeMillisEstimate": 129,
                        "works": 372318,
                        "advanced": 372316,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 400,
                        "restoreState": 400,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372316,
                           "executionTimeMillisEstimate": 106,
                           "works": 372318,
                           "advanced": 372316,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 400,
                           "restoreState": 400,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372316,
                              "executionTimeMillisEstimate": 29,
                              "works": 372318,
                              "advanced": 372316,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 400,
                              "restoreState": 400,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 372316,
               "executionTimeMillisEstimate": 907
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1201,
               "executionTimeMillisEstimate": 1444
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 364605,
                     "executionTimeMillis": 1465,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 364605,
                        "executionTimeMillisEstimate": 104,
                        "works": 364607,
                        "advanced": 364605,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 390,
                        "restoreState": 390,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 364605,
                           "executionTimeMillisEstimate": 80,
                           "works": 364607,
                           "advanced": 364605,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 390,
                           "restoreState": 390,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 364605,
                              "executionTimeMillisEstimate": 11,
                              "works": 364607,
                              "advanced": 364605,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 390,
                              "restoreState": 390,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 364605,
               "executionTimeMillisEstimate": 896
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1202,
               "executionTimeMillisEstimate": 1461
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372498,
                     "executionTimeMillis": 1566,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372498,
                        "executionTimeMillisEstimate": 155,
                        "works": 372500,
                        "advanced": 372498,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 400,
                        "restoreState": 400,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372498,
                           "executionTimeMillisEstimate": 133,
                           "works": 372500,
                           "advanced": 372498,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 400,
                           "restoreState": 400,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372498,
                              "executionTimeMillisEstimate": 29,
                              "works": 372500,
                              "advanced": 372498,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 400,
                              "restoreState": 400,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 372498,
               "executionTimeMillisEstimate": 967
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1201,
               "executionTimeMillisEstimate": 1557
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425320,
         "i": 2591
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425320,
            "i": 2595
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 4873,
            "executionTimeMillis": 227,
            "totalKeysExamined": 0,
            "totalDocsExamined": 364605,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 4873,
               "executionTimeMillisEstimate": 14,
               "works": 364607,
               "advanced": 4873,
               "needTime": 359733,
               "needYield": 0,
               "saveState": 364,
               "restoreState": 364,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 4873,
                  "executionTimeMillisEstimate": 13,
                  "works": 364607,
                  "advanced": 4873,
                  "needTime": 359733,
                  "needYield": 0,
                  "saveState": 364,
                  "restoreState": 364,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 364605
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 5013,
            "executionTimeMillis": 235,
            "totalKeysExamined": 0,
            "totalDocsExamined": 372316,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 5013,
               "executionTimeMillisEstimate": 11,
               "works": 372318,
               "advanced": 5013,
               "needTime": 367304,
               "needYield": 0,
               "saveState": 372,
               "restoreState": 372,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 5013,
                  "executionTimeMillisEstimate": 11,
                  "works": 372318,
                  "advanced": 5013,
                  "needTime": 367304,
                  "needYield": 0,
                  "saveState": 372,
                  "restoreState": 372,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 372316
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 4939,
            "executionTimeMillis": 237,
            "totalKeysExamined": 0,
            "totalDocsExamined": 372498,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 4939,
               "executionTimeMillisEstimate": 14,
               "works": 372500,
               "advanced": 4939,
               "needTime": 367560,
               "needYield": 0,
               "saveState": 372,
               "restoreState": 372,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 4939,
                  "executionTimeMillisEstimate": 14,
                  "works": 372500,
                  "advanced": 4939,
                  "needTime": 367560,
                  "needYield": 0,
                  "saveState": 372,
                  "restoreState": 372,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 372498
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425320,
         "i": 2591
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425320,
            "i": 2595
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 364605,
                     "executionTimeMillis": 2040,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 364605,
                        "executionTimeMillisEstimate": 392,
                        "works": 364607,
                        "advanced": 364605,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 407,
                        "restoreState": 407,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 364605,
                           "executionTimeMillisEstimate": 177,
                           "works": 364607,
                           "advanced": 364605,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 407,
                           "restoreState": 407,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 364605,
                              "executionTimeMillisEstimate": 57,
                              "works": 364607,
                              "advanced": 364605,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 407,
                              "restoreState": 407,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 364605,
               "executionTimeMillisEstimate": 1727
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2520,
               "executionTimeMillisEstimate": 2037
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372316,
                     "executionTimeMillis": 2070,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 372316,
                        "executionTimeMillisEstimate": 462,
                        "works": 372318,
                        "advanced": 372316,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 417,
                        "restoreState": 417,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372316,
                           "executionTimeMillisEstimate": 196,
                           "works": 372318,
                           "advanced": 372316,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 417,
                           "restoreState": 417,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372316,
                              "executionTimeMillisEstimate": 49,
                              "works": 372318,
                              "advanced": 372316,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 417,
                              "restoreState": 417,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 372316,
               "executionTimeMillisEstimate": 1759
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2527,
               "executionTimeMillisEstimate": 2067
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372498,
                     "executionTimeMillis": 2134,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 372498,
                        "executionTimeMillisEstimate": 463,
                        "works": 372500,
                        "advanced": 372498,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 417,
                        "restoreState": 417,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372498,
                           "executionTimeMillisEstimate": 209,
                           "works": 372500,
                           "advanced": 372498,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 417,
                           "restoreState": 417,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372498,
                              "executionTimeMillisEstimate": 45,
                              "works": 372500,
                              "advanced": 372498,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 417,
                              "restoreState": 417,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 372498,
               "executionTimeMillisEstimate": 1814
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2521,
               "executionTimeMillisEstimate": 2127
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425322,
         "i": 4670
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425322,
            "i": 4670
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 364605,
                     "executionTimeMillis": 1842,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 364605,
                        "executionTimeMillisEstimate": 384,
                        "works": 364607,
                        "advanced": 364605,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 407,
                        "restoreState": 407,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 364605,
                           "executionTimeMillisEstimate": 184,
                           "works": 364607,
                           "advanced": 364605,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 407,
                           "restoreState": 407,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 364605,
                              "executionTimeMillisEstimate": 40,
                              "works": 364607,
                              "advanced": 364605,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 407,
                              "restoreState": 407,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 364605,
               "executionTimeMillisEstimate": 1556
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2530,
               "executionTimeMillisEstimate": 1831
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372316,
                     "executionTimeMillis": 1898,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 372316,
                        "executionTimeMillisEstimate": 376,
                        "works": 372318,
                        "advanced": 372316,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 417,
                        "restoreState": 417,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372316,
                           "executionTimeMillisEstimate": 180,
                           "works": 372318,
                           "advanced": 372316,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 417,
                           "restoreState": 417,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372316,
                              "executionTimeMillisEstimate": 43,
                              "works": 372318,
                              "advanced": 372316,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 417,
                              "restoreState": 417,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 372316,
               "executionTimeMillisEstimate": 1639
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2528,
               "executionTimeMillisEstimate": 1891
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372498,
                     "executionTimeMillis": 1917,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 372498,
                        "executionTimeMillisEstimate": 370,
                        "works": 372500,
                        "advanced": 372498,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 417,
                        "restoreState": 417,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372498,
                           "executionTimeMillisEstimate": 165,
                           "works": 372500,
                           "advanced": 372498,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 417,
                           "restoreState": 417,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372498,
                              "executionTimeMillisEstimate": 43,
                              "works": 372500,
                              "advanced": 372498,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 417,
                              "restoreState": 417,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 372498,
               "executionTimeMillisEstimate": 1611
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2525,
               "executionTimeMillisEstimate": 1916
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425324,
         "i": 871
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425324,
            "i": 871
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 364605,
                     "executionTimeMillis": 1101,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 364605,
                        "executionTimeMillisEstimate": 134,
                        "works": 364607,
                        "advanced": 364605,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 379,
                        "restoreState": 379,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 364605,
                           "executionTimeMillisEstimate": 123,
                           "works": 364607,
                           "advanced": 364605,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 379,
                           "restoreState": 379,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 364605,
                              "executionTimeMillisEstimate": 29,
                              "works": 364607,
                              "advanced": 364605,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 379,
                              "restoreState": 379,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 364605,
               "executionTimeMillisEstimate": 869
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1098
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372316,
                     "executionTimeMillis": 1104,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372316,
                        "executionTimeMillisEstimate": 110,
                        "works": 372318,
                        "advanced": 372316,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 386,
                        "restoreState": 386,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372316,
                           "executionTimeMillisEstimate": 91,
                           "works": 372318,
                           "advanced": 372316,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 386,
                           "restoreState": 386,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372316,
                              "executionTimeMillisEstimate": 13,
                              "works": 372318,
                              "advanced": 372316,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 386,
                              "restoreState": 386,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 372316,
               "executionTimeMillisEstimate": 861
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1104
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 372498,
                     "executionTimeMillis": 1106,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 372498,
                        "executionTimeMillisEstimate": 139,
                        "works": 372500,
                        "advanced": 372498,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 387,
                        "restoreState": 387,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 372498,
                           "executionTimeMillisEstimate": 113,
                           "works": 372500,
                           "advanced": 372498,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 387,
                           "restoreState": 387,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 372498,
                              "executionTimeMillisEstimate": 20,
                              "works": 372500,
                              "advanced": 372498,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 387,
                              "restoreState": 387,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 372498,
               "executionTimeMillisEstimate": 852
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1097
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425326,
         "i": 1839
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425326,
            "i": 1839
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 59937,
                     "executionTimeMillis": 365,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 59937,
                        "executionTimeMillisEstimate": 24,
                        "works": 364607,
                        "advanced": 59937,
                        "needTime": 304669,
                        "needYield": 0,
                        "saveState": 366,
                        "restoreState": 366,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 59937,
                           "executionTimeMillisEstimate": 22,
                           "works": 364607,
                           "advanced": 59937,
                           "needTime": 304669,
                           "needYield": 0,
                           "saveState": 366,
                           "restoreState": 366,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 59937,
                              "executionTimeMillisEstimate": 13,
                              "works": 364607,
                              "advanced": 59937,
                              "needTime": 304669,
                              "needYield": 0,
                              "saveState": 366,
                              "restoreState": 366,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 59937,
               "executionTimeMillisEstimate": 327
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 363,
               "executionTimeMillisEstimate": 357
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 61366,
                     "executionTimeMillis": 371,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 61366,
                        "executionTimeMillisEstimate": 30,
                        "works": 372500,
                        "advanced": 61366,
                        "needTime": 311133,
                        "needYield": 0,
                        "saveState": 374,
                        "restoreState": 374,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 61366,
                           "executionTimeMillisEstimate": 26,
                           "works": 372500,
                           "advanced": 61366,
                           "needTime": 311133,
                           "needYield": 0,
                           "saveState": 374,
                           "restoreState": 374,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 61366,
                              "executionTimeMillisEstimate": 14,
                              "works": 372500,
                              "advanced": 61366,
                              "needTime": 311133,
                              "needYield": 0,
                              "saveState": 374,
                              "restoreState": 374,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 61366,
               "executionTimeMillisEstimate": 331
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 361,
               "executionTimeMillisEstimate": 369
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 61350,
                     "executionTimeMillis": 372,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 61350,
                        "executionTimeMillisEstimate": 21,
                        "works": 372318,
                        "advanced": 61350,
                        "needTime": 310967,
                        "needYield": 0,
                        "saveState": 375,
                        "restoreState": 375,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 61350,
                           "executionTimeMillisEstimate": 20,
                           "works": 372318,
                           "advanced": 61350,
                           "needTime": 310967,
                           "needYield": 0,
                           "saveState": 375,
                           "restoreState": 375,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 61350,
                              "executionTimeMillisEstimate": 14,
                              "works": 372318,
                              "advanced": 61350,
                              "needTime": 310967,
                              "needYield": 0,
                              "saveState": 375,
                              "restoreState": 375,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 61350,
               "executionTimeMillisEstimate": 333
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 362,
               "executionTimeMillisEstimate": 369
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425326,
         "i": 1839
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425326,
            "i": 1839
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 59937,
                     "executionTimeMillis": 411,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 364605,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 59937,
                        "executionTimeMillisEstimate": 30,
                        "works": 364607,
                        "advanced": 59937,
                        "needTime": 304669,
                        "needYield": 0,
                        "saveState": 367,
                        "restoreState": 367,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 59937,
                           "executionTimeMillisEstimate": 29,
                           "works": 364607,
                           "advanced": 59937,
                           "needTime": 304669,
                           "needYield": 0,
                           "saveState": 367,
                           "restoreState": 367,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 59937,
                              "executionTimeMillisEstimate": 10,
                              "works": 364607,
                              "advanced": 59937,
                              "needTime": 304669,
                              "needYield": 0,
                              "saveState": 367,
                              "restoreState": 367,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 364605
                           }
                        }
                     }
                  }
               },
               "nReturned": 59937,
               "executionTimeMillisEstimate": 358
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 362,
               "executionTimeMillisEstimate": 402
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 61366,
                     "executionTimeMillis": 420,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372498,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 61366,
                        "executionTimeMillisEstimate": 46,
                        "works": 372500,
                        "advanced": 61366,
                        "needTime": 311133,
                        "needYield": 0,
                        "saveState": 375,
                        "restoreState": 375,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 61366,
                           "executionTimeMillisEstimate": 41,
                           "works": 372500,
                           "advanced": 61366,
                           "needTime": 311133,
                           "needYield": 0,
                           "saveState": 375,
                           "restoreState": 375,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 61366,
                              "executionTimeMillisEstimate": 21,
                              "works": 372500,
                              "advanced": 61366,
                              "needTime": 311133,
                              "needYield": 0,
                              "saveState": 375,
                              "restoreState": 375,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372498
                           }
                        }
                     }
                  }
               },
               "nReturned": 61366,
               "executionTimeMillisEstimate": 371
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 363,
               "executionTimeMillisEstimate": 418
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 61350,
                     "executionTimeMillis": 436,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 372316,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 61350,
                        "executionTimeMillisEstimate": 54,
                        "works": 372318,
                        "advanced": 61350,
                        "needTime": 310967,
                        "needYield": 0,
                        "saveState": 374,
                        "restoreState": 374,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 61350,
                           "executionTimeMillisEstimate": 42,
                           "works": 372318,
                           "advanced": 61350,
                           "needTime": 310967,
                           "needYield": 0,
                           "saveState": 374,
                           "restoreState": 374,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 61350,
                              "executionTimeMillisEstimate": 15,
                              "works": 372318,
                              "advanced": 61350,
                              "needTime": 310967,
                              "needYield": 0,
                              "saveState": 374,
                              "restoreState": 374,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 372316
                           }
                        }
                     }
                  }
               },
               "nReturned": 61350,
               "executionTimeMillisEstimate": 380
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 430
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425327,
         "i": 51
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425327,
            "i": 51
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_ARR_DELAY<a name="AirlineData_ARR_DELAY"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 17,
            "totalKeysExamined": 58,
            "totalDocsExamined": 58,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 9,
               "works": 59,
               "advanced": 1,
               "needTime": 57,
               "needYield": 0,
               "saveState": 0,
               "restoreState": 0,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 9,
                  "works": 59,
                  "advanced": 1,
                  "needTime": 57,
                  "needYield": 0,
                  "saveState": 0,
                  "restoreState": 0,
                  "isEOF": 1,
                  "docsExamined": 58,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 58,
                     "executionTimeMillisEstimate": 0,
                     "works": 59,
                     "advanced": 58,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 0,
                     "restoreState": 0,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     },
                     "keysExamined": 58,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 23,
            "totalKeysExamined": 45,
            "totalDocsExamined": 45,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 18,
               "works": 46,
               "advanced": 0,
               "needTime": 45,
               "needYield": 0,
               "saveState": 1,
               "restoreState": 1,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 18,
                  "works": 46,
                  "advanced": 0,
                  "needTime": 45,
                  "needYield": 0,
                  "saveState": 1,
                  "restoreState": 1,
                  "isEOF": 1,
                  "docsExamined": 45,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 45,
                     "executionTimeMillisEstimate": 0,
                     "works": 46,
                     "advanced": 45,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 1,
                     "restoreState": 1,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     },
                     "keysExamined": 45,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 28,
            "totalKeysExamined": 39,
            "totalDocsExamined": 39,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 20,
               "works": 40,
               "advanced": 1,
               "needTime": 38,
               "needYield": 0,
               "saveState": 1,
               "restoreState": 1,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 20,
                  "works": 40,
                  "advanced": 1,
                  "needTime": 38,
                  "needYield": 0,
                  "saveState": 1,
                  "restoreState": 1,
                  "isEOF": 1,
                  "docsExamined": 39,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 39,
                     "executionTimeMillisEstimate": 0,
                     "works": 40,
                     "advanced": 39,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 1,
                     "restoreState": 1,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     },
                     "keysExamined": 39,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425327,
         "i": 284
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425327,
            "i": 284
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 320266,
                     "executionTimeMillis": 1858,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 320266,
                        "executionTimeMillisEstimate": 441,
                        "works": 320268,
                        "advanced": 320266,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 337,
                        "restoreState": 337,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 320266,
                           "executionTimeMillisEstimate": 393,
                           "works": 320268,
                           "advanced": 320266,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 337,
                           "restoreState": 337,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 320266,
                              "executionTimeMillisEstimate": 71,
                              "works": 320268,
                              "advanced": 320266,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 337,
                              "restoreState": 337,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 320266,
               "executionTimeMillisEstimate": 1496
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1854
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 401723,
                     "executionTimeMillis": 2161,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 401723,
                        "executionTimeMillisEstimate": 412,
                        "works": 401725,
                        "advanced": 401723,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 423,
                        "restoreState": 423,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 401723,
                           "executionTimeMillisEstimate": 329,
                           "works": 401725,
                           "advanced": 401723,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 423,
                           "restoreState": 423,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 401723,
                              "executionTimeMillisEstimate": 146,
                              "works": 401725,
                              "advanced": 401723,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 423,
                              "restoreState": 423,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 401723,
               "executionTimeMillisEstimate": 1647
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2157
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 387430,
                     "executionTimeMillis": 2237,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 387430,
                        "executionTimeMillisEstimate": 436,
                        "works": 387432,
                        "advanced": 387430,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 407,
                        "restoreState": 407,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 387430,
                           "executionTimeMillisEstimate": 404,
                           "works": 387432,
                           "advanced": 387430,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 407,
                           "restoreState": 407,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 387430,
                              "executionTimeMillisEstimate": 122,
                              "works": 387432,
                              "advanced": 387430,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 407,
                              "restoreState": 407,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 387430,
               "executionTimeMillisEstimate": 1796
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2236
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425328,
         "i": 1462
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425328,
            "i": 1462
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 320266,
                     "executionTimeMillis": 1233,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 320266,
                        "executionTimeMillisEstimate": 143,
                        "works": 320268,
                        "advanced": 320266,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 332,
                        "restoreState": 332,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 320266,
                           "executionTimeMillisEstimate": 103,
                           "works": 320268,
                           "advanced": 320266,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 332,
                           "restoreState": 332,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 320266,
                              "executionTimeMillisEstimate": 29,
                              "works": 320268,
                              "advanced": 320266,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 332,
                              "restoreState": 332,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 320266,
               "executionTimeMillisEstimate": 916
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 369,
               "executionTimeMillisEstimate": 1222
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 387430,
                     "executionTimeMillis": 1480,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 387430,
                        "executionTimeMillisEstimate": 175,
                        "works": 387432,
                        "advanced": 387430,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 402,
                        "restoreState": 402,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 387430,
                           "executionTimeMillisEstimate": 149,
                           "works": 387432,
                           "advanced": 387430,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 402,
                           "restoreState": 402,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 387430,
                              "executionTimeMillisEstimate": 29,
                              "works": 387432,
                              "advanced": 387430,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 402,
                              "restoreState": 402,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 387430,
               "executionTimeMillisEstimate": 1125
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1473
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 401723,
                     "executionTimeMillis": 1606,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 401723,
                        "executionTimeMillisEstimate": 216,
                        "works": 401725,
                        "advanced": 401723,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 417,
                        "restoreState": 417,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 401723,
                           "executionTimeMillisEstimate": 165,
                           "works": 401725,
                           "advanced": 401723,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 417,
                           "restoreState": 417,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 401723,
                              "executionTimeMillisEstimate": 41,
                              "works": 401725,
                              "advanced": 401723,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 417,
                              "restoreState": 417,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 401723,
               "executionTimeMillisEstimate": 1213
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1603
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425331,
         "i": 2523
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425331,
            "i": 2523
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 320266,
                     "executionTimeMillis": 1109,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 320266,
                        "executionTimeMillisEstimate": 112,
                        "works": 320268,
                        "advanced": 320266,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 338,
                        "restoreState": 338,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 320266,
                           "executionTimeMillisEstimate": 94,
                           "works": 320268,
                           "advanced": 320266,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 338,
                           "restoreState": 338,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 320266,
                              "executionTimeMillisEstimate": 22,
                              "works": 320268,
                              "advanced": 320266,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 338,
                              "restoreState": 338,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 320266,
               "executionTimeMillisEstimate": 842
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1103
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 387430,
                     "executionTimeMillis": 1335,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 387430,
                        "executionTimeMillisEstimate": 159,
                        "works": 387432,
                        "advanced": 387430,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 408,
                        "restoreState": 408,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 387430,
                           "executionTimeMillisEstimate": 135,
                           "works": 387432,
                           "advanced": 387430,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 408,
                           "restoreState": 408,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 387430,
                              "executionTimeMillisEstimate": 29,
                              "works": 387432,
                              "advanced": 387430,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 408,
                              "restoreState": 408,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 387430,
               "executionTimeMillisEstimate": 998
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 1325
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 401723,
                     "executionTimeMillis": 1464,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 401723,
                        "executionTimeMillisEstimate": 180,
                        "works": 401725,
                        "advanced": 401723,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 423,
                        "restoreState": 423,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 401723,
                           "executionTimeMillisEstimate": 148,
                           "works": 401725,
                           "advanced": 401723,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 423,
                           "restoreState": 423,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 401723,
                              "executionTimeMillisEstimate": 36,
                              "works": 401725,
                              "advanced": 401723,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 423,
                              "restoreState": 423,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 401723,
               "executionTimeMillisEstimate": 1085
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 369,
               "executionTimeMillisEstimate": 1463
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425331,
         "i": 2562
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425332,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "EBB86E77",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 44260,
                     "executionTimeMillis": 250,
                     "totalKeysExamined": 44260,
                     "totalDocsExamined": 44260,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 44260,
                        "executionTimeMillisEstimate": 55,
                        "works": 44261,
                        "advanced": 44260,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 46,
                        "restoreState": 46,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 44260,
                           "executionTimeMillisEstimate": 42,
                           "works": 44261,
                           "advanced": 44260,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 46,
                           "restoreState": 46,
                           "isEOF": 1,
                           "docsExamined": 44260,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 44260,
                              "executionTimeMillisEstimate": 32,
                              "works": 44261,
                              "advanced": 44260,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 46,
                              "restoreState": 46,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 44260,
                                 "executionTimeMillisEstimate": 5,
                                 "works": 44261,
                                 "advanced": 44260,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 46,
                                 "restoreState": 46,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 44260,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 44260,
               "executionTimeMillisEstimate": 202
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 250
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "EBB86E77",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 82019,
                     "executionTimeMillis": 431,
                     "totalKeysExamined": 82019,
                     "totalDocsExamined": 82019,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 82019,
                        "executionTimeMillisEstimate": 81,
                        "works": 82020,
                        "advanced": 82019,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 85,
                        "restoreState": 85,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 82019,
                           "executionTimeMillisEstimate": 70,
                           "works": 82020,
                           "advanced": 82019,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 85,
                           "restoreState": 85,
                           "isEOF": 1,
                           "docsExamined": 82019,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 82019,
                              "executionTimeMillisEstimate": 56,
                              "works": 82020,
                              "advanced": 82019,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 85,
                              "restoreState": 85,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 82019,
                                 "executionTimeMillisEstimate": 30,
                                 "works": 82020,
                                 "advanced": 82019,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 85,
                                 "restoreState": 85,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 82019,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 82019,
               "executionTimeMillisEstimate": 355
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 430
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "EBB86E77",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89236,
                     "executionTimeMillis": 470,
                     "totalKeysExamined": 89236,
                     "totalDocsExamined": 89236,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 89236,
                        "executionTimeMillisEstimate": 92,
                        "works": 89237,
                        "advanced": 89236,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 92,
                        "restoreState": 92,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 89236,
                           "executionTimeMillisEstimate": 81,
                           "works": 89237,
                           "advanced": 89236,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 92,
                           "restoreState": 92,
                           "isEOF": 1,
                           "docsExamined": 89236,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 89236,
                              "executionTimeMillisEstimate": 53,
                              "works": 89237,
                              "advanced": 89236,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 92,
                              "restoreState": 92,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 89236,
                                 "executionTimeMillisEstimate": 19,
                                 "works": 89237,
                                 "advanced": 89236,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 92,
                                 "restoreState": 92,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 89236,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 89236,
               "executionTimeMillisEstimate": 375
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 465
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425333,
         "i": 14
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425333,
            "i": 14
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "48CE24B3",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 44260,
                     "executionTimeMillis": 235,
                     "totalKeysExamined": 44260,
                     "totalDocsExamined": 44260,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 44260,
                        "executionTimeMillisEstimate": 53,
                        "works": 44261,
                        "advanced": 44260,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 46,
                        "restoreState": 46,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 44260,
                           "executionTimeMillisEstimate": 48,
                           "works": 44261,
                           "advanced": 44260,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 46,
                           "restoreState": 46,
                           "isEOF": 1,
                           "docsExamined": 44260,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 44260,
                              "executionTimeMillisEstimate": 25,
                              "works": 44261,
                              "advanced": 44260,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 46,
                              "restoreState": 46,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 44260,
                                 "executionTimeMillisEstimate": 4,
                                 "works": 44261,
                                 "advanced": 44260,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 46,
                                 "restoreState": 46,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 44260,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 44260,
               "executionTimeMillisEstimate": 184
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 361,
               "executionTimeMillisEstimate": 233
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "48CE24B3",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 82019,
                     "executionTimeMillis": 415,
                     "totalKeysExamined": 82019,
                     "totalDocsExamined": 82019,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 82019,
                        "executionTimeMillisEstimate": 73,
                        "works": 82020,
                        "advanced": 82019,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 86,
                        "restoreState": 86,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 82019,
                           "executionTimeMillisEstimate": 62,
                           "works": 82020,
                           "advanced": 82019,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 86,
                           "restoreState": 86,
                           "isEOF": 1,
                           "docsExamined": 82019,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 82019,
                              "executionTimeMillisEstimate": 39,
                              "works": 82020,
                              "advanced": 82019,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 86,
                              "restoreState": 86,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 82019,
                                 "executionTimeMillisEstimate": 11,
                                 "works": 82020,
                                 "advanced": 82019,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 86,
                                 "restoreState": 86,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 82019,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 82019,
               "executionTimeMillisEstimate": 335
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 367,
               "executionTimeMillisEstimate": 409
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "48CE24B3",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89236,
                     "executionTimeMillis": 445,
                     "totalKeysExamined": 89236,
                     "totalDocsExamined": 89236,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 89236,
                        "executionTimeMillisEstimate": 111,
                        "works": 89237,
                        "advanced": 89236,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 93,
                        "restoreState": 93,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 89236,
                           "executionTimeMillisEstimate": 95,
                           "works": 89237,
                           "advanced": 89236,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 93,
                           "restoreState": 93,
                           "isEOF": 1,
                           "docsExamined": 89236,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 89236,
                              "executionTimeMillisEstimate": 55,
                              "works": 89237,
                              "advanced": 89236,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 93,
                              "restoreState": 93,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 89236,
                                 "executionTimeMillisEstimate": 12,
                                 "works": 89237,
                                 "advanced": 89236,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 93,
                                 "restoreState": 93,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 89236,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 89236,
               "executionTimeMillisEstimate": 360
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 441
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425333,
         "i": 5916
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425333,
            "i": 5918
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "8AF24259",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 44260,
                     "executionTimeMillis": 244,
                     "totalKeysExamined": 44260,
                     "totalDocsExamined": 44260,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 44260,
                        "executionTimeMillisEstimate": 66,
                        "works": 44261,
                        "advanced": 44260,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 47,
                        "restoreState": 47,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 44260,
                           "executionTimeMillisEstimate": 58,
                           "works": 44261,
                           "advanced": 44260,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 47,
                           "restoreState": 47,
                           "isEOF": 1,
                           "docsExamined": 44260,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 44260,
                              "executionTimeMillisEstimate": 46,
                              "works": 44261,
                              "advanced": 44260,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 47,
                              "restoreState": 47,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 44260,
                                 "executionTimeMillisEstimate": 8,
                                 "works": 44261,
                                 "advanced": 44260,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 47,
                                 "restoreState": 47,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 44260,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 44260,
               "executionTimeMillisEstimate": 196
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 235
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "8AF24259",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 82019,
                     "executionTimeMillis": 401,
                     "totalKeysExamined": 82019,
                     "totalDocsExamined": 82019,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 82019,
                        "executionTimeMillisEstimate": 73,
                        "works": 82020,
                        "advanced": 82019,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 85,
                        "restoreState": 85,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 82019,
                           "executionTimeMillisEstimate": 62,
                           "works": 82020,
                           "advanced": 82019,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 85,
                           "restoreState": 85,
                           "isEOF": 1,
                           "docsExamined": 82019,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 82019,
                              "executionTimeMillisEstimate": 42,
                              "works": 82020,
                              "advanced": 82019,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 85,
                              "restoreState": 85,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 82019,
                                 "executionTimeMillisEstimate": 21,
                                 "works": 82020,
                                 "advanced": 82019,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 85,
                                 "restoreState": 85,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 82019,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 82019,
               "executionTimeMillisEstimate": 330
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 399
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "8AF24259",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89236,
                     "executionTimeMillis": 443,
                     "totalKeysExamined": 89236,
                     "totalDocsExamined": 89236,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 89236,
                        "executionTimeMillisEstimate": 101,
                        "works": 89237,
                        "advanced": 89236,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 94,
                        "restoreState": 94,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 89236,
                           "executionTimeMillisEstimate": 92,
                           "works": 89237,
                           "advanced": 89236,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 94,
                           "restoreState": 94,
                           "isEOF": 1,
                           "docsExamined": 89236,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 89236,
                              "executionTimeMillisEstimate": 64,
                              "works": 89237,
                              "advanced": 89236,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 94,
                              "restoreState": 94,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 89236,
                                 "executionTimeMillisEstimate": 4,
                                 "works": 89237,
                                 "advanced": 89236,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 94,
                                 "restoreState": 94,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 89236,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 89236,
               "executionTimeMillisEstimate": 369
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 438
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425333,
         "i": 5940
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425333,
            "i": 5940
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 98693,
                     "executionTimeMillis": 480,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 98693,
                        "executionTimeMillisEstimate": 46,
                        "works": 320268,
                        "advanced": 98693,
                        "needTime": 221574,
                        "needYield": 0,
                        "saveState": 324,
                        "restoreState": 324,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 98693,
                           "executionTimeMillisEstimate": 39,
                           "works": 320268,
                           "advanced": 98693,
                           "needTime": 221574,
                           "needYield": 0,
                           "saveState": 324,
                           "restoreState": 324,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 98693,
                              "executionTimeMillisEstimate": 17,
                              "works": 320268,
                              "advanced": 98693,
                              "needTime": 221574,
                              "needYield": 0,
                              "saveState": 324,
                              "restoreState": 324,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 98693,
               "executionTimeMillisEstimate": 418
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 478
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 119047,
                     "executionTimeMillis": 568,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 119047,
                        "executionTimeMillisEstimate": 49,
                        "works": 387432,
                        "advanced": 119047,
                        "needTime": 268384,
                        "needYield": 0,
                        "saveState": 391,
                        "restoreState": 391,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 119047,
                           "executionTimeMillisEstimate": 44,
                           "works": 387432,
                           "advanced": 119047,
                           "needTime": 268384,
                           "needYield": 0,
                           "saveState": 391,
                           "restoreState": 391,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 119047,
                              "executionTimeMillisEstimate": 19,
                              "works": 387432,
                              "advanced": 119047,
                              "needTime": 268384,
                              "needYield": 0,
                              "saveState": 391,
                              "restoreState": 391,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 119047,
               "executionTimeMillisEstimate": 472
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 564
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 127554,
                     "executionTimeMillis": 621,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 127554,
                        "executionTimeMillisEstimate": 47,
                        "works": 401725,
                        "advanced": 127554,
                        "needTime": 274170,
                        "needYield": 0,
                        "saveState": 407,
                        "restoreState": 407,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 127554,
                           "executionTimeMillisEstimate": 40,
                           "works": 401725,
                           "advanced": 127554,
                           "needTime": 274170,
                           "needYield": 0,
                           "saveState": 407,
                           "restoreState": 407,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 127554,
                              "executionTimeMillisEstimate": 19,
                              "works": 401725,
                              "advanced": 127554,
                              "needTime": 274170,
                              "needYield": 0,
                              "saveState": 407,
                              "restoreState": 407,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 127554,
               "executionTimeMillisEstimate": 501
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 619
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425334,
         "i": 2523
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425334,
            "i": 2523
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 98693,
                     "executionTimeMillis": 464,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 98693,
                        "executionTimeMillisEstimate": 49,
                        "works": 320268,
                        "advanced": 98693,
                        "needTime": 221574,
                        "needYield": 0,
                        "saveState": 326,
                        "restoreState": 326,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 98693,
                           "executionTimeMillisEstimate": 43,
                           "works": 320268,
                           "advanced": 98693,
                           "needTime": 221574,
                           "needYield": 0,
                           "saveState": 326,
                           "restoreState": 326,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 98693,
                              "executionTimeMillisEstimate": 20,
                              "works": 320268,
                              "advanced": 98693,
                              "needTime": 221574,
                              "needYield": 0,
                              "saveState": 326,
                              "restoreState": 326,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 98693,
               "executionTimeMillisEstimate": 402
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 459
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 119047,
                     "executionTimeMillis": 562,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 119047,
                        "executionTimeMillisEstimate": 50,
                        "works": 387432,
                        "advanced": 119047,
                        "needTime": 268384,
                        "needYield": 0,
                        "saveState": 393,
                        "restoreState": 393,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 119047,
                           "executionTimeMillisEstimate": 48,
                           "works": 387432,
                           "advanced": 119047,
                           "needTime": 268384,
                           "needYield": 0,
                           "saveState": 393,
                           "restoreState": 393,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 119047,
                              "executionTimeMillisEstimate": 23,
                              "works": 387432,
                              "advanced": 119047,
                              "needTime": 268384,
                              "needYield": 0,
                              "saveState": 393,
                              "restoreState": 393,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 119047,
               "executionTimeMillisEstimate": 479
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 556
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 127554,
                     "executionTimeMillis": 623,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 127554,
                        "executionTimeMillisEstimate": 78,
                        "works": 401725,
                        "advanced": 127554,
                        "needTime": 274170,
                        "needYield": 0,
                        "saveState": 408,
                        "restoreState": 408,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 127554,
                           "executionTimeMillisEstimate": 74,
                           "works": 401725,
                           "advanced": 127554,
                           "needTime": 274170,
                           "needYield": 0,
                           "saveState": 408,
                           "restoreState": 408,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 127554,
                              "executionTimeMillisEstimate": 31,
                              "works": 401725,
                              "advanced": 127554,
                              "needTime": 274170,
                              "needYield": 0,
                              "saveState": 408,
                              "restoreState": 408,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 127554,
               "executionTimeMillisEstimate": 525
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 363,
               "executionTimeMillisEstimate": 621
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425335,
         "i": 25
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425335,
            "i": 26
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 98693,
                     "executionTimeMillis": 507,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 98693,
                        "executionTimeMillisEstimate": 57,
                        "works": 320268,
                        "advanced": 98693,
                        "needTime": 221574,
                        "needYield": 0,
                        "saveState": 325,
                        "restoreState": 325,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 98693,
                           "executionTimeMillisEstimate": 55,
                           "works": 320268,
                           "advanced": 98693,
                           "needTime": 221574,
                           "needYield": 0,
                           "saveState": 325,
                           "restoreState": 325,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 98693,
                              "executionTimeMillisEstimate": 18,
                              "works": 320268,
                              "advanced": 98693,
                              "needTime": 221574,
                              "needYield": 0,
                              "saveState": 325,
                              "restoreState": 325,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 98693,
               "executionTimeMillisEstimate": 430
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 499
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 119047,
                     "executionTimeMillis": 597,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 119047,
                        "executionTimeMillisEstimate": 67,
                        "works": 387432,
                        "advanced": 119047,
                        "needTime": 268384,
                        "needYield": 0,
                        "saveState": 394,
                        "restoreState": 394,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 119047,
                           "executionTimeMillisEstimate": 51,
                           "works": 387432,
                           "advanced": 119047,
                           "needTime": 268384,
                           "needYield": 0,
                           "saveState": 394,
                           "restoreState": 394,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 119047,
                              "executionTimeMillisEstimate": 12,
                              "works": 387432,
                              "advanced": 119047,
                              "needTime": 268384,
                              "needYield": 0,
                              "saveState": 394,
                              "restoreState": 394,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 119047,
               "executionTimeMillisEstimate": 512
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 595
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 127554,
                     "executionTimeMillis": 650,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 127554,
                        "executionTimeMillisEstimate": 81,
                        "works": 401725,
                        "advanced": 127554,
                        "needTime": 274170,
                        "needYield": 0,
                        "saveState": 408,
                        "restoreState": 408,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 127554,
                           "executionTimeMillisEstimate": 68,
                           "works": 401725,
                           "advanced": 127554,
                           "needTime": 274170,
                           "needYield": 0,
                           "saveState": 408,
                           "restoreState": 408,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 127554,
                              "executionTimeMillisEstimate": 34,
                              "works": 401725,
                              "advanced": 127554,
                              "needTime": 274170,
                              "needYield": 0,
                              "saveState": 408,
                              "restoreState": 408,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 127554,
               "executionTimeMillisEstimate": 539
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 649
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425335,
         "i": 37
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425335,
            "i": 37
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 320266,
                     "executionTimeMillis": 1325,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 320266,
                        "executionTimeMillisEstimate": 128,
                        "works": 320268,
                        "advanced": 320266,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 336,
                        "restoreState": 336,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 320266,
                           "executionTimeMillisEstimate": 99,
                           "works": 320268,
                           "advanced": 320266,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 336,
                           "restoreState": 336,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 320266,
                              "executionTimeMillisEstimate": 20,
                              "works": 320268,
                              "advanced": 320266,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 336,
                              "restoreState": 336,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 320266,
               "executionTimeMillisEstimate": 850
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1195,
               "executionTimeMillisEstimate": 1311
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 387430,
                     "executionTimeMillis": 1557,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 387430,
                        "executionTimeMillisEstimate": 156,
                        "works": 387432,
                        "advanced": 387430,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 407,
                        "restoreState": 407,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 387430,
                           "executionTimeMillisEstimate": 122,
                           "works": 387432,
                           "advanced": 387430,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 407,
                           "restoreState": 407,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 387430,
                              "executionTimeMillisEstimate": 28,
                              "works": 387432,
                              "advanced": 387430,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 407,
                              "restoreState": 407,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 387430,
               "executionTimeMillisEstimate": 976
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1202,
               "executionTimeMillisEstimate": 1552
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 401723,
                     "executionTimeMillis": 1729,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 401723,
                        "executionTimeMillisEstimate": 184,
                        "works": 401725,
                        "advanced": 401723,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 421,
                        "restoreState": 421,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 401723,
                           "executionTimeMillisEstimate": 144,
                           "works": 401725,
                           "advanced": 401723,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 421,
                           "restoreState": 421,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 401723,
                              "executionTimeMillisEstimate": 29,
                              "works": 401725,
                              "advanced": 401723,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 421,
                              "restoreState": 421,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 401723,
               "executionTimeMillisEstimate": 1065
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1202,
               "executionTimeMillisEstimate": 1725
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425337,
         "i": 23
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425337,
            "i": 23
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 320266,
                     "executionTimeMillis": 1267,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 320266,
                        "executionTimeMillisEstimate": 105,
                        "works": 320268,
                        "advanced": 320266,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 344,
                        "restoreState": 344,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 320266,
                           "executionTimeMillisEstimate": 76,
                           "works": 320268,
                           "advanced": 320266,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 344,
                           "restoreState": 344,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 320266,
                              "executionTimeMillisEstimate": 15,
                              "works": 320268,
                              "advanced": 320266,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 344,
                              "restoreState": 344,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 320266,
               "executionTimeMillisEstimate": 809
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1201,
               "executionTimeMillisEstimate": 1265
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 387430,
                     "executionTimeMillis": 1457,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 387430,
                        "executionTimeMillisEstimate": 134,
                        "works": 387432,
                        "advanced": 387430,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 415,
                        "restoreState": 415,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 387430,
                           "executionTimeMillisEstimate": 114,
                           "works": 387432,
                           "advanced": 387430,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 415,
                           "restoreState": 415,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 387430,
                              "executionTimeMillisEstimate": 23,
                              "works": 387432,
                              "advanced": 387430,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 415,
                              "restoreState": 415,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 387430,
               "executionTimeMillisEstimate": 951
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1203,
               "executionTimeMillisEstimate": 1457
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 401723,
                     "executionTimeMillis": 1666,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 401723,
                        "executionTimeMillisEstimate": 142,
                        "works": 401725,
                        "advanced": 401723,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 431,
                        "restoreState": 431,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 401723,
                           "executionTimeMillisEstimate": 116,
                           "works": 401725,
                           "advanced": 401723,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 431,
                           "restoreState": 431,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 401723,
                              "executionTimeMillisEstimate": 18,
                              "works": 401725,
                              "advanced": 401723,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 431,
                              "restoreState": 431,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 401723,
               "executionTimeMillisEstimate": 1027
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1198,
               "executionTimeMillisEstimate": 1657
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425338,
         "i": 37
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425338,
            "i": 37
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 3738,
            "executionTimeMillis": 53,
            "totalKeysExamined": 25937,
            "totalDocsExamined": 25937,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 3738,
               "executionTimeMillisEstimate": 5,
               "works": 25938,
               "advanced": 3738,
               "needTime": 22199,
               "needYield": 0,
               "saveState": 25,
               "restoreState": 25,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 3738,
                  "executionTimeMillisEstimate": 5,
                  "works": 25938,
                  "advanced": 3738,
                  "needTime": 22199,
                  "needYield": 0,
                  "saveState": 25,
                  "restoreState": 25,
                  "isEOF": 1,
                  "docsExamined": 25937,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 25937,
                     "executionTimeMillisEstimate": 2,
                     "works": 25938,
                     "advanced": 25937,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 25,
                     "restoreState": 25,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     },
                     "keysExamined": 25937,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 5340,
            "executionTimeMillis": 80,
            "totalKeysExamined": 37538,
            "totalDocsExamined": 37538,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 5340,
               "executionTimeMillisEstimate": 4,
               "works": 37539,
               "advanced": 5340,
               "needTime": 32198,
               "needYield": 0,
               "saveState": 37,
               "restoreState": 37,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 5340,
                  "executionTimeMillisEstimate": 4,
                  "works": 37539,
                  "advanced": 5340,
                  "needTime": 32198,
                  "needYield": 0,
                  "saveState": 37,
                  "restoreState": 37,
                  "isEOF": 1,
                  "docsExamined": 37538,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 37538,
                     "executionTimeMillisEstimate": 3,
                     "works": 37539,
                     "advanced": 37538,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 37,
                     "restoreState": 37,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     },
                     "keysExamined": 37538,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 5747,
            "executionTimeMillis": 88,
            "totalKeysExamined": 39973,
            "totalDocsExamined": 39973,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 5747,
               "executionTimeMillisEstimate": 9,
               "works": 39974,
               "advanced": 5747,
               "needTime": 34226,
               "needYield": 0,
               "saveState": 39,
               "restoreState": 39,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 5747,
                  "executionTimeMillisEstimate": 9,
                  "works": 39974,
                  "advanced": 5747,
                  "needTime": 34226,
                  "needYield": 0,
                  "saveState": 39,
                  "restoreState": 39,
                  "isEOF": 1,
                  "docsExamined": 39973,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 39973,
                     "executionTimeMillisEstimate": 4,
                     "works": 39974,
                     "advanced": 39973,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 39,
                     "restoreState": 39,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     },
                     "keysExamined": 39973,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425338,
         "i": 37
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425338,
            "i": 37
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 320266,
                     "executionTimeMillis": 1852,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 320266,
                        "executionTimeMillisEstimate": 414,
                        "works": 320268,
                        "advanced": 320266,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 358,
                        "restoreState": 358,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 320266,
                           "executionTimeMillisEstimate": 211,
                           "works": 320268,
                           "advanced": 320266,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 358,
                           "restoreState": 358,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 320266,
                              "executionTimeMillisEstimate": 32,
                              "works": 320268,
                              "advanced": 320266,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 358,
                              "restoreState": 358,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 320266,
               "executionTimeMillisEstimate": 1572
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2515,
               "executionTimeMillisEstimate": 1847
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 387430,
                     "executionTimeMillis": 2188,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 387430,
                        "executionTimeMillisEstimate": 517,
                        "works": 387432,
                        "advanced": 387430,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 433,
                        "restoreState": 433,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 387430,
                           "executionTimeMillisEstimate": 231,
                           "works": 387432,
                           "advanced": 387430,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 433,
                           "restoreState": 433,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 387430,
                              "executionTimeMillisEstimate": 47,
                              "works": 387432,
                              "advanced": 387430,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 433,
                              "restoreState": 433,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 387430,
               "executionTimeMillisEstimate": 1860
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2534,
               "executionTimeMillisEstimate": 2186
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 401723,
                     "executionTimeMillis": 2320,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 401723,
                        "executionTimeMillisEstimate": 524,
                        "works": 401725,
                        "advanced": 401723,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 449,
                        "restoreState": 449,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 401723,
                           "executionTimeMillisEstimate": 236,
                           "works": 401725,
                           "advanced": 401723,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 449,
                           "restoreState": 449,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 401723,
                              "executionTimeMillisEstimate": 74,
                              "works": 401725,
                              "advanced": 401723,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 449,
                              "restoreState": 449,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 401723,
               "executionTimeMillisEstimate": 1928
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2523,
               "executionTimeMillisEstimate": 2317
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425341,
         "i": 4335
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425341,
            "i": 4335
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 320266,
                     "executionTimeMillis": 1655,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 320266,
                        "executionTimeMillisEstimate": 299,
                        "works": 320268,
                        "advanced": 320266,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 358,
                        "restoreState": 358,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 320266,
                           "executionTimeMillisEstimate": 139,
                           "works": 320268,
                           "advanced": 320266,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 358,
                           "restoreState": 358,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 320266,
                              "executionTimeMillisEstimate": 39,
                              "works": 320268,
                              "advanced": 320266,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 358,
                              "restoreState": 358,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 320266,
               "executionTimeMillisEstimate": 1412
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2526,
               "executionTimeMillisEstimate": 1648
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 387430,
                     "executionTimeMillis": 1977,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 387430,
                        "executionTimeMillisEstimate": 346,
                        "works": 387432,
                        "advanced": 387430,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 433,
                        "restoreState": 433,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 387430,
                           "executionTimeMillisEstimate": 147,
                           "works": 387432,
                           "advanced": 387430,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 433,
                           "restoreState": 433,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 387430,
                              "executionTimeMillisEstimate": 43,
                              "works": 387432,
                              "advanced": 387430,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 433,
                              "restoreState": 433,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 387430,
               "executionTimeMillisEstimate": 1713
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2527,
               "executionTimeMillisEstimate": 1966
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 401723,
                     "executionTimeMillis": 2095,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 401723,
                        "executionTimeMillisEstimate": 443,
                        "works": 401725,
                        "advanced": 401723,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 449,
                        "restoreState": 449,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 401723,
                           "executionTimeMillisEstimate": 174,
                           "works": 401725,
                           "advanced": 401723,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 449,
                           "restoreState": 449,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 401723,
                              "executionTimeMillisEstimate": 47,
                              "works": 401725,
                              "advanced": 401723,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 449,
                              "restoreState": 449,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 401723,
               "executionTimeMillisEstimate": 1769
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2517,
               "executionTimeMillisEstimate": 2088
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425343,
         "i": 2527
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425343,
            "i": 2527
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 320266,
                     "executionTimeMillis": 903,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 320266,
                        "executionTimeMillisEstimate": 92,
                        "works": 320268,
                        "advanced": 320266,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 332,
                        "restoreState": 332,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 320266,
                           "executionTimeMillisEstimate": 80,
                           "works": 320268,
                           "advanced": 320266,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 332,
                           "restoreState": 332,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 320266,
                              "executionTimeMillisEstimate": 17,
                              "works": 320268,
                              "advanced": 320266,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 332,
                              "restoreState": 332,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 320266,
               "executionTimeMillisEstimate": 676
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 894
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 387430,
                     "executionTimeMillis": 1072,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 387430,
                        "executionTimeMillisEstimate": 59,
                        "works": 387432,
                        "advanced": 387430,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 401,
                        "restoreState": 401,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 387430,
                           "executionTimeMillisEstimate": 47,
                           "works": 387432,
                           "advanced": 387430,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 401,
                           "restoreState": 401,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 387430,
                              "executionTimeMillisEstimate": 10,
                              "works": 387432,
                              "advanced": 387430,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 401,
                              "restoreState": 401,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 387430,
               "executionTimeMillisEstimate": 832
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1063
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 401723,
                     "executionTimeMillis": 1148,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 401723,
                        "executionTimeMillisEstimate": 122,
                        "works": 401725,
                        "advanced": 401723,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 417,
                        "restoreState": 417,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 401723,
                           "executionTimeMillisEstimate": 103,
                           "works": 401725,
                           "advanced": 401723,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 417,
                           "restoreState": 417,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 401723,
                              "executionTimeMillisEstimate": 27,
                              "works": 401725,
                              "advanced": 401723,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 417,
                              "restoreState": 417,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 401723,
               "executionTimeMillisEstimate": 880
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1143
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425344,
         "i": 2552
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425344,
            "i": 2552
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 51996,
                     "executionTimeMillis": 312,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 51996,
                        "executionTimeMillisEstimate": 24,
                        "works": 320268,
                        "advanced": 51996,
                        "needTime": 268271,
                        "needYield": 0,
                        "saveState": 323,
                        "restoreState": 323,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 51996,
                           "executionTimeMillisEstimate": 24,
                           "works": 320268,
                           "advanced": 51996,
                           "needTime": 268271,
                           "needYield": 0,
                           "saveState": 323,
                           "restoreState": 323,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 51996,
                              "executionTimeMillisEstimate": 12,
                              "works": 320268,
                              "advanced": 51996,
                              "needTime": 268271,
                              "needYield": 0,
                              "saveState": 323,
                              "restoreState": 323,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 51996,
               "executionTimeMillisEstimate": 278
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 362,
               "executionTimeMillisEstimate": 302
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 62911,
                     "executionTimeMillis": 380,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 62911,
                        "executionTimeMillisEstimate": 19,
                        "works": 387432,
                        "advanced": 62911,
                        "needTime": 324520,
                        "needYield": 0,
                        "saveState": 389,
                        "restoreState": 389,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 62911,
                           "executionTimeMillisEstimate": 17,
                           "works": 387432,
                           "advanced": 62911,
                           "needTime": 324520,
                           "needYield": 0,
                           "saveState": 389,
                           "restoreState": 389,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 62911,
                              "executionTimeMillisEstimate": 4,
                              "works": 387432,
                              "advanced": 62911,
                              "needTime": 324520,
                              "needYield": 0,
                              "saveState": 389,
                              "restoreState": 389,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 62911,
               "executionTimeMillisEstimate": 339
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 374
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 67746,
                     "executionTimeMillis": 407,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 67746,
                        "executionTimeMillisEstimate": 21,
                        "works": 401725,
                        "advanced": 67746,
                        "needTime": 333978,
                        "needYield": 0,
                        "saveState": 403,
                        "restoreState": 403,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 67746,
                           "executionTimeMillisEstimate": 18,
                           "works": 401725,
                           "advanced": 67746,
                           "needTime": 333978,
                           "needYield": 0,
                           "saveState": 403,
                           "restoreState": 403,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 67746,
                              "executionTimeMillisEstimate": 8,
                              "works": 401725,
                              "advanced": 67746,
                              "needTime": 333978,
                              "needYield": 0,
                              "saveState": 403,
                              "restoreState": 403,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 67746,
               "executionTimeMillisEstimate": 357
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 401
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425344,
         "i": 2552
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425344,
            "i": 2552
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 51996,
                     "executionTimeMillis": 319,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 320266,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 51996,
                        "executionTimeMillisEstimate": 41,
                        "works": 320268,
                        "advanced": 51996,
                        "needTime": 268271,
                        "needYield": 0,
                        "saveState": 322,
                        "restoreState": 322,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 51996,
                           "executionTimeMillisEstimate": 39,
                           "works": 320268,
                           "advanced": 51996,
                           "needTime": 268271,
                           "needYield": 0,
                           "saveState": 322,
                           "restoreState": 322,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 51996,
                              "executionTimeMillisEstimate": 21,
                              "works": 320268,
                              "advanced": 51996,
                              "needTime": 268271,
                              "needYield": 0,
                              "saveState": 322,
                              "restoreState": 322,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 320266
                           }
                        }
                     }
                  }
               },
               "nReturned": 51996,
               "executionTimeMillisEstimate": 300
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 362,
               "executionTimeMillisEstimate": 319
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 62911,
                     "executionTimeMillis": 379,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 387430,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 62911,
                        "executionTimeMillisEstimate": 20,
                        "works": 387432,
                        "advanced": 62911,
                        "needTime": 324520,
                        "needYield": 0,
                        "saveState": 390,
                        "restoreState": 390,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 62911,
                           "executionTimeMillisEstimate": 16,
                           "works": 387432,
                           "advanced": 62911,
                           "needTime": 324520,
                           "needYield": 0,
                           "saveState": 390,
                           "restoreState": 390,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 62911,
                              "executionTimeMillisEstimate": 10,
                              "works": 387432,
                              "advanced": 62911,
                              "needTime": 324520,
                              "needYield": 0,
                              "saveState": 390,
                              "restoreState": 390,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 387430
                           }
                        }
                     }
                  }
               },
               "nReturned": 62911,
               "executionTimeMillisEstimate": 343
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 362,
               "executionTimeMillisEstimate": 373
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 67746,
                     "executionTimeMillis": 406,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 401723,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 67746,
                        "executionTimeMillisEstimate": 65,
                        "works": 401725,
                        "advanced": 67746,
                        "needTime": 333978,
                        "needYield": 0,
                        "saveState": 404,
                        "restoreState": 404,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 67746,
                           "executionTimeMillisEstimate": 60,
                           "works": 401725,
                           "advanced": 67746,
                           "needTime": 333978,
                           "needYield": 0,
                           "saveState": 404,
                           "restoreState": 404,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 67746,
                              "executionTimeMillisEstimate": 34,
                              "works": 401725,
                              "advanced": 67746,
                              "needTime": 333978,
                              "needYield": 0,
                              "saveState": 404,
                              "restoreState": 404,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 401723
                           }
                        }
                     }
                  }
               },
               "nReturned": 67746,
               "executionTimeMillisEstimate": 362
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 363,
               "executionTimeMillisEstimate": 400
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425345,
         "i": 2540
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425345,
            "i": 2540
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_ARR_DELAY_range<a name="AirlineData_ARR_DELAY_range"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 1,
            "totalKeysExamined": 4,
            "totalDocsExamined": 4,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 0,
               "works": 5,
               "advanced": 0,
               "needTime": 4,
               "needYield": 0,
               "saveState": 0,
               "restoreState": 0,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 0,
                  "works": 5,
                  "advanced": 0,
                  "needTime": 4,
                  "needYield": 0,
                  "saveState": 0,
                  "restoreState": 0,
                  "isEOF": 1,
                  "docsExamined": 4,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 4,
                     "executionTimeMillisEstimate": 0,
                     "works": 5,
                     "advanced": 4,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 0,
                     "restoreState": 0,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     },
                     "keysExamined": 4,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 2,
            "executionTimeMillis": 3,
            "totalKeysExamined": 138,
            "totalDocsExamined": 138,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 2,
               "executionTimeMillisEstimate": 0,
               "works": 139,
               "advanced": 2,
               "needTime": 136,
               "needYield": 0,
               "saveState": 0,
               "restoreState": 0,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  "nReturned": 2,
                  "executionTimeMillisEstimate": 0,
                  "works": 139,
                  "advanced": 2,
                  "needTime": 136,
                  "needYield": 0,
                  "saveState": 0,
                  "restoreState": 0,
                  "isEOF": 1,
                  "docsExamined": 138,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 138,
                     "executionTimeMillisEstimate": 0,
                     "works": 139,
                     "advanced": 138,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 0,
                     "restoreState": 0,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(1000, inf.0]"
                        ]
                     },
                     "keysExamined": 138,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425345,
         "i": 2542
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425345,
            "i": 2542
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76436,
                     "executionTimeMillis": 280,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76436,
                        "executionTimeMillisEstimate": 52,
                        "works": 76438,
                        "advanced": 76436,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 80,
                        "restoreState": 80,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76436,
                           "executionTimeMillisEstimate": 39,
                           "works": 76438,
                           "advanced": 76436,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 80,
                           "restoreState": 80,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 76436,
                              "executionTimeMillisEstimate": 16,
                              "works": 76438,
                              "advanced": 76436,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 80,
                              "restoreState": 80,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 76436,
               "executionTimeMillisEstimate": 228
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 277
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89390,
                     "executionTimeMillis": 323,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 89390,
                        "executionTimeMillisEstimate": 38,
                        "works": 89392,
                        "advanced": 89390,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 94,
                        "restoreState": 94,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 89390,
                           "executionTimeMillisEstimate": 30,
                           "works": 89392,
                           "advanced": 89390,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 94,
                           "restoreState": 94,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 89390,
                              "executionTimeMillisEstimate": 5,
                              "works": 89392,
                              "advanced": 89390,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 94,
                              "restoreState": 94,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 89390,
               "executionTimeMillisEstimate": 268
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 320
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 943593,
                     "executionTimeMillis": 3666,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 943593,
                        "executionTimeMillisEstimate": 520,
                        "works": 1047043,
                        "advanced": 943593,
                        "needTime": 103449,
                        "needYield": 0,
                        "saveState": 1096,
                        "restoreState": 1096,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 943593,
                           "executionTimeMillisEstimate": 458,
                           "works": 1047043,
                           "advanced": 943593,
                           "needTime": 103449,
                           "needYield": 0,
                           "saveState": 1096,
                           "restoreState": 1096,
                           "isEOF": 1,
                           "chunkSkips": 103448,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1047041,
                              "executionTimeMillisEstimate": 258,
                              "works": 1047043,
                              "advanced": 1047041,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1096,
                              "restoreState": 1096,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 943593,
               "executionTimeMillisEstimate": 2988
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 3665
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425349,
         "i": 3001
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425349,
            "i": 3001
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76436,
                     "executionTimeMillis": 195,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76436,
                        "executionTimeMillisEstimate": 18,
                        "works": 76438,
                        "advanced": 76436,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 79,
                        "restoreState": 79,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76436,
                           "executionTimeMillisEstimate": 18,
                           "works": 76438,
                           "advanced": 76436,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 79,
                           "restoreState": 79,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 76436,
                              "executionTimeMillisEstimate": 5,
                              "works": 76438,
                              "advanced": 76436,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 79,
                              "restoreState": 79,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 76436,
               "executionTimeMillisEstimate": 143
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 369,
               "executionTimeMillisEstimate": 188
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89390,
                     "executionTimeMillis": 228,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 89390,
                        "executionTimeMillisEstimate": 19,
                        "works": 89392,
                        "advanced": 89390,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 92,
                        "restoreState": 92,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 89390,
                           "executionTimeMillisEstimate": 13,
                           "works": 89392,
                           "advanced": 89390,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 92,
                           "restoreState": 92,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 89390,
                              "executionTimeMillisEstimate": 5,
                              "works": 89392,
                              "advanced": 89390,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 92,
                              "restoreState": 92,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 89390,
               "executionTimeMillisEstimate": 161
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 368,
               "executionTimeMillisEstimate": 220
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 943593,
                     "executionTimeMillis": 2939,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 943593,
                        "executionTimeMillisEstimate": 310,
                        "works": 1047043,
                        "advanced": 943593,
                        "needTime": 103449,
                        "needYield": 0,
                        "saveState": 1092,
                        "restoreState": 1092,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 943593,
                           "executionTimeMillisEstimate": 244,
                           "works": 1047043,
                           "advanced": 943593,
                           "needTime": 103449,
                           "needYield": 0,
                           "saveState": 1092,
                           "restoreState": 1092,
                           "isEOF": 1,
                           "chunkSkips": 103448,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1047041,
                              "executionTimeMillisEstimate": 82,
                              "works": 1047043,
                              "advanced": 1047041,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1092,
                              "restoreState": 1092,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 943593,
               "executionTimeMillisEstimate": 2208
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 369,
               "executionTimeMillisEstimate": 2935
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425352,
         "i": 1890
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425352,
            "i": 1890
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76436,
                     "executionTimeMillis": 186,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76436,
                        "executionTimeMillisEstimate": 14,
                        "works": 76438,
                        "advanced": 76436,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 80,
                        "restoreState": 80,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76436,
                           "executionTimeMillisEstimate": 14,
                           "works": 76438,
                           "advanced": 76436,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 80,
                           "restoreState": 80,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 76436,
                              "executionTimeMillisEstimate": 5,
                              "works": 76438,
                              "advanced": 76436,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 80,
                              "restoreState": 80,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 76436,
               "executionTimeMillisEstimate": 134
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 368,
               "executionTimeMillisEstimate": 183
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89390,
                     "executionTimeMillis": 211,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 89390,
                        "executionTimeMillisEstimate": 13,
                        "works": 89392,
                        "advanced": 89390,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 93,
                        "restoreState": 93,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 89390,
                           "executionTimeMillisEstimate": 12,
                           "works": 89392,
                           "advanced": 89390,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 93,
                           "restoreState": 93,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 89390,
                              "executionTimeMillisEstimate": 2,
                              "works": 89392,
                              "advanced": 89390,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 93,
                              "restoreState": 93,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 89390,
               "executionTimeMillisEstimate": 157
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 207
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 943593,
                     "executionTimeMillis": 2763,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 943593,
                        "executionTimeMillisEstimate": 291,
                        "works": 1047043,
                        "advanced": 943593,
                        "needTime": 103449,
                        "needYield": 0,
                        "saveState": 1093,
                        "restoreState": 1093,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 943593,
                           "executionTimeMillisEstimate": 246,
                           "works": 1047043,
                           "advanced": 943593,
                           "needTime": 103449,
                           "needYield": 0,
                           "saveState": 1093,
                           "restoreState": 1093,
                           "isEOF": 1,
                           "chunkSkips": 103448,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1047041,
                              "executionTimeMillisEstimate": 61,
                              "works": 1047043,
                              "advanced": 1047041,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1093,
                              "restoreState": 1093,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 943593,
               "executionTimeMillisEstimate": 2106
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 369,
               "executionTimeMillisEstimate": 2759
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425355,
         "i": 2482
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425355,
            "i": 2482
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "1BE9BC01",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 49147,
                     "executionTimeMillis": 204,
                     "totalKeysExamined": 49147,
                     "totalDocsExamined": 49147,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 49147,
                        "executionTimeMillisEstimate": 33,
                        "works": 49148,
                        "advanced": 49147,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 51,
                        "restoreState": 51,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 49147,
                           "executionTimeMillisEstimate": 25,
                           "works": 49148,
                           "advanced": 49147,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 51,
                           "restoreState": 51,
                           "isEOF": 1,
                           "docsExamined": 49147,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 49147,
                              "executionTimeMillisEstimate": 16,
                              "works": 49148,
                              "advanced": 49147,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 51,
                              "restoreState": 51,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 49147,
                                 "executionTimeMillisEstimate": 9,
                                 "works": 49148,
                                 "advanced": 49147,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 51,
                                 "restoreState": 51,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 49147,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 49147,
               "executionTimeMillisEstimate": 157
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 196
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "1BE9BC01",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 54301,
                     "executionTimeMillis": 234,
                     "totalKeysExamined": 54301,
                     "totalDocsExamined": 54301,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 54301,
                        "executionTimeMillisEstimate": 36,
                        "works": 54302,
                        "advanced": 54301,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 56,
                        "restoreState": 56,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 54301,
                           "executionTimeMillisEstimate": 34,
                           "works": 54302,
                           "advanced": 54301,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 56,
                           "restoreState": 56,
                           "isEOF": 1,
                           "docsExamined": 54301,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 54301,
                              "executionTimeMillisEstimate": 19,
                              "works": 54302,
                              "advanced": 54301,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 56,
                              "restoreState": 56,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 54301,
                                 "executionTimeMillisEstimate": 2,
                                 "works": 54302,
                                 "advanced": 54301,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 56,
                                 "restoreState": 56,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 54301,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 54301,
               "executionTimeMillisEstimate": 181
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 363,
               "executionTimeMillisEstimate": 227
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "1BE9BC01",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 112067,
                     "executionTimeMillis": 1182,
                     "totalKeysExamined": 215515,
                     "totalDocsExamined": 112067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 112067,
                        "executionTimeMillisEstimate": 535,
                        "works": 215516,
                        "advanced": 112067,
                        "needTime": 103448,
                        "needYield": 0,
                        "saveState": 228,
                        "restoreState": 228,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 112067,
                           "executionTimeMillisEstimate": 498,
                           "works": 215516,
                           "advanced": 112067,
                           "needTime": 103448,
                           "needYield": 0,
                           "saveState": 228,
                           "restoreState": 228,
                           "isEOF": 1,
                           "docsExamined": 112067,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 112067,
                              "executionTimeMillisEstimate": 169,
                              "works": 215516,
                              "advanced": 112067,
                              "needTime": 103448,
                              "needYield": 0,
                              "saveState": 228,
                              "restoreState": 228,
                              "isEOF": 1,
                              "chunkSkips": 103448,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 215515,
                                 "executionTimeMillisEstimate": 122,
                                 "works": 215516,
                                 "advanced": 215515,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 228,
                                 "restoreState": 228,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 215515,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 112067,
               "executionTimeMillisEstimate": 1091
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 1175
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425356,
         "i": 640
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425356,
            "i": 640
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "74508863",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 49147,
                     "executionTimeMillis": 190,
                     "totalKeysExamined": 49147,
                     "totalDocsExamined": 49147,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 49147,
                        "executionTimeMillisEstimate": 18,
                        "works": 49148,
                        "advanced": 49147,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 51,
                        "restoreState": 51,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 49147,
                           "executionTimeMillisEstimate": 16,
                           "works": 49148,
                           "advanced": 49147,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 51,
                           "restoreState": 51,
                           "isEOF": 1,
                           "docsExamined": 49147,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 49147,
                              "executionTimeMillisEstimate": 13,
                              "works": 49148,
                              "advanced": 49147,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 51,
                              "restoreState": 51,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 49147,
                                 "executionTimeMillisEstimate": 7,
                                 "works": 49148,
                                 "advanced": 49147,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 51,
                                 "restoreState": 51,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 49147,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 49147,
               "executionTimeMillisEstimate": 150
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 186
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "74508863",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 54301,
                     "executionTimeMillis": 201,
                     "totalKeysExamined": 54301,
                     "totalDocsExamined": 54301,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 54301,
                        "executionTimeMillisEstimate": 27,
                        "works": 54302,
                        "advanced": 54301,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 57,
                        "restoreState": 57,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 54301,
                           "executionTimeMillisEstimate": 25,
                           "works": 54302,
                           "advanced": 54301,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 57,
                           "restoreState": 57,
                           "isEOF": 1,
                           "docsExamined": 54301,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 54301,
                              "executionTimeMillisEstimate": 17,
                              "works": 54302,
                              "advanced": 54301,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 57,
                              "restoreState": 57,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 54301,
                                 "executionTimeMillisEstimate": 6,
                                 "works": 54302,
                                 "advanced": 54301,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 57,
                                 "restoreState": 57,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 54301,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 54301,
               "executionTimeMillisEstimate": 157
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 361,
               "executionTimeMillisEstimate": 197
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "74508863",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 112067,
                     "executionTimeMillis": 686,
                     "totalKeysExamined": 215515,
                     "totalDocsExamined": 112067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 112067,
                        "executionTimeMillisEstimate": 145,
                        "works": 215516,
                        "advanced": 112067,
                        "needTime": 103448,
                        "needYield": 0,
                        "saveState": 222,
                        "restoreState": 222,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 112067,
                           "executionTimeMillisEstimate": 132,
                           "works": 215516,
                           "advanced": 112067,
                           "needTime": 103448,
                           "needYield": 0,
                           "saveState": 222,
                           "restoreState": 222,
                           "isEOF": 1,
                           "docsExamined": 112067,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 112067,
                              "executionTimeMillisEstimate": 44,
                              "works": 215516,
                              "advanced": 112067,
                              "needTime": 103448,
                              "needYield": 0,
                              "saveState": 222,
                              "restoreState": 222,
                              "isEOF": 1,
                              "chunkSkips": 103448,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 215515,
                                 "executionTimeMillisEstimate": 22,
                                 "works": 215516,
                                 "advanced": 215515,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 222,
                                 "restoreState": 222,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 215515,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 112067,
               "executionTimeMillisEstimate": 594
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 363,
               "executionTimeMillisEstimate": 680
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425356,
         "i": 3166
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425357,
            "i": 6
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "F0760901",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 49147,
                     "executionTimeMillis": 159,
                     "totalKeysExamined": 49147,
                     "totalDocsExamined": 49147,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 49147,
                        "executionTimeMillisEstimate": 20,
                        "works": 49148,
                        "advanced": 49147,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 51,
                        "restoreState": 51,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 49147,
                           "executionTimeMillisEstimate": 16,
                           "works": 49148,
                           "advanced": 49147,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 51,
                           "restoreState": 51,
                           "isEOF": 1,
                           "docsExamined": 49147,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 49147,
                              "executionTimeMillisEstimate": 11,
                              "works": 49148,
                              "advanced": 49147,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 51,
                              "restoreState": 51,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 49147,
                                 "executionTimeMillisEstimate": 2,
                                 "works": 49148,
                                 "advanced": 49147,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 51,
                                 "restoreState": 51,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 49147,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 49147,
               "executionTimeMillisEstimate": 127
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 159
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "F0760901",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 54301,
                     "executionTimeMillis": 171,
                     "totalKeysExamined": 54301,
                     "totalDocsExamined": 54301,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 54301,
                        "executionTimeMillisEstimate": 18,
                        "works": 54302,
                        "advanced": 54301,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 56,
                        "restoreState": 56,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 54301,
                           "executionTimeMillisEstimate": 18,
                           "works": 54302,
                           "advanced": 54301,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 56,
                           "restoreState": 56,
                           "isEOF": 1,
                           "docsExamined": 54301,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 54301,
                              "executionTimeMillisEstimate": 13,
                              "works": 54302,
                              "advanced": 54301,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 56,
                              "restoreState": 56,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 54301,
                                 "executionTimeMillisEstimate": 3,
                                 "works": 54302,
                                 "advanced": 54301,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 56,
                                 "restoreState": 56,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 54301,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 54301,
               "executionTimeMillisEstimate": 135
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 167
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "F0760901",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 112067,
                     "executionTimeMillis": 580,
                     "totalKeysExamined": 215515,
                     "totalDocsExamined": 112067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 112067,
                        "executionTimeMillisEstimate": 65,
                        "works": 215516,
                        "advanced": 112067,
                        "needTime": 103448,
                        "needYield": 0,
                        "saveState": 220,
                        "restoreState": 220,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 112067,
                           "executionTimeMillisEstimate": 59,
                           "works": 215516,
                           "advanced": 112067,
                           "needTime": 103448,
                           "needYield": 0,
                           "saveState": 220,
                           "restoreState": 220,
                           "isEOF": 1,
                           "docsExamined": 112067,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 112067,
                              "executionTimeMillisEstimate": 36,
                              "works": 215516,
                              "advanced": 112067,
                              "needTime": 103448,
                              "needYield": 0,
                              "saveState": 220,
                              "restoreState": 220,
                              "isEOF": 1,
                              "chunkSkips": 103448,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 215515,
                                 "executionTimeMillisEstimate": 11,
                                 "works": 215516,
                                 "advanced": 215515,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 220,
                                 "restoreState": 220,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "ARR_DELAY": 1
                                 },
                                 "indexName": "ARR_DELAY_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "ARR_DELAY": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "ARR_DELAY": [
                                       "(0, inf.0]"
                                    ]
                                 },
                                 "keysExamined": 215515,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 112067,
               "executionTimeMillisEstimate": 497
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 577
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425357,
         "i": 6
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425357,
            "i": 6
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 21198,
                     "executionTimeMillis": 80,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 21198,
                        "executionTimeMillisEstimate": 2,
                        "works": 76438,
                        "advanced": 21198,
                        "needTime": 55239,
                        "needYield": 0,
                        "saveState": 77,
                        "restoreState": 77,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 21198,
                           "executionTimeMillisEstimate": 2,
                           "works": 76438,
                           "advanced": 21198,
                           "needTime": 55239,
                           "needYield": 0,
                           "saveState": 77,
                           "restoreState": 77,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 21198,
                              "executionTimeMillisEstimate": 1,
                              "works": 76438,
                              "advanced": 21198,
                              "needTime": 55239,
                              "needYield": 0,
                              "saveState": 77,
                              "restoreState": 77,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 21198,
               "executionTimeMillisEstimate": 64
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 360,
               "executionTimeMillisEstimate": 76
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 24528,
                     "executionTimeMillis": 91,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 24528,
                        "executionTimeMillisEstimate": 3,
                        "works": 89392,
                        "advanced": 24528,
                        "needTime": 64863,
                        "needYield": 0,
                        "saveState": 90,
                        "restoreState": 90,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 24528,
                           "executionTimeMillisEstimate": 2,
                           "works": 89392,
                           "advanced": 24528,
                           "needTime": 64863,
                           "needYield": 0,
                           "saveState": 90,
                           "restoreState": 90,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 24528,
                              "executionTimeMillisEstimate": 2,
                              "works": 89392,
                              "advanced": 24528,
                              "needTime": 64863,
                              "needYield": 0,
                              "saveState": 90,
                              "restoreState": 90,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 24528,
               "executionTimeMillisEstimate": 73
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 358,
               "executionTimeMillisEstimate": 86
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 299568,
                     "executionTimeMillis": 1222,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 299568,
                        "executionTimeMillisEstimate": 114,
                        "works": 1047043,
                        "advanced": 299568,
                        "needTime": 747474,
                        "needYield": 0,
                        "saveState": 1062,
                        "restoreState": 1062,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 299568,
                           "executionTimeMillisEstimate": 96,
                           "works": 1047043,
                           "advanced": 299568,
                           "needTime": 747474,
                           "needYield": 0,
                           "saveState": 1062,
                           "restoreState": 1062,
                           "isEOF": 1,
                           "chunkSkips": 26890,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 326458,
                              "executionTimeMillisEstimate": 46,
                              "works": 1047043,
                              "advanced": 326458,
                              "needTime": 720584,
                              "needYield": 0,
                              "saveState": 1062,
                              "restoreState": 1062,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 299568,
               "executionTimeMillisEstimate": 1025
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 1216
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425358,
         "i": 2544
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425358,
            "i": 2551
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 21198,
                     "executionTimeMillis": 79,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 21198,
                        "executionTimeMillisEstimate": 3,
                        "works": 76438,
                        "advanced": 21198,
                        "needTime": 55239,
                        "needYield": 0,
                        "saveState": 77,
                        "restoreState": 77,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 21198,
                           "executionTimeMillisEstimate": 3,
                           "works": 76438,
                           "advanced": 21198,
                           "needTime": 55239,
                           "needYield": 0,
                           "saveState": 77,
                           "restoreState": 77,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 21198,
                              "executionTimeMillisEstimate": 3,
                              "works": 76438,
                              "advanced": 21198,
                              "needTime": 55239,
                              "needYield": 0,
                              "saveState": 77,
                              "restoreState": 77,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 21198,
               "executionTimeMillisEstimate": 63
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 354,
               "executionTimeMillisEstimate": 70
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 24528,
                     "executionTimeMillis": 90,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 24528,
                        "executionTimeMillisEstimate": 5,
                        "works": 89392,
                        "advanced": 24528,
                        "needTime": 64863,
                        "needYield": 0,
                        "saveState": 90,
                        "restoreState": 90,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 24528,
                           "executionTimeMillisEstimate": 4,
                           "works": 89392,
                           "advanced": 24528,
                           "needTime": 64863,
                           "needYield": 0,
                           "saveState": 90,
                           "restoreState": 90,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 24528,
                              "executionTimeMillisEstimate": 2,
                              "works": 89392,
                              "advanced": 24528,
                              "needTime": 64863,
                              "needYield": 0,
                              "saveState": 90,
                              "restoreState": 90,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 24528,
               "executionTimeMillisEstimate": 73
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 352,
               "executionTimeMillisEstimate": 88
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 299568,
                     "executionTimeMillis": 1208,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 299568,
                        "executionTimeMillisEstimate": 108,
                        "works": 1047043,
                        "advanced": 299568,
                        "needTime": 747474,
                        "needYield": 0,
                        "saveState": 1060,
                        "restoreState": 1060,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 299568,
                           "executionTimeMillisEstimate": 82,
                           "works": 1047043,
                           "advanced": 299568,
                           "needTime": 747474,
                           "needYield": 0,
                           "saveState": 1060,
                           "restoreState": 1060,
                           "isEOF": 1,
                           "chunkSkips": 26890,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 326458,
                              "executionTimeMillisEstimate": 48,
                              "works": 1047043,
                              "advanced": 326458,
                              "needTime": 720584,
                              "needYield": 0,
                              "saveState": 1060,
                              "restoreState": 1060,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 299568,
               "executionTimeMillisEstimate": 988
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 1204
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425360,
         "i": 3456
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425360,
            "i": 3456
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 21198,
                     "executionTimeMillis": 84,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 21198,
                        "executionTimeMillisEstimate": 4,
                        "works": 76438,
                        "advanced": 21198,
                        "needTime": 55239,
                        "needYield": 0,
                        "saveState": 77,
                        "restoreState": 77,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 21198,
                           "executionTimeMillisEstimate": 4,
                           "works": 76438,
                           "advanced": 21198,
                           "needTime": 55239,
                           "needYield": 0,
                           "saveState": 77,
                           "restoreState": 77,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 21198,
                              "executionTimeMillisEstimate": 2,
                              "works": 76438,
                              "advanced": 21198,
                              "needTime": 55239,
                              "needYield": 0,
                              "saveState": 77,
                              "restoreState": 77,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 21198,
               "executionTimeMillisEstimate": 69
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 81
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 24528,
                     "executionTimeMillis": 106,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 24528,
                        "executionTimeMillisEstimate": 7,
                        "works": 89392,
                        "advanced": 24528,
                        "needTime": 64863,
                        "needYield": 0,
                        "saveState": 90,
                        "restoreState": 90,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 24528,
                           "executionTimeMillisEstimate": 5,
                           "works": 89392,
                           "advanced": 24528,
                           "needTime": 64863,
                           "needYield": 0,
                           "saveState": 90,
                           "restoreState": 90,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 24528,
                              "executionTimeMillisEstimate": 3,
                              "works": 89392,
                              "advanced": 24528,
                              "needTime": 64863,
                              "needYield": 0,
                              "saveState": 90,
                              "restoreState": 90,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 24528,
               "executionTimeMillisEstimate": 80
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 98
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 299568,
                     "executionTimeMillis": 1284,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 299568,
                        "executionTimeMillisEstimate": 106,
                        "works": 1047043,
                        "advanced": 299568,
                        "needTime": 747474,
                        "needYield": 0,
                        "saveState": 1061,
                        "restoreState": 1061,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 299568,
                           "executionTimeMillisEstimate": 83,
                           "works": 1047043,
                           "advanced": 299568,
                           "needTime": 747474,
                           "needYield": 0,
                           "saveState": 1061,
                           "restoreState": 1061,
                           "isEOF": 1,
                           "chunkSkips": 26890,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 326458,
                              "executionTimeMillisEstimate": 27,
                              "works": 1047043,
                              "advanced": 326458,
                              "needTime": 720584,
                              "needYield": 0,
                              "saveState": 1061,
                              "restoreState": 1061,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 299568,
               "executionTimeMillisEstimate": 1069
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1281
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425361,
         "i": 1
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425361,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76436,
                     "executionTimeMillis": 229,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76436,
                        "executionTimeMillisEstimate": 14,
                        "works": 76438,
                        "advanced": 76436,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 79,
                        "restoreState": 79,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76436,
                           "executionTimeMillisEstimate": 11,
                           "works": 76438,
                           "advanced": 76436,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 79,
                           "restoreState": 79,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 76436,
                              "executionTimeMillisEstimate": 1,
                              "works": 76438,
                              "advanced": 76436,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 79,
                              "restoreState": 79,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 76436,
               "executionTimeMillisEstimate": 136
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1182,
               "executionTimeMillisEstimate": 220
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89390,
                     "executionTimeMillis": 258,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 89390,
                        "executionTimeMillisEstimate": 9,
                        "works": 89392,
                        "advanced": 89390,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 94,
                        "restoreState": 94,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 89390,
                           "executionTimeMillisEstimate": 8,
                           "works": 89392,
                           "advanced": 89390,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 94,
                           "restoreState": 94,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 89390,
                              "executionTimeMillisEstimate": 1,
                              "works": 89392,
                              "advanced": 89390,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 94,
                              "restoreState": 94,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 89390,
               "executionTimeMillisEstimate": 151
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1187,
               "executionTimeMillisEstimate": 251
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 943593,
                     "executionTimeMillis": 3160,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 943593,
                        "executionTimeMillisEstimate": 242,
                        "works": 1047043,
                        "advanced": 943593,
                        "needTime": 103449,
                        "needYield": 0,
                        "saveState": 1101,
                        "restoreState": 1101,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 943593,
                           "executionTimeMillisEstimate": 189,
                           "works": 1047043,
                           "advanced": 943593,
                           "needTime": 103449,
                           "needYield": 0,
                           "saveState": 1101,
                           "restoreState": 1101,
                           "isEOF": 1,
                           "chunkSkips": 103448,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1047041,
                              "executionTimeMillisEstimate": 58,
                              "works": 1047043,
                              "advanced": 1047041,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1101,
                              "restoreState": 1101,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 943593,
               "executionTimeMillisEstimate": 1974
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1202,
               "executionTimeMillisEstimate": 3160
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425364,
         "i": 2924
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425364,
            "i": 2932
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76436,
                     "executionTimeMillis": 222,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76436,
                        "executionTimeMillisEstimate": 10,
                        "works": 76438,
                        "advanced": 76436,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 81,
                        "restoreState": 81,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76436,
                           "executionTimeMillisEstimate": 8,
                           "works": 76438,
                           "advanced": 76436,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 81,
                           "restoreState": 81,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 76436,
                              "executionTimeMillisEstimate": 4,
                              "works": 76438,
                              "advanced": 76436,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 81,
                              "restoreState": 81,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 76436,
               "executionTimeMillisEstimate": 127
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1181,
               "executionTimeMillisEstimate": 219
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89390,
                     "executionTimeMillis": 265,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 89390,
                        "executionTimeMillisEstimate": 12,
                        "works": 89392,
                        "advanced": 89390,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 96,
                        "restoreState": 96,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 89390,
                           "executionTimeMillisEstimate": 11,
                           "works": 89392,
                           "advanced": 89390,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 96,
                           "restoreState": 96,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 89390,
                              "executionTimeMillisEstimate": 3,
                              "works": 89392,
                              "advanced": 89390,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 96,
                              "restoreState": 96,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 89390,
               "executionTimeMillisEstimate": 163
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1178,
               "executionTimeMillisEstimate": 263
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 943593,
                     "executionTimeMillis": 3111,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 943593,
                        "executionTimeMillisEstimate": 201,
                        "works": 1047043,
                        "advanced": 943593,
                        "needTime": 103449,
                        "needYield": 0,
                        "saveState": 1101,
                        "restoreState": 1101,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 943593,
                           "executionTimeMillisEstimate": 164,
                           "works": 1047043,
                           "advanced": 943593,
                           "needTime": 103449,
                           "needYield": 0,
                           "saveState": 1101,
                           "restoreState": 1101,
                           "isEOF": 1,
                           "chunkSkips": 103448,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1047041,
                              "executionTimeMillisEstimate": 48,
                              "works": 1047043,
                              "advanced": 1047041,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1101,
                              "restoreState": 1101,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 943593,
               "executionTimeMillisEstimate": 1936
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1202,
               "executionTimeMillisEstimate": 3107
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425367,
         "i": 12
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425367,
            "i": 15
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 7198,
            "executionTimeMillis": 69,
            "totalKeysExamined": 49147,
            "totalDocsExamined": 49147,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 7198,
               "executionTimeMillisEstimate": 5,
               "works": 49148,
               "advanced": 7198,
               "needTime": 41949,
               "needYield": 0,
               "saveState": 49,
               "restoreState": 49,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 7198,
                  "executionTimeMillisEstimate": 5,
                  "works": 49148,
                  "advanced": 7198,
                  "needTime": 41949,
                  "needYield": 0,
                  "saveState": 49,
                  "restoreState": 49,
                  "isEOF": 1,
                  "docsExamined": 49147,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 49147,
                     "executionTimeMillisEstimate": 3,
                     "works": 49148,
                     "advanced": 49147,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 49,
                     "restoreState": 49,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     },
                     "keysExamined": 49147,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 7627,
            "executionTimeMillis": 72,
            "totalKeysExamined": 54301,
            "totalDocsExamined": 54301,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 7627,
               "executionTimeMillisEstimate": 4,
               "works": 54302,
               "advanced": 7627,
               "needTime": 46674,
               "needYield": 0,
               "saveState": 54,
               "restoreState": 54,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 7627,
                  "executionTimeMillisEstimate": 0,
                  "works": 54302,
                  "advanced": 7627,
                  "needTime": 46674,
                  "needYield": 0,
                  "saveState": 54,
                  "restoreState": 54,
                  "isEOF": 1,
                  "docsExamined": 54301,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 54301,
                     "executionTimeMillisEstimate": 0,
                     "works": 54302,
                     "advanced": 54301,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 54,
                     "restoreState": 54,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     },
                     "keysExamined": 54301,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 235,
            "totalKeysExamined": 103448,
            "totalDocsExamined": 103448,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 32,
               "works": 103449,
               "advanced": 0,
               "needTime": 103448,
               "needYield": 0,
               "saveState": 103,
               "restoreState": 103,
               "isEOF": 1,
               "chunkSkips": 14825,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 14825,
                  "executionTimeMillisEstimate": 28,
                  "works": 103449,
                  "advanced": 14825,
                  "needTime": 88623,
                  "needYield": 0,
                  "saveState": 103,
                  "restoreState": 103,
                  "isEOF": 1,
                  "docsExamined": 103448,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 103448,
                     "executionTimeMillisEstimate": 7,
                     "works": 103449,
                     "advanced": 103448,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 103,
                     "restoreState": 103,
                     "isEOF": 1,
                     "keyPattern": {
                        "ARR_DELAY": 1
                     },
                     "indexName": "ARR_DELAY_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "ARR_DELAY": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "ARR_DELAY": [
                           "(10, inf.0]"
                        ]
                     },
                     "keysExamined": 103448,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425367,
         "i": 12
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425367,
            "i": 15
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76436,
                     "executionTimeMillis": 305,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 76436,
                        "executionTimeMillisEstimate": 37,
                        "works": 76438,
                        "advanced": 76436,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 85,
                        "restoreState": 85,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76436,
                           "executionTimeMillisEstimate": 10,
                           "works": 76438,
                           "advanced": 76436,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 85,
                           "restoreState": 85,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 76436,
                              "executionTimeMillisEstimate": 3,
                              "works": 76438,
                              "advanced": 76436,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 85,
                              "restoreState": 85,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 76436,
               "executionTimeMillisEstimate": 240
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2339,
               "executionTimeMillisEstimate": 297
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89390,
                     "executionTimeMillis": 363,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 89390,
                        "executionTimeMillisEstimate": 42,
                        "works": 89392,
                        "advanced": 89390,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 100,
                        "restoreState": 100,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 89390,
                           "executionTimeMillisEstimate": 12,
                           "works": 89392,
                           "advanced": 89390,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 100,
                           "restoreState": 100,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 89390,
                              "executionTimeMillisEstimate": 3,
                              "works": 89392,
                              "advanced": 89390,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 100,
                              "restoreState": 100,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 89390,
               "executionTimeMillisEstimate": 284
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2362,
               "executionTimeMillisEstimate": 354
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 943593,
                     "executionTimeMillis": 4044,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 943593,
                        "executionTimeMillisEstimate": 577,
                        "works": 1047043,
                        "advanced": 943593,
                        "needTime": 103449,
                        "needYield": 0,
                        "saveState": 1147,
                        "restoreState": 1147,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 943593,
                           "executionTimeMillisEstimate": 219,
                           "works": 1047043,
                           "advanced": 943593,
                           "needTime": 103449,
                           "needYield": 0,
                           "saveState": 1147,
                           "restoreState": 1147,
                           "isEOF": 1,
                           "chunkSkips": 103448,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1047041,
                              "executionTimeMillisEstimate": 56,
                              "works": 1047043,
                              "advanced": 1047041,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1147,
                              "restoreState": 1147,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 943593,
               "executionTimeMillisEstimate": 3377
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2543,
               "executionTimeMillisEstimate": 4040
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425372,
         "i": 30
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425372,
            "i": 31
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76436,
                     "executionTimeMillis": 313,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 76436,
                        "executionTimeMillisEstimate": 46,
                        "works": 76438,
                        "advanced": 76436,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 85,
                        "restoreState": 85,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76436,
                           "executionTimeMillisEstimate": 15,
                           "works": 76438,
                           "advanced": 76436,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 85,
                           "restoreState": 85,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 76436,
                              "executionTimeMillisEstimate": 4,
                              "works": 76438,
                              "advanced": 76436,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 85,
                              "restoreState": 85,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 76436,
               "executionTimeMillisEstimate": 256
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2277,
               "executionTimeMillisEstimate": 310
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89390,
                     "executionTimeMillis": 370,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 89390,
                        "executionTimeMillisEstimate": 54,
                        "works": 89392,
                        "advanced": 89390,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 100,
                        "restoreState": 100,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 89390,
                           "executionTimeMillisEstimate": 28,
                           "works": 89392,
                           "advanced": 89390,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 100,
                           "restoreState": 100,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 89390,
                              "executionTimeMillisEstimate": 1,
                              "works": 89392,
                              "advanced": 89390,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 100,
                              "restoreState": 100,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 89390,
               "executionTimeMillisEstimate": 314
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2251,
               "executionTimeMillisEstimate": 368
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 943593,
                     "executionTimeMillis": 4046,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 943593,
                        "executionTimeMillisEstimate": 580,
                        "works": 1047043,
                        "advanced": 943593,
                        "needTime": 103449,
                        "needYield": 0,
                        "saveState": 1147,
                        "restoreState": 1147,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 943593,
                           "executionTimeMillisEstimate": 250,
                           "works": 1047043,
                           "advanced": 943593,
                           "needTime": 103449,
                           "needYield": 0,
                           "saveState": 1147,
                           "restoreState": 1147,
                           "isEOF": 1,
                           "chunkSkips": 103448,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1047041,
                              "executionTimeMillisEstimate": 51,
                              "works": 1047043,
                              "advanced": 1047041,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1147,
                              "restoreState": 1147,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 943593,
               "executionTimeMillisEstimate": 3377
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2543,
               "executionTimeMillisEstimate": 4042
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425375,
         "i": 3461
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425375,
            "i": 3466
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76436,
                     "executionTimeMillis": 157,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76436,
                        "executionTimeMillisEstimate": 12,
                        "works": 76438,
                        "advanced": 76436,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 79,
                        "restoreState": 79,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76436,
                           "executionTimeMillisEstimate": 11,
                           "works": 76438,
                           "advanced": 76436,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 79,
                           "restoreState": 79,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 76436,
                              "executionTimeMillisEstimate": 2,
                              "works": 76438,
                              "advanced": 76436,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 79,
                              "restoreState": 79,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 76436,
               "executionTimeMillisEstimate": 124
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 155
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 89390,
                     "executionTimeMillis": 189,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 89390,
                        "executionTimeMillisEstimate": 8,
                        "works": 89392,
                        "advanced": 89390,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 92,
                        "restoreState": 92,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 89390,
                           "executionTimeMillisEstimate": 6,
                           "works": 89392,
                           "advanced": 89390,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 92,
                           "restoreState": 92,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 89390,
                              "executionTimeMillisEstimate": 1,
                              "works": 89392,
                              "advanced": 89390,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 92,
                              "restoreState": 92,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 89390,
               "executionTimeMillisEstimate": 137
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 189
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 943593,
                     "executionTimeMillis": 2233,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 943593,
                        "executionTimeMillisEstimate": 186,
                        "works": 1047043,
                        "advanced": 943593,
                        "needTime": 103449,
                        "needYield": 0,
                        "saveState": 1090,
                        "restoreState": 1090,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 943593,
                           "executionTimeMillisEstimate": 166,
                           "works": 1047043,
                           "advanced": 943593,
                           "needTime": 103449,
                           "needYield": 0,
                           "saveState": 1090,
                           "restoreState": 1090,
                           "isEOF": 1,
                           "chunkSkips": 103448,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1047041,
                              "executionTimeMillisEstimate": 47,
                              "works": 1047043,
                              "advanced": 1047041,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1090,
                              "restoreState": 1090,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 943593,
               "executionTimeMillisEstimate": 1722
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2228
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425377,
         "i": 3324
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425377,
            "i": 3332
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 10879,
                     "executionTimeMillis": 57,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 10879,
                        "executionTimeMillisEstimate": 1,
                        "works": 76438,
                        "advanced": 10879,
                        "needTime": 65558,
                        "needYield": 0,
                        "saveState": 77,
                        "restoreState": 77,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 10879,
                           "executionTimeMillisEstimate": 1,
                           "works": 76438,
                           "advanced": 10879,
                           "needTime": 65558,
                           "needYield": 0,
                           "saveState": 77,
                           "restoreState": 77,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 10879,
                              "executionTimeMillisEstimate": 1,
                              "works": 76438,
                              "advanced": 10879,
                              "needTime": 65558,
                              "needYield": 0,
                              "saveState": 77,
                              "restoreState": 77,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 10879,
               "executionTimeMillisEstimate": 51
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 332,
               "executionTimeMillisEstimate": 57
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 13145,
                     "executionTimeMillis": 67,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 13145,
                        "executionTimeMillisEstimate": 2,
                        "works": 89392,
                        "advanced": 13145,
                        "needTime": 76246,
                        "needYield": 0,
                        "saveState": 90,
                        "restoreState": 90,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 13145,
                           "executionTimeMillisEstimate": 1,
                           "works": 89392,
                           "advanced": 13145,
                           "needTime": 76246,
                           "needYield": 0,
                           "saveState": 90,
                           "restoreState": 90,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 13145,
                              "executionTimeMillisEstimate": 1,
                              "works": 89392,
                              "advanced": 13145,
                              "needTime": 76246,
                              "needYield": 0,
                              "saveState": 90,
                              "restoreState": 90,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 13145,
               "executionTimeMillisEstimate": 60
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 335,
               "executionTimeMillisEstimate": 67
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 158629,
                     "executionTimeMillis": 861,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 158629,
                        "executionTimeMillisEstimate": 73,
                        "works": 1047043,
                        "advanced": 158629,
                        "needTime": 888413,
                        "needYield": 0,
                        "saveState": 1054,
                        "restoreState": 1054,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 158629,
                           "executionTimeMillisEstimate": 66,
                           "works": 1047043,
                           "advanced": 158629,
                           "needTime": 888413,
                           "needYield": 0,
                           "saveState": 1054,
                           "restoreState": 1054,
                           "isEOF": 1,
                           "chunkSkips": 14104,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 172733,
                              "executionTimeMillisEstimate": 40,
                              "works": 1047043,
                              "advanced": 172733,
                              "needTime": 874309,
                              "needYield": 0,
                              "saveState": 1054,
                              "restoreState": 1054,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 158629,
               "executionTimeMillisEstimate": 779
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 861
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425379,
         "i": 5
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425379,
            "i": 11
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 10879,
                     "executionTimeMillis": 57,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 76436,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 10879,
                        "executionTimeMillisEstimate": 3,
                        "works": 76438,
                        "advanced": 10879,
                        "needTime": 65558,
                        "needYield": 0,
                        "saveState": 77,
                        "restoreState": 77,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 10879,
                           "executionTimeMillisEstimate": 3,
                           "works": 76438,
                           "advanced": 10879,
                           "needTime": 65558,
                           "needYield": 0,
                           "saveState": 77,
                           "restoreState": 77,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 10879,
                              "executionTimeMillisEstimate": 3,
                              "works": 76438,
                              "advanced": 10879,
                              "needTime": 65558,
                              "needYield": 0,
                              "saveState": 77,
                              "restoreState": 77,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 76436
                           }
                        }
                     }
                  }
               },
               "nReturned": 10879,
               "executionTimeMillisEstimate": 50
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 316,
               "executionTimeMillisEstimate": 54
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 13145,
                     "executionTimeMillis": 68,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 89390,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 13145,
                        "executionTimeMillisEstimate": 3,
                        "works": 89392,
                        "advanced": 13145,
                        "needTime": 76246,
                        "needYield": 0,
                        "saveState": 90,
                        "restoreState": 90,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 13145,
                           "executionTimeMillisEstimate": 3,
                           "works": 89392,
                           "advanced": 13145,
                           "needTime": 76246,
                           "needYield": 0,
                           "saveState": 90,
                           "restoreState": 90,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 13145,
                              "executionTimeMillisEstimate": 1,
                              "works": 89392,
                              "advanced": 13145,
                              "needTime": 76246,
                              "needYield": 0,
                              "saveState": 90,
                              "restoreState": 90,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 89390
                           }
                        }
                     }
                  }
               },
               "nReturned": 13145,
               "executionTimeMillisEstimate": 60
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 322,
               "executionTimeMillisEstimate": 61
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ARR_DELAY_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 158629,
                     "executionTimeMillis": 843,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1047041,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 158629,
                        "executionTimeMillisEstimate": 57,
                        "works": 1047043,
                        "advanced": 158629,
                        "needTime": 888413,
                        "needYield": 0,
                        "saveState": 1052,
                        "restoreState": 1052,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 158629,
                           "executionTimeMillisEstimate": 54,
                           "works": 1047043,
                           "advanced": 158629,
                           "needTime": 888413,
                           "needYield": 0,
                           "saveState": 1052,
                           "restoreState": 1052,
                           "isEOF": 1,
                           "chunkSkips": 14104,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 172733,
                              "executionTimeMillisEstimate": 28,
                              "works": 1047043,
                              "advanced": 172733,
                              "needTime": 874309,
                              "needYield": 0,
                              "saveState": 1052,
                              "restoreState": 1052,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1047041
                           }
                        }
                     }
                  }
               },
               "nReturned": 158629,
               "executionTimeMillisEstimate": 745
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 363,
               "executionTimeMillisEstimate": 839
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425380,
         "i": 6
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425380,
            "i": 6
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_DEST<a name="AirlineData_DEST"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 243,
            "totalKeysExamined": 0,
            "totalDocsExamined": 322744,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 15,
               "works": 322746,
               "advanced": 1,
               "needTime": 322744,
               "needYield": 0,
               "saveState": 322,
               "restoreState": 322,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 15,
                  "works": 322746,
                  "advanced": 1,
                  "needTime": 322744,
                  "needYield": 0,
                  "saveState": 322,
                  "restoreState": 322,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 322744
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 346,
            "totalKeysExamined": 0,
            "totalDocsExamined": 342084,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 44,
               "works": 342086,
               "advanced": 0,
               "needTime": 342085,
               "needYield": 0,
               "saveState": 342,
               "restoreState": 342,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 43,
                  "works": 342086,
                  "advanced": 0,
                  "needTime": 342085,
                  "needYield": 0,
                  "saveState": 342,
                  "restoreState": 342,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 342084
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 365,
            "totalKeysExamined": 0,
            "totalDocsExamined": 444591,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 33,
               "works": 444593,
               "advanced": 1,
               "needTime": 444591,
               "needYield": 0,
               "saveState": 444,
               "restoreState": 444,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 33,
                  "works": 444593,
                  "advanced": 1,
                  "needTime": 444591,
                  "needYield": 0,
                  "saveState": 444,
                  "restoreState": 444,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 444591
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425380,
         "i": 343
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425380,
            "i": 343
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 322744,
                     "executionTimeMillis": 817,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 322744,
                        "executionTimeMillisEstimate": 48,
                        "works": 322746,
                        "advanced": 322744,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 339,
                        "restoreState": 339,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 322744,
                           "executionTimeMillisEstimate": 37,
                           "works": 322746,
                           "advanced": 322744,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 339,
                           "restoreState": 339,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 322744,
                              "executionTimeMillisEstimate": 10,
                              "works": 322746,
                              "advanced": 322744,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 339,
                              "restoreState": 339,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 322744,
               "executionTimeMillisEstimate": 634
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 809
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 342084,
                     "executionTimeMillis": 919,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 342084,
                        "executionTimeMillisEstimate": 75,
                        "works": 342086,
                        "advanced": 342084,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 359,
                        "restoreState": 359,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 342084,
                           "executionTimeMillisEstimate": 56,
                           "works": 342086,
                           "advanced": 342084,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 359,
                           "restoreState": 359,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 342084,
                              "executionTimeMillisEstimate": 10,
                              "works": 342086,
                              "advanced": 342084,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 359,
                              "restoreState": 359,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 342084,
               "executionTimeMillisEstimate": 706
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 912
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 444591,
                     "executionTimeMillis": 1120,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 444591,
                        "executionTimeMillisEstimate": 86,
                        "works": 444593,
                        "advanced": 444591,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 467,
                        "restoreState": 467,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 444591,
                           "executionTimeMillisEstimate": 69,
                           "works": 444593,
                           "advanced": 444591,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 467,
                           "restoreState": 467,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 444591,
                              "executionTimeMillisEstimate": 20,
                              "works": 444593,
                              "advanced": 444591,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 467,
                              "restoreState": 467,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 444591,
               "executionTimeMillisEstimate": 882
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1116
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425380,
         "i": 352
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425380,
            "i": 352
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 322744,
                     "executionTimeMillis": 828,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 322744,
                        "executionTimeMillisEstimate": 92,
                        "works": 322746,
                        "advanced": 322744,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 335,
                        "restoreState": 335,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 322744,
                           "executionTimeMillisEstimate": 77,
                           "works": 322746,
                           "advanced": 322744,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 335,
                           "restoreState": 335,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 322744,
                              "executionTimeMillisEstimate": 14,
                              "works": 322746,
                              "advanced": 322744,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 335,
                              "restoreState": 335,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 322744,
               "executionTimeMillisEstimate": 638
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 249,
               "executionTimeMillisEstimate": 828
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 342084,
                     "executionTimeMillis": 928,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 342084,
                        "executionTimeMillisEstimate": 111,
                        "works": 342086,
                        "advanced": 342084,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 355,
                        "restoreState": 355,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 342084,
                           "executionTimeMillisEstimate": 88,
                           "works": 342086,
                           "advanced": 342084,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 355,
                           "restoreState": 355,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 342084,
                              "executionTimeMillisEstimate": 27,
                              "works": 342086,
                              "advanced": 342084,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 355,
                              "restoreState": 355,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 342084,
               "executionTimeMillisEstimate": 665
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 270,
               "executionTimeMillisEstimate": 925
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 444591,
                     "executionTimeMillis": 1148,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 444591,
                        "executionTimeMillisEstimate": 83,
                        "works": 444593,
                        "advanced": 444591,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 461,
                        "restoreState": 461,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 444591,
                           "executionTimeMillisEstimate": 67,
                           "works": 444593,
                           "advanced": 444591,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 461,
                           "restoreState": 461,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 444591,
                              "executionTimeMillisEstimate": 11,
                              "works": 444593,
                              "advanced": 444591,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 461,
                              "restoreState": 461,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 444591,
               "executionTimeMillisEstimate": 861
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 307,
               "executionTimeMillisEstimate": 1138
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425382,
         "i": 5527
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425382,
            "i": 5528
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 322744,
                     "executionTimeMillis": 838,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 322744,
                        "executionTimeMillisEstimate": 59,
                        "works": 322746,
                        "advanced": 322744,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 340,
                        "restoreState": 340,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 322744,
                           "executionTimeMillisEstimate": 54,
                           "works": 322746,
                           "advanced": 322744,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 340,
                           "restoreState": 340,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 322744,
                              "executionTimeMillisEstimate": 20,
                              "works": 322746,
                              "advanced": 322744,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 340,
                              "restoreState": 340,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 322744,
               "executionTimeMillisEstimate": 633
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 133,
               "executionTimeMillisEstimate": 832
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 342084,
                     "executionTimeMillis": 880,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 342084,
                        "executionTimeMillisEstimate": 56,
                        "works": 342086,
                        "advanced": 342084,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 360,
                        "restoreState": 360,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 342084,
                           "executionTimeMillisEstimate": 41,
                           "works": 342086,
                           "advanced": 342084,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 360,
                           "restoreState": 360,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 342084,
                              "executionTimeMillisEstimate": 9,
                              "works": 342086,
                              "advanced": 342084,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 360,
                              "restoreState": 360,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 342084,
               "executionTimeMillisEstimate": 683
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 123,
               "executionTimeMillisEstimate": 872
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 444591,
                     "executionTimeMillis": 1114,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 444591,
                        "executionTimeMillisEstimate": 79,
                        "works": 444593,
                        "advanced": 444591,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 469,
                        "restoreState": 469,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 444591,
                           "executionTimeMillisEstimate": 68,
                           "works": 444593,
                           "advanced": 444591,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 469,
                           "restoreState": 469,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 444591,
                              "executionTimeMillisEstimate": 9,
                              "works": 444593,
                              "advanced": 444591,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 469,
                              "restoreState": 469,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 444591,
               "executionTimeMillisEstimate": 854
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 114,
               "executionTimeMillisEstimate": 1113
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425382,
         "i": 5527
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425382,
            "i": 5528
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 61293,
                     "executionTimeMillis": 317,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 61293,
                        "executionTimeMillisEstimate": 27,
                        "works": 322746,
                        "advanced": 61293,
                        "needTime": 261452,
                        "needYield": 0,
                        "saveState": 325,
                        "restoreState": 325,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 61293,
                           "executionTimeMillisEstimate": 24,
                           "works": 322746,
                           "advanced": 61293,
                           "needTime": 261452,
                           "needYield": 0,
                           "saveState": 325,
                           "restoreState": 325,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 61293,
                              "executionTimeMillisEstimate": 15,
                              "works": 322746,
                              "advanced": 61293,
                              "needTime": 261452,
                              "needYield": 0,
                              "saveState": 325,
                              "restoreState": 325,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 61293,
               "executionTimeMillisEstimate": 275
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 243,
               "executionTimeMillisEstimate": 315
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 71796,
                     "executionTimeMillis": 359,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 71796,
                        "executionTimeMillisEstimate": 43,
                        "works": 342086,
                        "advanced": 71796,
                        "needTime": 270289,
                        "needYield": 0,
                        "saveState": 346,
                        "restoreState": 346,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 71796,
                           "executionTimeMillisEstimate": 41,
                           "works": 342086,
                           "advanced": 71796,
                           "needTime": 270289,
                           "needYield": 0,
                           "saveState": 346,
                           "restoreState": 346,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 71796,
                              "executionTimeMillisEstimate": 27,
                              "works": 342086,
                              "advanced": 71796,
                              "needTime": 270289,
                              "needYield": 0,
                              "saveState": 346,
                              "restoreState": 346,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 71796,
               "executionTimeMillisEstimate": 310
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 266,
               "executionTimeMillisEstimate": 354
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 82426,
                     "executionTimeMillis": 425,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 82426,
                        "executionTimeMillisEstimate": 20,
                        "works": 444593,
                        "advanced": 82426,
                        "needTime": 362166,
                        "needYield": 0,
                        "saveState": 448,
                        "restoreState": 448,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 82426,
                           "executionTimeMillisEstimate": 18,
                           "works": 444593,
                           "advanced": 82426,
                           "needTime": 362166,
                           "needYield": 0,
                           "saveState": 448,
                           "restoreState": 448,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 82426,
                              "executionTimeMillisEstimate": 12,
                              "works": 444593,
                              "advanced": 82426,
                              "needTime": 362166,
                              "needYield": 0,
                              "saveState": 448,
                              "restoreState": 448,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 82426,
               "executionTimeMillisEstimate": 370
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 304,
               "executionTimeMillisEstimate": 416
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425384,
         "i": 3573
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425384,
            "i": 3573
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 61293,
                     "executionTimeMillis": 318,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 61293,
                        "executionTimeMillisEstimate": 16,
                        "works": 322746,
                        "advanced": 61293,
                        "needTime": 261452,
                        "needYield": 0,
                        "saveState": 325,
                        "restoreState": 325,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 61293,
                           "executionTimeMillisEstimate": 15,
                           "works": 322746,
                           "advanced": 61293,
                           "needTime": 261452,
                           "needYield": 0,
                           "saveState": 325,
                           "restoreState": 325,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 61293,
                              "executionTimeMillisEstimate": 10,
                              "works": 322746,
                              "advanced": 61293,
                              "needTime": 261452,
                              "needYield": 0,
                              "saveState": 325,
                              "restoreState": 325,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 61293,
               "executionTimeMillisEstimate": 285
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 133,
               "executionTimeMillisEstimate": 317
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 71796,
                     "executionTimeMillis": 353,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 71796,
                        "executionTimeMillisEstimate": 15,
                        "works": 342086,
                        "advanced": 71796,
                        "needTime": 270289,
                        "needYield": 0,
                        "saveState": 346,
                        "restoreState": 346,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 71796,
                           "executionTimeMillisEstimate": 15,
                           "works": 342086,
                           "advanced": 71796,
                           "needTime": 270289,
                           "needYield": 0,
                           "saveState": 346,
                           "restoreState": 346,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 71796,
                              "executionTimeMillisEstimate": 7,
                              "works": 342086,
                              "advanced": 71796,
                              "needTime": 270289,
                              "needYield": 0,
                              "saveState": 346,
                              "restoreState": 346,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 71796,
               "executionTimeMillisEstimate": 300
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 122,
               "executionTimeMillisEstimate": 345
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 82426,
                     "executionTimeMillis": 425,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 82426,
                        "executionTimeMillisEstimate": 18,
                        "works": 444593,
                        "advanced": 82426,
                        "needTime": 362166,
                        "needYield": 0,
                        "saveState": 448,
                        "restoreState": 448,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 82426,
                           "executionTimeMillisEstimate": 14,
                           "works": 444593,
                           "advanced": 82426,
                           "needTime": 362166,
                           "needYield": 0,
                           "saveState": 448,
                           "restoreState": 448,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 82426,
                              "executionTimeMillisEstimate": 12,
                              "works": 444593,
                              "advanced": 82426,
                              "needTime": 362166,
                              "needYield": 0,
                              "saveState": 448,
                              "restoreState": 448,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 82426,
               "executionTimeMillisEstimate": 375
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 113,
               "executionTimeMillisEstimate": 424
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425384,
         "i": 3583
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425384,
            "i": 3583
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 61293,
                     "executionTimeMillis": 296,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 61293,
                        "executionTimeMillisEstimate": 12,
                        "works": 322746,
                        "advanced": 61293,
                        "needTime": 261452,
                        "needYield": 0,
                        "saveState": 326,
                        "restoreState": 326,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 61293,
                           "executionTimeMillisEstimate": 11,
                           "works": 322746,
                           "advanced": 61293,
                           "needTime": 261452,
                           "needYield": 0,
                           "saveState": 326,
                           "restoreState": 326,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 61293,
                              "executionTimeMillisEstimate": 9,
                              "works": 322746,
                              "advanced": 61293,
                              "needTime": 261452,
                              "needYield": 0,
                              "saveState": 326,
                              "restoreState": 326,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 61293,
               "executionTimeMillisEstimate": 265
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 293
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 71796,
                     "executionTimeMillis": 336,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 71796,
                        "executionTimeMillisEstimate": 13,
                        "works": 342086,
                        "advanced": 71796,
                        "needTime": 270289,
                        "needYield": 0,
                        "saveState": 345,
                        "restoreState": 345,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 71796,
                           "executionTimeMillisEstimate": 11,
                           "works": 342086,
                           "advanced": 71796,
                           "needTime": 270289,
                           "needYield": 0,
                           "saveState": 345,
                           "restoreState": 345,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 71796,
                              "executionTimeMillisEstimate": 9,
                              "works": 342086,
                              "advanced": 71796,
                              "needTime": 270289,
                              "needYield": 0,
                              "saveState": 345,
                              "restoreState": 345,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 71796,
               "executionTimeMillisEstimate": 288
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 334
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 82426,
                     "executionTimeMillis": 401,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 82426,
                        "executionTimeMillisEstimate": 12,
                        "works": 444593,
                        "advanced": 82426,
                        "needTime": 362166,
                        "needYield": 0,
                        "saveState": 449,
                        "restoreState": 449,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 82426,
                           "executionTimeMillisEstimate": 9,
                           "works": 444593,
                           "advanced": 82426,
                           "needTime": 362166,
                           "needYield": 0,
                           "saveState": 449,
                           "restoreState": 449,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 82426,
                              "executionTimeMillisEstimate": 7,
                              "works": 444593,
                              "advanced": 82426,
                              "needTime": 362166,
                              "needYield": 0,
                              "saveState": 449,
                              "restoreState": 449,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 82426,
               "executionTimeMillisEstimate": 352
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 400
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425384,
         "i": 3583
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425384,
            "i": 3583
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 100885,
                     "executionTimeMillis": 391,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 100885,
                        "executionTimeMillisEstimate": 30,
                        "works": 322746,
                        "advanced": 100885,
                        "needTime": 221860,
                        "needYield": 0,
                        "saveState": 327,
                        "restoreState": 327,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 100885,
                           "executionTimeMillisEstimate": 28,
                           "works": 322746,
                           "advanced": 100885,
                           "needTime": 221860,
                           "needYield": 0,
                           "saveState": 327,
                           "restoreState": 327,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 100885,
                              "executionTimeMillisEstimate": 10,
                              "works": 322746,
                              "advanced": 100885,
                              "needTime": 221860,
                              "needYield": 0,
                              "saveState": 327,
                              "restoreState": 327,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 100885,
               "executionTimeMillisEstimate": 331
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 241,
               "executionTimeMillisEstimate": 391
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 105109,
                     "executionTimeMillis": 419,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 105109,
                        "executionTimeMillisEstimate": 32,
                        "works": 342086,
                        "advanced": 105109,
                        "needTime": 236976,
                        "needYield": 0,
                        "saveState": 346,
                        "restoreState": 346,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 105109,
                           "executionTimeMillisEstimate": 27,
                           "works": 342086,
                           "advanced": 105109,
                           "needTime": 236976,
                           "needYield": 0,
                           "saveState": 346,
                           "restoreState": 346,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 105109,
                              "executionTimeMillisEstimate": 10,
                              "works": 342086,
                              "advanced": 105109,
                              "needTime": 236976,
                              "needYield": 0,
                              "saveState": 346,
                              "restoreState": 346,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 105109,
               "executionTimeMillisEstimate": 354
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 266,
               "executionTimeMillisEstimate": 418
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 139300,
                     "executionTimeMillis": 528,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 139300,
                        "executionTimeMillisEstimate": 52,
                        "works": 444593,
                        "advanced": 139300,
                        "needTime": 305292,
                        "needYield": 0,
                        "saveState": 450,
                        "restoreState": 450,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 139300,
                           "executionTimeMillisEstimate": 40,
                           "works": 444593,
                           "advanced": 139300,
                           "needTime": 305292,
                           "needYield": 0,
                           "saveState": 450,
                           "restoreState": 450,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 139300,
                              "executionTimeMillisEstimate": 15,
                              "works": 444593,
                              "advanced": 139300,
                              "needTime": 305292,
                              "needYield": 0,
                              "saveState": 450,
                              "restoreState": 450,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 139300,
               "executionTimeMillisEstimate": 453
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 301,
               "executionTimeMillisEstimate": 526
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425385,
         "i": 15
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425385,
            "i": 17
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 100885,
                     "executionTimeMillis": 400,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 100885,
                        "executionTimeMillisEstimate": 33,
                        "works": 322746,
                        "advanced": 100885,
                        "needTime": 221860,
                        "needYield": 0,
                        "saveState": 328,
                        "restoreState": 328,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 100885,
                           "executionTimeMillisEstimate": 28,
                           "works": 322746,
                           "advanced": 100885,
                           "needTime": 221860,
                           "needYield": 0,
                           "saveState": 328,
                           "restoreState": 328,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 100885,
                              "executionTimeMillisEstimate": 8,
                              "works": 322746,
                              "advanced": 100885,
                              "needTime": 221860,
                              "needYield": 0,
                              "saveState": 328,
                              "restoreState": 328,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 100885,
               "executionTimeMillisEstimate": 345
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 132,
               "executionTimeMillisEstimate": 395
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 105109,
                     "executionTimeMillis": 428,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 105109,
                        "executionTimeMillisEstimate": 44,
                        "works": 342086,
                        "advanced": 105109,
                        "needTime": 236976,
                        "needYield": 0,
                        "saveState": 348,
                        "restoreState": 348,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 105109,
                           "executionTimeMillisEstimate": 35,
                           "works": 342086,
                           "advanced": 105109,
                           "needTime": 236976,
                           "needYield": 0,
                           "saveState": 348,
                           "restoreState": 348,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 105109,
                              "executionTimeMillisEstimate": 15,
                              "works": 342086,
                              "advanced": 105109,
                              "needTime": 236976,
                              "needYield": 0,
                              "saveState": 348,
                              "restoreState": 348,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 105109,
               "executionTimeMillisEstimate": 362
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 121,
               "executionTimeMillisEstimate": 427
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 139300,
                     "executionTimeMillis": 541,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 139300,
                        "executionTimeMillisEstimate": 46,
                        "works": 444593,
                        "advanced": 139300,
                        "needTime": 305292,
                        "needYield": 0,
                        "saveState": 452,
                        "restoreState": 452,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 139300,
                           "executionTimeMillisEstimate": 42,
                           "works": 444593,
                           "advanced": 139300,
                           "needTime": 305292,
                           "needYield": 0,
                           "saveState": 452,
                           "restoreState": 452,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 139300,
                              "executionTimeMillisEstimate": 12,
                              "works": 444593,
                              "advanced": 139300,
                              "needTime": 305292,
                              "needYield": 0,
                              "saveState": 452,
                              "restoreState": 452,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 139300,
               "executionTimeMillisEstimate": 459
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 113,
               "executionTimeMillisEstimate": 534
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425386,
         "i": 20
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425386,
            "i": 20
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 100885,
                     "executionTimeMillis": 401,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 100885,
                        "executionTimeMillisEstimate": 30,
                        "works": 322746,
                        "advanced": 100885,
                        "needTime": 221860,
                        "needYield": 0,
                        "saveState": 328,
                        "restoreState": 328,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 100885,
                           "executionTimeMillisEstimate": 26,
                           "works": 322746,
                           "advanced": 100885,
                           "needTime": 221860,
                           "needYield": 0,
                           "saveState": 328,
                           "restoreState": 328,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 100885,
                              "executionTimeMillisEstimate": 13,
                              "works": 322746,
                              "advanced": 100885,
                              "needTime": 221860,
                              "needYield": 0,
                              "saveState": 328,
                              "restoreState": 328,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 100885,
               "executionTimeMillisEstimate": 337
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 398
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 105109,
                     "executionTimeMillis": 431,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 105109,
                        "executionTimeMillisEstimate": 35,
                        "works": 342086,
                        "advanced": 105109,
                        "needTime": 236976,
                        "needYield": 0,
                        "saveState": 347,
                        "restoreState": 347,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 105109,
                           "executionTimeMillisEstimate": 28,
                           "works": 342086,
                           "advanced": 105109,
                           "needTime": 236976,
                           "needYield": 0,
                           "saveState": 347,
                           "restoreState": 347,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 105109,
                              "executionTimeMillisEstimate": 10,
                              "works": 342086,
                              "advanced": 105109,
                              "needTime": 236976,
                              "needYield": 0,
                              "saveState": 347,
                              "restoreState": 347,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 105109,
               "executionTimeMillisEstimate": 376
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 431
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 139300,
                     "executionTimeMillis": 536,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 139300,
                        "executionTimeMillisEstimate": 31,
                        "works": 444593,
                        "advanced": 139300,
                        "needTime": 305292,
                        "needYield": 0,
                        "saveState": 451,
                        "restoreState": 451,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 139300,
                           "executionTimeMillisEstimate": 31,
                           "works": 444593,
                           "advanced": 139300,
                           "needTime": 305292,
                           "needYield": 0,
                           "saveState": 451,
                           "restoreState": 451,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 139300,
                              "executionTimeMillisEstimate": 15,
                              "works": 444593,
                              "advanced": 139300,
                              "needTime": 305292,
                              "needYield": 0,
                              "saveState": 451,
                              "restoreState": 451,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 139300,
               "executionTimeMillisEstimate": 471
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 528
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425386,
         "i": 20
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425386,
            "i": 20
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 322744,
                     "executionTimeMillis": 1030,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 322744,
                        "executionTimeMillisEstimate": 67,
                        "works": 322746,
                        "advanced": 322744,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 338,
                        "restoreState": 338,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 322744,
                           "executionTimeMillisEstimate": 49,
                           "works": 322746,
                           "advanced": 322744,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 338,
                           "restoreState": 338,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 322744,
                              "executionTimeMillisEstimate": 14,
                              "works": 322746,
                              "advanced": 322744,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 338,
                              "restoreState": 338,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 322744,
               "executionTimeMillisEstimate": 639
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 678,
               "executionTimeMillisEstimate": 1028
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 342084,
                     "executionTimeMillis": 1154,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 342084,
                        "executionTimeMillisEstimate": 83,
                        "works": 342086,
                        "advanced": 342084,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 359,
                        "restoreState": 359,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 342084,
                           "executionTimeMillisEstimate": 62,
                           "works": 342086,
                           "advanced": 342084,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 359,
                           "restoreState": 359,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 342084,
                              "executionTimeMillisEstimate": 6,
                              "works": 342086,
                              "advanced": 342084,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 359,
                              "restoreState": 359,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 342084,
               "executionTimeMillisEstimate": 703
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 704,
               "executionTimeMillisEstimate": 1150
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 444591,
                     "executionTimeMillis": 1371,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 444591,
                        "executionTimeMillisEstimate": 91,
                        "works": 444593,
                        "advanced": 444591,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 467,
                        "restoreState": 467,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 444591,
                           "executionTimeMillisEstimate": 73,
                           "works": 444593,
                           "advanced": 444591,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 467,
                           "restoreState": 467,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 444591,
                              "executionTimeMillisEstimate": 21,
                              "works": 444593,
                              "advanced": 444591,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 467,
                              "restoreState": 467,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 444591,
               "executionTimeMillisEstimate": 882
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 974,
               "executionTimeMillisEstimate": 1361
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425388,
         "i": 4865
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425388,
            "i": 4865
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 322744,
                     "executionTimeMillis": 1000,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 322744,
                        "executionTimeMillisEstimate": 61,
                        "works": 322746,
                        "advanced": 322744,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 347,
                        "restoreState": 347,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 322744,
                           "executionTimeMillisEstimate": 44,
                           "works": 322746,
                           "advanced": 322744,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 347,
                           "restoreState": 347,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 322744,
                              "executionTimeMillisEstimate": 11,
                              "works": 322746,
                              "advanced": 322744,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 347,
                              "restoreState": 347,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 322744,
               "executionTimeMillisEstimate": 646
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 407,
               "executionTimeMillisEstimate": 998
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 342084,
                     "executionTimeMillis": 1140,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 342084,
                        "executionTimeMillisEstimate": 74,
                        "works": 342086,
                        "advanced": 342084,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 368,
                        "restoreState": 368,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 342084,
                           "executionTimeMillisEstimate": 58,
                           "works": 342086,
                           "advanced": 342084,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 368,
                           "restoreState": 368,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 342084,
                              "executionTimeMillisEstimate": 19,
                              "works": 342086,
                              "advanced": 342084,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 368,
                              "restoreState": 368,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 342084,
               "executionTimeMillisEstimate": 727
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 408,
               "executionTimeMillisEstimate": 1134
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 444591,
                     "executionTimeMillis": 1396,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 444591,
                        "executionTimeMillisEstimate": 101,
                        "works": 444593,
                        "advanced": 444591,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 478,
                        "restoreState": 478,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 444591,
                           "executionTimeMillisEstimate": 73,
                           "works": 444593,
                           "advanced": 444591,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 478,
                           "restoreState": 478,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 444591,
                              "executionTimeMillisEstimate": 21,
                              "works": 444593,
                              "advanced": 444591,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 478,
                              "restoreState": 478,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 444591,
               "executionTimeMillisEstimate": 928
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 388,
               "executionTimeMillisEstimate": 1396
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425390,
         "i": 1500
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425390,
            "i": 2000
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 4036,
            "executionTimeMillis": 155,
            "totalKeysExamined": 0,
            "totalDocsExamined": 322744,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 4036,
               "executionTimeMillisEstimate": 6,
               "works": 322746,
               "advanced": 4036,
               "needTime": 318709,
               "needYield": 0,
               "saveState": 322,
               "restoreState": 322,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 4036,
                  "executionTimeMillisEstimate": 6,
                  "works": 322746,
                  "advanced": 4036,
                  "needTime": 318709,
                  "needYield": 0,
                  "saveState": 322,
                  "restoreState": 322,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 322744
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 5342,
            "executionTimeMillis": 165,
            "totalKeysExamined": 0,
            "totalDocsExamined": 342084,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 5342,
               "executionTimeMillisEstimate": 7,
               "works": 342086,
               "advanced": 5342,
               "needTime": 336743,
               "needYield": 0,
               "saveState": 342,
               "restoreState": 342,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 5342,
                  "executionTimeMillisEstimate": 6,
                  "works": 342086,
                  "advanced": 5342,
                  "needTime": 336743,
                  "needYield": 0,
                  "saveState": 342,
                  "restoreState": 342,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 342084
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 5447,
            "executionTimeMillis": 223,
            "totalKeysExamined": 0,
            "totalDocsExamined": 444591,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 5447,
               "executionTimeMillisEstimate": 15,
               "works": 444593,
               "advanced": 5447,
               "needTime": 439145,
               "needYield": 0,
               "saveState": 444,
               "restoreState": 444,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 5447,
                  "executionTimeMillisEstimate": 12,
                  "works": 444593,
                  "advanced": 5447,
                  "needTime": 439145,
                  "needYield": 0,
                  "saveState": 444,
                  "restoreState": 444,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 444591
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425390,
         "i": 2033
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425390,
            "i": 2033
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 322744,
                     "executionTimeMillis": 1398,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 322744,
                        "executionTimeMillisEstimate": 215,
                        "works": 322746,
                        "advanced": 322744,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 360,
                        "restoreState": 360,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 322744,
                           "executionTimeMillisEstimate": 78,
                           "works": 322746,
                           "advanced": 322744,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 360,
                           "restoreState": 360,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 322744,
                              "executionTimeMillisEstimate": 34,
                              "works": 322746,
                              "advanced": 322744,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 360,
                              "restoreState": 360,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 322744,
               "executionTimeMillisEstimate": 1220
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1689,
               "executionTimeMillisEstimate": 1395
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 342084,
                     "executionTimeMillis": 1521,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 342084,
                        "executionTimeMillisEstimate": 260,
                        "works": 342086,
                        "advanced": 342084,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 381,
                        "restoreState": 381,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 342084,
                           "executionTimeMillisEstimate": 107,
                           "works": 342086,
                           "advanced": 342084,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 381,
                           "restoreState": 381,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 342084,
                              "executionTimeMillisEstimate": 23,
                              "works": 342086,
                              "advanced": 342084,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 381,
                              "restoreState": 381,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 342084,
               "executionTimeMillisEstimate": 1281
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1830,
               "executionTimeMillisEstimate": 1516
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 444591,
                     "executionTimeMillis": 1991,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 444591,
                        "executionTimeMillisEstimate": 291,
                        "works": 444593,
                        "advanced": 444591,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 497,
                        "restoreState": 497,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 444591,
                           "executionTimeMillisEstimate": 137,
                           "works": 444593,
                           "advanced": 444591,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 497,
                           "restoreState": 497,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 444591,
                              "executionTimeMillisEstimate": 38,
                              "works": 444593,
                              "advanced": 444591,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 497,
                              "restoreState": 497,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 444591,
               "executionTimeMillisEstimate": 1717
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2087,
               "executionTimeMillisEstimate": 1984
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425391,
         "i": 10
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425391,
            "i": 10
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 322744,
                     "executionTimeMillis": 1408,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 322744,
                        "executionTimeMillisEstimate": 221,
                        "works": 322746,
                        "advanced": 322744,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 360,
                        "restoreState": 360,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 322744,
                           "executionTimeMillisEstimate": 95,
                           "works": 322746,
                           "advanced": 322744,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 360,
                           "restoreState": 360,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 322744,
                              "executionTimeMillisEstimate": 18,
                              "works": 322746,
                              "advanced": 322744,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 360,
                              "restoreState": 360,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 322744,
               "executionTimeMillisEstimate": 1234
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 915,
               "executionTimeMillisEstimate": 1399
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 342084,
                     "executionTimeMillis": 1542,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 342084,
                        "executionTimeMillisEstimate": 287,
                        "works": 342086,
                        "advanced": 342084,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 381,
                        "restoreState": 381,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 342084,
                           "executionTimeMillisEstimate": 146,
                           "works": 342086,
                           "advanced": 342084,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 381,
                           "restoreState": 381,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 342084,
                              "executionTimeMillisEstimate": 27,
                              "works": 342086,
                              "advanced": 342084,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 381,
                              "restoreState": 381,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 342084,
               "executionTimeMillisEstimate": 1298
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 841,
               "executionTimeMillisEstimate": 1536
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 444591,
                     "executionTimeMillis": 2008,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 444591,
                        "executionTimeMillisEstimate": 319,
                        "works": 444593,
                        "advanced": 444591,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 497,
                        "restoreState": 497,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 444591,
                           "executionTimeMillisEstimate": 129,
                           "works": 444593,
                           "advanced": 444591,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 497,
                           "restoreState": 497,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 444591,
                              "executionTimeMillisEstimate": 19,
                              "works": 444593,
                              "advanced": 444591,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 497,
                              "restoreState": 497,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 444591,
               "executionTimeMillisEstimate": 1690
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 795,
               "executionTimeMillisEstimate": 2002
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425393,
         "i": 28
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425393,
            "i": 28
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 322744,
                     "executionTimeMillis": 818,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 322744,
                        "executionTimeMillisEstimate": 64,
                        "works": 322746,
                        "advanced": 322744,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 334,
                        "restoreState": 334,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 322744,
                           "executionTimeMillisEstimate": 57,
                           "works": 322746,
                           "advanced": 322744,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 334,
                           "restoreState": 334,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 322744,
                              "executionTimeMillisEstimate": 16,
                              "works": 322746,
                              "advanced": 322744,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 334,
                              "restoreState": 334,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 322744,
               "executionTimeMillisEstimate": 642
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 811
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 342084,
                     "executionTimeMillis": 891,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 342084,
                        "executionTimeMillisEstimate": 103,
                        "works": 342086,
                        "advanced": 342084,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 355,
                        "restoreState": 355,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 342084,
                           "executionTimeMillisEstimate": 92,
                           "works": 342086,
                           "advanced": 342084,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 355,
                           "restoreState": 355,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 342084,
                              "executionTimeMillisEstimate": 27,
                              "works": 342086,
                              "advanced": 342084,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 355,
                              "restoreState": 355,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 342084,
               "executionTimeMillisEstimate": 693
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 891
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 444591,
                     "executionTimeMillis": 1150,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 444591,
                        "executionTimeMillisEstimate": 112,
                        "works": 444593,
                        "advanced": 444591,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 461,
                        "restoreState": 461,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 444591,
                           "executionTimeMillisEstimate": 98,
                           "works": 444593,
                           "advanced": 444591,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 461,
                           "restoreState": 461,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 444591,
                              "executionTimeMillisEstimate": 17,
                              "works": 444593,
                              "advanced": 444591,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 461,
                              "restoreState": 461,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 444591,
               "executionTimeMillisEstimate": 877
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1145
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425394,
         "i": 732
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425394,
            "i": 732
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 53147,
                     "executionTimeMillis": 285,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 53147,
                        "executionTimeMillisEstimate": 17,
                        "works": 322746,
                        "advanced": 53147,
                        "needTime": 269598,
                        "needYield": 0,
                        "saveState": 325,
                        "restoreState": 325,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 53147,
                           "executionTimeMillisEstimate": 17,
                           "works": 322746,
                           "advanced": 53147,
                           "needTime": 269598,
                           "needYield": 0,
                           "saveState": 325,
                           "restoreState": 325,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 53147,
                              "executionTimeMillisEstimate": 11,
                              "works": 322746,
                              "advanced": 53147,
                              "needTime": 269598,
                              "needYield": 0,
                              "saveState": 325,
                              "restoreState": 325,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 53147,
               "executionTimeMillisEstimate": 254
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 237,
               "executionTimeMillisEstimate": 281
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 55841,
                     "executionTimeMillis": 307,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 55841,
                        "executionTimeMillisEstimate": 27,
                        "works": 342086,
                        "advanced": 55841,
                        "needTime": 286244,
                        "needYield": 0,
                        "saveState": 344,
                        "restoreState": 344,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 55841,
                           "executionTimeMillisEstimate": 23,
                           "works": 342086,
                           "advanced": 55841,
                           "needTime": 286244,
                           "needYield": 0,
                           "saveState": 344,
                           "restoreState": 344,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 55841,
                              "executionTimeMillisEstimate": 8,
                              "works": 342086,
                              "advanced": 55841,
                              "needTime": 286244,
                              "needYield": 0,
                              "saveState": 344,
                              "restoreState": 344,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 55841,
               "executionTimeMillisEstimate": 273
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 263,
               "executionTimeMillisEstimate": 304
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 73665,
                     "executionTimeMillis": 405,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 73665,
                        "executionTimeMillisEstimate": 24,
                        "works": 444593,
                        "advanced": 73665,
                        "needTime": 370927,
                        "needYield": 0,
                        "saveState": 448,
                        "restoreState": 448,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 73665,
                           "executionTimeMillisEstimate": 20,
                           "works": 444593,
                           "advanced": 73665,
                           "needTime": 370927,
                           "needYield": 0,
                           "saveState": 448,
                           "restoreState": 448,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 73665,
                              "executionTimeMillisEstimate": 14,
                              "works": 444593,
                              "advanced": 73665,
                              "needTime": 370927,
                              "needYield": 0,
                              "saveState": 448,
                              "restoreState": 448,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 73665,
               "executionTimeMillisEstimate": 367
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 298,
               "executionTimeMillisEstimate": 404
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425395,
         "i": 2523
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425395,
            "i": 2523
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 53147,
                     "executionTimeMillis": 307,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 322744,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 53147,
                        "executionTimeMillisEstimate": 27,
                        "works": 322746,
                        "advanced": 53147,
                        "needTime": 269598,
                        "needYield": 0,
                        "saveState": 325,
                        "restoreState": 325,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 53147,
                           "executionTimeMillisEstimate": 21,
                           "works": 322746,
                           "advanced": 53147,
                           "needTime": 269598,
                           "needYield": 0,
                           "saveState": 325,
                           "restoreState": 325,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 53147,
                              "executionTimeMillisEstimate": 11,
                              "works": 322746,
                              "advanced": 53147,
                              "needTime": 269598,
                              "needYield": 0,
                              "saveState": 325,
                              "restoreState": 325,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 322744
                           }
                        }
                     }
                  }
               },
               "nReturned": 53147,
               "executionTimeMillisEstimate": 276
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 132,
               "executionTimeMillisEstimate": 305
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 55841,
                     "executionTimeMillis": 328,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 342084,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 55841,
                        "executionTimeMillisEstimate": 31,
                        "works": 342086,
                        "advanced": 55841,
                        "needTime": 286244,
                        "needYield": 0,
                        "saveState": 344,
                        "restoreState": 344,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 55841,
                           "executionTimeMillisEstimate": 29,
                           "works": 342086,
                           "advanced": 55841,
                           "needTime": 286244,
                           "needYield": 0,
                           "saveState": 344,
                           "restoreState": 344,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 55841,
                              "executionTimeMillisEstimate": 20,
                              "works": 342086,
                              "advanced": 55841,
                              "needTime": 286244,
                              "needYield": 0,
                              "saveState": 344,
                              "restoreState": 344,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 342084
                           }
                        }
                     }
                  }
               },
               "nReturned": 55841,
               "executionTimeMillisEstimate": 298
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 120,
               "executionTimeMillisEstimate": 325
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 73665,
                     "executionTimeMillis": 433,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 444591,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 73665,
                        "executionTimeMillisEstimate": 46,
                        "works": 444593,
                        "advanced": 73665,
                        "needTime": 370927,
                        "needYield": 0,
                        "saveState": 448,
                        "restoreState": 448,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 73665,
                           "executionTimeMillisEstimate": 40,
                           "works": 444593,
                           "advanced": 73665,
                           "needTime": 370927,
                           "needYield": 0,
                           "saveState": 448,
                           "restoreState": 448,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 73665,
                              "executionTimeMillisEstimate": 22,
                              "works": 444593,
                              "advanced": 73665,
                              "needTime": 370927,
                              "needYield": 0,
                              "saveState": 448,
                              "restoreState": 448,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 444591
                           }
                        }
                     }
                  }
               },
               "nReturned": 73665,
               "executionTimeMillisEstimate": 380
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 113,
               "executionTimeMillisEstimate": 432
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425395,
         "i": 2523
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425396,
            "i": 2
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_DEST_range<a name="AirlineData_DEST_range"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 78,
            "totalKeysExamined": 0,
            "totalDocsExamined": 94975,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 3,
               "works": 94977,
               "advanced": 0,
               "needTime": 94976,
               "needYield": 0,
               "saveState": 94,
               "restoreState": 94,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 3,
                  "works": 94977,
                  "advanced": 0,
                  "needTime": 94976,
                  "needYield": 0,
                  "saveState": 94,
                  "restoreState": 94,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 94975
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 97,
            "totalKeysExamined": 0,
            "totalDocsExamined": 129949,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 10,
               "works": 129951,
               "advanced": 1,
               "needTime": 129949,
               "needYield": 0,
               "saveState": 129,
               "restoreState": 129,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 9,
                  "works": 129951,
                  "advanced": 1,
                  "needTime": 129949,
                  "needYield": 0,
                  "saveState": 129,
                  "restoreState": 129,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 129949
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 1140,
            "totalKeysExamined": 0,
            "totalDocsExamined": 1011211,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 134,
               "works": 1011213,
               "advanced": 1,
               "needTime": 1011211,
               "needYield": 0,
               "saveState": 1011,
               "restoreState": 1011,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 131,
                  "works": 1011213,
                  "advanced": 1,
                  "needTime": 1011211,
                  "needYield": 0,
                  "saveState": 1011,
                  "restoreState": 1011,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 1011211
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425397,
         "i": 1323
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425397,
            "i": 1323
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 94975,
                     "executionTimeMillis": 230,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 94975,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 94975,
                        "executionTimeMillisEstimate": 11,
                        "works": 94977,
                        "advanced": 94975,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 100,
                        "restoreState": 100,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 94975,
                           "executionTimeMillisEstimate": 9,
                           "works": 94977,
                           "advanced": 94975,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 100,
                           "restoreState": 100,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 94975,
                              "executionTimeMillisEstimate": 2,
                              "works": 94977,
                              "advanced": 94975,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 100,
                              "restoreState": 100,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 94975
                           }
                        }
                     }
                  }
               },
               "nReturned": 94975,
               "executionTimeMillisEstimate": 172
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 225
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 129949,
                     "executionTimeMillis": 303,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 129949,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 129949,
                        "executionTimeMillisEstimate": 17,
                        "works": 129951,
                        "advanced": 129949,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 136,
                        "restoreState": 136,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 129949,
                           "executionTimeMillisEstimate": 15,
                           "works": 129951,
                           "advanced": 129949,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 136,
                           "restoreState": 136,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 129949,
                              "executionTimeMillisEstimate": 3,
                              "works": 129951,
                              "advanced": 129949,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 136,
                              "restoreState": 136,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 129949
                           }
                        }
                     }
                  }
               },
               "nReturned": 129949,
               "executionTimeMillisEstimate": 227
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 296
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 884495,
                     "executionTimeMillis": 2348,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1010008,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 884495,
                        "executionTimeMillisEstimate": 199,
                        "works": 1010010,
                        "advanced": 884495,
                        "needTime": 125514,
                        "needYield": 0,
                        "saveState": 1053,
                        "restoreState": 1053,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 884495,
                           "executionTimeMillisEstimate": 155,
                           "works": 1010010,
                           "advanced": 884495,
                           "needTime": 125514,
                           "needYield": 0,
                           "saveState": 1053,
                           "restoreState": 1053,
                           "isEOF": 1,
                           "chunkSkips": 125513,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1010008,
                              "executionTimeMillisEstimate": 46,
                              "works": 1010010,
                              "advanced": 1010008,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1053,
                              "restoreState": 1053,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1010008
                           }
                        }
                     }
                  }
               },
               "nReturned": 884495,
               "executionTimeMillisEstimate": 1810
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2347
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425399,
         "i": 1297
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425399,
            "i": 1299
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 94975,
                     "executionTimeMillis": 229,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 94975,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 94975,
                        "executionTimeMillisEstimate": 21,
                        "works": 94977,
                        "advanced": 94975,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 99,
                        "restoreState": 99,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 94975,
                           "executionTimeMillisEstimate": 9,
                           "works": 94977,
                           "advanced": 94975,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 99,
                           "restoreState": 99,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 94975,
                              "executionTimeMillisEstimate": 2,
                              "works": 94977,
                              "advanced": 94975,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 99,
                              "restoreState": 99,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 94975
                           }
                        }
                     }
                  }
               },
               "nReturned": 94975,
               "executionTimeMillisEstimate": 169
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 84,
               "executionTimeMillisEstimate": 228
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 129949,
                     "executionTimeMillis": 307,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 129949,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 129949,
                        "executionTimeMillisEstimate": 18,
                        "works": 129951,
                        "advanced": 129949,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 135,
                        "restoreState": 135,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 129949,
                           "executionTimeMillisEstimate": 14,
                           "works": 129951,
                           "advanced": 129949,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 135,
                           "restoreState": 135,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 129949,
                              "executionTimeMillisEstimate": 10,
                              "works": 129951,
                              "advanced": 129949,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 135,
                              "restoreState": 135,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 129949
                           }
                        }
                     }
                  }
               },
               "nReturned": 129949,
               "executionTimeMillisEstimate": 229
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 155,
               "executionTimeMillisEstimate": 307
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 884495,
                     "executionTimeMillis": 2327,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1010008,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 884495,
                        "executionTimeMillisEstimate": 192,
                        "works": 1010010,
                        "advanced": 884495,
                        "needTime": 125514,
                        "needYield": 0,
                        "saveState": 1060,
                        "restoreState": 1060,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 884495,
                           "executionTimeMillisEstimate": 139,
                           "works": 1010010,
                           "advanced": 884495,
                           "needTime": 125514,
                           "needYield": 0,
                           "saveState": 1060,
                           "restoreState": 1060,
                           "isEOF": 1,
                           "chunkSkips": 125513,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1010008,
                              "executionTimeMillisEstimate": 38,
                              "works": 1010010,
                              "advanced": 1010008,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1060,
                              "restoreState": 1060,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1010008
                           }
                        }
                     }
                  }
               },
               "nReturned": 884495,
               "executionTimeMillisEstimate": 1767
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 356,
               "executionTimeMillisEstimate": 2326
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425402,
         "i": 1
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425402,
            "i": 9
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 94975,
                     "executionTimeMillis": 236,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 94975,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 94975,
                        "executionTimeMillisEstimate": 13,
                        "works": 94977,
                        "advanced": 94975,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 101,
                        "restoreState": 101,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 94975,
                           "executionTimeMillisEstimate": 12,
                           "works": 94977,
                           "advanced": 94975,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 101,
                           "restoreState": 101,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 94975,
                              "executionTimeMillisEstimate": 1,
                              "works": 94977,
                              "advanced": 94975,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 101,
                              "restoreState": 101,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 94975
                           }
                        }
                     }
                  }
               },
               "nReturned": 94975,
               "executionTimeMillisEstimate": 191
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 106,
               "executionTimeMillisEstimate": 235
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 129949,
                     "executionTimeMillis": 308,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 129949,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 129949,
                        "executionTimeMillisEstimate": 19,
                        "works": 129951,
                        "advanced": 129949,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 137,
                        "restoreState": 137,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 129949,
                           "executionTimeMillisEstimate": 15,
                           "works": 129951,
                           "advanced": 129949,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 137,
                           "restoreState": 137,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 129949,
                              "executionTimeMillisEstimate": 1,
                              "works": 129951,
                              "advanced": 129949,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 137,
                              "restoreState": 137,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 129949
                           }
                        }
                     }
                  }
               },
               "nReturned": 129949,
               "executionTimeMillisEstimate": 238
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 132,
               "executionTimeMillisEstimate": 303
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 884495,
                     "executionTimeMillis": 2250,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1010008,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 884495,
                        "executionTimeMillisEstimate": 160,
                        "works": 1010010,
                        "advanced": 884495,
                        "needTime": 125514,
                        "needYield": 0,
                        "saveState": 1048,
                        "restoreState": 1048,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 884495,
                           "executionTimeMillisEstimate": 135,
                           "works": 1010010,
                           "advanced": 884495,
                           "needTime": 125514,
                           "needYield": 0,
                           "saveState": 1048,
                           "restoreState": 1048,
                           "isEOF": 1,
                           "chunkSkips": 125513,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1010008,
                              "executionTimeMillisEstimate": 31,
                              "works": 1010010,
                              "advanced": 1010008,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1048,
                              "restoreState": 1048,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1010008
                           }
                        }
                     }
                  }
               },
               "nReturned": 884495,
               "executionTimeMillisEstimate": 1690
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 132,
               "executionTimeMillisEstimate": 2245
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425404,
         "i": 1116
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425404,
            "i": 1116
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 19243,
                     "executionTimeMillis": 89,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 94975,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 19243,
                        "executionTimeMillisEstimate": 4,
                        "works": 94977,
                        "advanced": 19243,
                        "needTime": 75733,
                        "needYield": 0,
                        "saveState": 95,
                        "restoreState": 95,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 19243,
                           "executionTimeMillisEstimate": 4,
                           "works": 94977,
                           "advanced": 19243,
                           "needTime": 75733,
                           "needYield": 0,
                           "saveState": 95,
                           "restoreState": 95,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 19243,
                              "executionTimeMillisEstimate": 2,
                              "works": 94977,
                              "advanced": 19243,
                              "needTime": 75733,
                              "needYield": 0,
                              "saveState": 95,
                              "restoreState": 95,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 94975
                           }
                        }
                     }
                  }
               },
               "nReturned": 19243,
               "executionTimeMillisEstimate": 75
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 80,
               "executionTimeMillisEstimate": 85
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 27483,
                     "executionTimeMillis": 118,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 129949,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 27483,
                        "executionTimeMillisEstimate": 2,
                        "works": 129951,
                        "advanced": 27483,
                        "needTime": 102467,
                        "needYield": 0,
                        "saveState": 130,
                        "restoreState": 130,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 27483,
                           "executionTimeMillisEstimate": 2,
                           "works": 129951,
                           "advanced": 27483,
                           "needTime": 102467,
                           "needYield": 0,
                           "saveState": 130,
                           "restoreState": 130,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 27483,
                              "executionTimeMillisEstimate": 2,
                              "works": 129951,
                              "advanced": 27483,
                              "needTime": 102467,
                              "needYield": 0,
                              "saveState": 130,
                              "restoreState": 130,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 129949
                           }
                        }
                     }
                  }
               },
               "nReturned": 27483,
               "executionTimeMillisEstimate": 98
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 148,
               "executionTimeMillisEstimate": 111
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 168789,
                     "executionTimeMillis": 889,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1010008,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 168789,
                        "executionTimeMillisEstimate": 64,
                        "works": 1010010,
                        "advanced": 168789,
                        "needTime": 841220,
                        "needYield": 0,
                        "saveState": 1018,
                        "restoreState": 1018,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 168789,
                           "executionTimeMillisEstimate": 57,
                           "works": 1010010,
                           "advanced": 168789,
                           "needTime": 841220,
                           "needYield": 0,
                           "saveState": 1018,
                           "restoreState": 1018,
                           "isEOF": 1,
                           "chunkSkips": 26271,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 195060,
                              "executionTimeMillisEstimate": 36,
                              "works": 1010010,
                              "advanced": 195060,
                              "needTime": 814949,
                              "needYield": 0,
                              "saveState": 1018,
                              "restoreState": 1018,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1010008
                           }
                        }
                     }
                  }
               },
               "nReturned": 168789,
               "executionTimeMillisEstimate": 780
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 355,
               "executionTimeMillisEstimate": 883
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425405,
         "i": 972
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425405,
            "i": 972
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 19243,
                     "executionTimeMillis": 96,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 94975,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 19243,
                        "executionTimeMillisEstimate": 4,
                        "works": 94977,
                        "advanced": 19243,
                        "needTime": 75733,
                        "needYield": 0,
                        "saveState": 95,
                        "restoreState": 95,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 19243,
                           "executionTimeMillisEstimate": 4,
                           "works": 94977,
                           "advanced": 19243,
                           "needTime": 75733,
                           "needYield": 0,
                           "saveState": 95,
                           "restoreState": 95,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 19243,
                              "executionTimeMillisEstimate": 2,
                              "works": 94977,
                              "advanced": 19243,
                              "needTime": 75733,
                              "needYield": 0,
                              "saveState": 95,
                              "restoreState": 95,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 94975
                           }
                        }
                     }
                  }
               },
               "nReturned": 19243,
               "executionTimeMillisEstimate": 82
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 105,
               "executionTimeMillisEstimate": 95
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 27483,
                     "executionTimeMillis": 129,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 129949,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 27483,
                        "executionTimeMillisEstimate": 11,
                        "works": 129951,
                        "advanced": 27483,
                        "needTime": 102467,
                        "needYield": 0,
                        "saveState": 130,
                        "restoreState": 130,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 27483,
                           "executionTimeMillisEstimate": 8,
                           "works": 129951,
                           "advanced": 27483,
                           "needTime": 102467,
                           "needYield": 0,
                           "saveState": 130,
                           "restoreState": 130,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 27483,
                              "executionTimeMillisEstimate": 6,
                              "works": 129951,
                              "advanced": 27483,
                              "needTime": 102467,
                              "needYield": 0,
                              "saveState": 130,
                              "restoreState": 130,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 129949
                           }
                        }
                     }
                  }
               },
               "nReturned": 27483,
               "executionTimeMillisEstimate": 109
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 131,
               "executionTimeMillisEstimate": 119
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 168789,
                     "executionTimeMillis": 870,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1010008,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 168789,
                        "executionTimeMillisEstimate": 51,
                        "works": 1010010,
                        "advanced": 168789,
                        "needTime": 841220,
                        "needYield": 0,
                        "saveState": 1019,
                        "restoreState": 1019,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 168789,
                           "executionTimeMillisEstimate": 46,
                           "works": 1010010,
                           "advanced": 168789,
                           "needTime": 841220,
                           "needYield": 0,
                           "saveState": 1019,
                           "restoreState": 1019,
                           "isEOF": 1,
                           "chunkSkips": 26271,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 195060,
                              "executionTimeMillisEstimate": 29,
                              "works": 1010010,
                              "advanced": 195060,
                              "needTime": 814949,
                              "needYield": 0,
                              "saveState": 1019,
                              "restoreState": 1019,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1010008
                           }
                        }
                     }
                  }
               },
               "nReturned": 168789,
               "executionTimeMillisEstimate": 780
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 132,
               "executionTimeMillisEstimate": 862
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425405,
         "i": 987
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425405,
            "i": 995
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 19243,
                     "executionTimeMillis": 85,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 94975,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 19243,
                        "executionTimeMillisEstimate": 3,
                        "works": 94977,
                        "advanced": 19243,
                        "needTime": 75733,
                        "needYield": 0,
                        "saveState": 95,
                        "restoreState": 95,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 19243,
                           "executionTimeMillisEstimate": 3,
                           "works": 94977,
                           "advanced": 19243,
                           "needTime": 75733,
                           "needYield": 0,
                           "saveState": 95,
                           "restoreState": 95,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 19243,
                              "executionTimeMillisEstimate": 2,
                              "works": 94977,
                              "advanced": 19243,
                              "needTime": 75733,
                              "needYield": 0,
                              "saveState": 95,
                              "restoreState": 95,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 94975
                           }
                        }
                     }
                  }
               },
               "nReturned": 19243,
               "executionTimeMillisEstimate": 71
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 77
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 27483,
                     "executionTimeMillis": 116,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 129949,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 27483,
                        "executionTimeMillisEstimate": 2,
                        "works": 129951,
                        "advanced": 27483,
                        "needTime": 102467,
                        "needYield": 0,
                        "saveState": 130,
                        "restoreState": 130,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 27483,
                           "executionTimeMillisEstimate": 2,
                           "works": 129951,
                           "advanced": 27483,
                           "needTime": 102467,
                           "needYield": 0,
                           "saveState": 130,
                           "restoreState": 130,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 27483,
                              "executionTimeMillisEstimate": 0,
                              "works": 129951,
                              "advanced": 27483,
                              "needTime": 102467,
                              "needYield": 0,
                              "saveState": 130,
                              "restoreState": 130,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 129949
                           }
                        }
                     }
                  }
               },
               "nReturned": 27483,
               "executionTimeMillisEstimate": 97
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 110
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 168789,
                     "executionTimeMillis": 864,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1010008,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 168789,
                        "executionTimeMillisEstimate": 44,
                        "works": 1010010,
                        "advanced": 168789,
                        "needTime": 841220,
                        "needYield": 0,
                        "saveState": 1018,
                        "restoreState": 1018,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 168789,
                           "executionTimeMillisEstimate": 39,
                           "works": 1010010,
                           "advanced": 168789,
                           "needTime": 841220,
                           "needYield": 0,
                           "saveState": 1018,
                           "restoreState": 1018,
                           "isEOF": 1,
                           "chunkSkips": 26271,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 195060,
                              "executionTimeMillisEstimate": 29,
                              "works": 1010010,
                              "advanced": 195060,
                              "needTime": 814949,
                              "needYield": 0,
                              "saveState": 1018,
                              "restoreState": 1018,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1010008
                           }
                        }
                     }
                  }
               },
               "nReturned": 168789,
               "executionTimeMillisEstimate": 761
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 864
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425407,
         "i": 4
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425407,
            "i": 5
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 29173,
                     "executionTimeMillis": 102,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 94975,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 29173,
                        "executionTimeMillisEstimate": 9,
                        "works": 94977,
                        "advanced": 29173,
                        "needTime": 65803,
                        "needYield": 0,
                        "saveState": 95,
                        "restoreState": 95,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 29173,
                           "executionTimeMillisEstimate": 7,
                           "works": 94977,
                           "advanced": 29173,
                           "needTime": 65803,
                           "needYield": 0,
                           "saveState": 95,
                           "restoreState": 95,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 29173,
                              "executionTimeMillisEstimate": 1,
                              "works": 94977,
                              "advanced": 29173,
                              "needTime": 65803,
                              "needYield": 0,
                              "saveState": 95,
                              "restoreState": 95,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 94975
                           }
                        }
                     }
                  }
               },
               "nReturned": 29173,
               "executionTimeMillisEstimate": 83
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 71,
               "executionTimeMillisEstimate": 92
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 40335,
                     "executionTimeMillis": 145,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 132315,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 40335,
                        "executionTimeMillisEstimate": 12,
                        "works": 132317,
                        "advanced": 40335,
                        "needTime": 91981,
                        "needYield": 0,
                        "saveState": 134,
                        "restoreState": 134,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 40335,
                           "executionTimeMillisEstimate": 12,
                           "works": 132317,
                           "advanced": 40335,
                           "needTime": 91981,
                           "needYield": 0,
                           "saveState": 134,
                           "restoreState": 134,
                           "isEOF": 1,
                           "chunkSkips": 711,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 41046,
                              "executionTimeMillisEstimate": 6,
                              "works": 132317,
                              "advanced": 41046,
                              "needTime": 91270,
                              "needYield": 0,
                              "saveState": 134,
                              "restoreState": 134,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 132315
                           }
                        }
                     }
                  }
               },
               "nReturned": 40335,
               "executionTimeMillisEstimate": 119
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 141,
               "executionTimeMillisEstimate": 139
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 275786,
                     "executionTimeMillis": 1109,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1010008,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 275786,
                        "executionTimeMillisEstimate": 98,
                        "works": 1010010,
                        "advanced": 275786,
                        "needTime": 734223,
                        "needYield": 0,
                        "saveState": 1025,
                        "restoreState": 1025,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 275786,
                           "executionTimeMillisEstimate": 86,
                           "works": 1010010,
                           "advanced": 275786,
                           "needTime": 734223,
                           "needYield": 0,
                           "saveState": 1025,
                           "restoreState": 1025,
                           "isEOF": 1,
                           "chunkSkips": 38436,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 314222,
                              "executionTimeMillisEstimate": 38,
                              "works": 1010010,
                              "advanced": 314222,
                              "needTime": 695787,
                              "needYield": 0,
                              "saveState": 1025,
                              "restoreState": 1025,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1010008
                           }
                        }
                     }
                  }
               },
               "nReturned": 275786,
               "executionTimeMillisEstimate": 931
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 352,
               "executionTimeMillisEstimate": 1108
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425407,
         "i": 6184
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425407,
            "i": 6184
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 29173,
                     "executionTimeMillis": 134,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 94975,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 29173,
                        "executionTimeMillisEstimate": 50,
                        "works": 94977,
                        "advanced": 29173,
                        "needTime": 65803,
                        "needYield": 0,
                        "saveState": 95,
                        "restoreState": 95,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 29173,
                           "executionTimeMillisEstimate": 44,
                           "works": 94977,
                           "advanced": 29173,
                           "needTime": 65803,
                           "needYield": 0,
                           "saveState": 95,
                           "restoreState": 95,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 29173,
                              "executionTimeMillisEstimate": 27,
                              "works": 94977,
                              "advanced": 29173,
                              "needTime": 65803,
                              "needYield": 0,
                              "saveState": 95,
                              "restoreState": 95,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 94975
                           }
                        }
                     }
                  }
               },
               "nReturned": 29173,
               "executionTimeMillisEstimate": 100
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 104,
               "executionTimeMillisEstimate": 130
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 41046,
                     "executionTimeMillis": 151,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 132315,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 41046,
                        "executionTimeMillisEstimate": 5,
                        "works": 132317,
                        "advanced": 41046,
                        "needTime": 91270,
                        "needYield": 0,
                        "saveState": 134,
                        "restoreState": 134,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 41046,
                           "executionTimeMillisEstimate": 5,
                           "works": 132317,
                           "advanced": 41046,
                           "needTime": 91270,
                           "needYield": 0,
                           "saveState": 134,
                           "restoreState": 134,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 41046,
                              "executionTimeMillisEstimate": 5,
                              "works": 132317,
                              "advanced": 41046,
                              "needTime": 91270,
                              "needYield": 0,
                              "saveState": 134,
                              "restoreState": 134,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 132315
                           }
                        }
                     }
                  }
               },
               "nReturned": 41046,
               "executionTimeMillisEstimate": 132
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 134,
               "executionTimeMillisEstimate": 147
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 275075,
                     "executionTimeMillis": 1201,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1010008,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 275075,
                        "executionTimeMillisEstimate": 131,
                        "works": 1010010,
                        "advanced": 275075,
                        "needTime": 734934,
                        "needYield": 0,
                        "saveState": 1020,
                        "restoreState": 1020,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 275075,
                           "executionTimeMillisEstimate": 115,
                           "works": 1010010,
                           "advanced": 275075,
                           "needTime": 734934,
                           "needYield": 0,
                           "saveState": 1020,
                           "restoreState": 1020,
                           "isEOF": 1,
                           "chunkSkips": 39147,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 314222,
                              "executionTimeMillisEstimate": 63,
                              "works": 1010010,
                              "advanced": 314222,
                              "needTime": 695787,
                              "needYield": 0,
                              "saveState": 1020,
                              "restoreState": 1020,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1010008
                           }
                        }
                     }
                  }
               },
               "nReturned": 275075,
               "executionTimeMillisEstimate": 995
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 128,
               "executionTimeMillisEstimate": 1197
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425409,
         "i": 697
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425409,
            "i": 697
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 29309,
                     "executionTimeMillis": 121,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 95400,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 29309,
                        "executionTimeMillisEstimate": 5,
                        "works": 95402,
                        "advanced": 29309,
                        "needTime": 66092,
                        "needYield": 0,
                        "saveState": 98,
                        "restoreState": 98,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 29309,
                           "executionTimeMillisEstimate": 5,
                           "works": 95402,
                           "advanced": 29309,
                           "needTime": 66092,
                           "needYield": 0,
                           "saveState": 98,
                           "restoreState": 98,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 29309,
                              "executionTimeMillisEstimate": 5,
                              "works": 95402,
                              "advanced": 29309,
                              "needTime": 66092,
                              "needYield": 0,
                              "saveState": 98,
                              "restoreState": 98,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 95400
                           }
                        }
                     }
                  }
               },
               "nReturned": 29309,
               "executionTimeMillisEstimate": 109
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 121
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 41046,
                     "executionTimeMillis": 184,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 132315,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 41046,
                        "executionTimeMillisEstimate": 64,
                        "works": 132317,
                        "advanced": 41046,
                        "needTime": 91270,
                        "needYield": 0,
                        "saveState": 134,
                        "restoreState": 134,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 41046,
                           "executionTimeMillisEstimate": 58,
                           "works": 132317,
                           "advanced": 41046,
                           "needTime": 91270,
                           "needYield": 0,
                           "saveState": 134,
                           "restoreState": 134,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 41046,
                              "executionTimeMillisEstimate": 32,
                              "works": 132317,
                              "advanced": 41046,
                              "needTime": 91270,
                              "needYield": 0,
                              "saveState": 134,
                              "restoreState": 134,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 132315
                           }
                        }
                     }
                  }
               },
               "nReturned": 41046,
               "executionTimeMillisEstimate": 143
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 178
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 274939,
                     "executionTimeMillis": 1124,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1008116,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 274939,
                        "executionTimeMillisEstimate": 96,
                        "works": 1008118,
                        "advanced": 274939,
                        "needTime": 733178,
                        "needYield": 0,
                        "saveState": 1022,
                        "restoreState": 1022,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 274939,
                           "executionTimeMillisEstimate": 87,
                           "works": 1008118,
                           "advanced": 274939,
                           "needTime": 733178,
                           "needYield": 0,
                           "saveState": 1022,
                           "restoreState": 1022,
                           "isEOF": 1,
                           "chunkSkips": 38788,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 313727,
                              "executionTimeMillisEstimate": 50,
                              "works": 1008118,
                              "advanced": 313727,
                              "needTime": 694390,
                              "needYield": 0,
                              "saveState": 1022,
                              "restoreState": 1022,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1008116
                           }
                        }
                     }
                  }
               },
               "nReturned": 274939,
               "executionTimeMillisEstimate": 961
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1114
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425410,
         "i": 295
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425410,
            "i": 295
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 95400,
                     "executionTimeMillis": 259,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 95400,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 95400,
                        "executionTimeMillisEstimate": 19,
                        "works": 95402,
                        "advanced": 95400,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 100,
                        "restoreState": 100,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 95400,
                           "executionTimeMillisEstimate": 12,
                           "works": 95402,
                           "advanced": 95400,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 100,
                           "restoreState": 100,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 95400,
                              "executionTimeMillisEstimate": 2,
                              "works": 95402,
                              "advanced": 95400,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 100,
                              "restoreState": 100,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 95400
                           }
                        }
                     }
                  }
               },
               "nReturned": 95400,
               "executionTimeMillisEstimate": 162
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 155,
               "executionTimeMillisEstimate": 253
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 132315,
                     "executionTimeMillis": 361,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 132315,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 132315,
                        "executionTimeMillisEstimate": 17,
                        "works": 132317,
                        "advanced": 132315,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 139,
                        "restoreState": 139,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 132315,
                           "executionTimeMillisEstimate": 11,
                           "works": 132317,
                           "advanced": 132315,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 139,
                           "restoreState": 139,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 132315,
                              "executionTimeMillisEstimate": 6,
                              "works": 132317,
                              "advanced": 132315,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 139,
                              "restoreState": 139,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 132315
                           }
                        }
                     }
                  }
               },
               "nReturned": 132315,
               "executionTimeMillisEstimate": 226
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 259,
               "executionTimeMillisEstimate": 359
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 881704,
                     "executionTimeMillis": 2832,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1007926,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 881704,
                        "executionTimeMillisEstimate": 177,
                        "works": 1007928,
                        "advanced": 881704,
                        "needTime": 126223,
                        "needYield": 0,
                        "saveState": 1062,
                        "restoreState": 1062,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 881704,
                           "executionTimeMillisEstimate": 136,
                           "works": 1007928,
                           "advanced": 881704,
                           "needTime": 126223,
                           "needYield": 0,
                           "saveState": 1062,
                           "restoreState": 1062,
                           "isEOF": 1,
                           "chunkSkips": 126222,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1007926,
                              "executionTimeMillisEstimate": 40,
                              "works": 1007928,
                              "advanced": 1007926,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1062,
                              "restoreState": 1062,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1007926
                           }
                        }
                     }
                  }
               },
               "nReturned": 881704,
               "executionTimeMillisEstimate": 1739
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1180,
               "executionTimeMillisEstimate": 2824
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425413,
         "i": 1274
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425413,
            "i": 1274
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 95400,
                     "executionTimeMillis": 297,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 95400,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 95400,
                        "executionTimeMillisEstimate": 57,
                        "works": 95402,
                        "advanced": 95400,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 102,
                        "restoreState": 102,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 95400,
                           "executionTimeMillisEstimate": 42,
                           "works": 95402,
                           "advanced": 95400,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 102,
                           "restoreState": 102,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 95400,
                              "executionTimeMillisEstimate": 11,
                              "works": 95402,
                              "advanced": 95400,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 102,
                              "restoreState": 102,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 95400
                           }
                        }
                     }
                  }
               },
               "nReturned": 95400,
               "executionTimeMillisEstimate": 161
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 303,
               "executionTimeMillisEstimate": 292
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138053,
                     "executionTimeMillis": 414,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138053,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138053,
                        "executionTimeMillisEstimate": 21,
                        "works": 138055,
                        "advanced": 138053,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 148,
                        "restoreState": 148,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138053,
                           "executionTimeMillisEstimate": 18,
                           "works": 138055,
                           "advanced": 138053,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 148,
                           "restoreState": 148,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138053,
                              "executionTimeMillisEstimate": 1,
                              "works": 138055,
                              "advanced": 138053,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 148,
                              "restoreState": 148,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138053
                           }
                        }
                     }
                  }
               },
               "nReturned": 138053,
               "executionTimeMillisEstimate": 267
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 357,
               "executionTimeMillisEstimate": 407
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 875966,
                     "executionTimeMillis": 2798,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1005499,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 875966,
                        "executionTimeMillisEstimate": 195,
                        "works": 1005501,
                        "advanced": 875966,
                        "needTime": 129534,
                        "needYield": 0,
                        "saveState": 1052,
                        "restoreState": 1052,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 875966,
                           "executionTimeMillisEstimate": 149,
                           "works": 1005501,
                           "advanced": 875966,
                           "needTime": 129534,
                           "needYield": 0,
                           "saveState": 1052,
                           "restoreState": 1052,
                           "isEOF": 1,
                           "chunkSkips": 129533,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1005499,
                              "executionTimeMillisEstimate": 36,
                              "works": 1005501,
                              "advanced": 1005499,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1052,
                              "restoreState": 1052,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1005499
                           }
                        }
                     }
                  }
               },
               "nReturned": 875966,
               "executionTimeMillisEstimate": 1778
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 543,
               "executionTimeMillisEstimate": 2791
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425416,
         "i": 15
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425416,
            "i": 23
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1291,
            "executionTimeMillis": 44,
            "totalKeysExamined": 0,
            "totalDocsExamined": 95400,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1291,
               "executionTimeMillisEstimate": 4,
               "works": 95402,
               "advanced": 1291,
               "needTime": 94110,
               "needYield": 0,
               "saveState": 95,
               "restoreState": 95,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 1291,
                  "executionTimeMillisEstimate": 4,
                  "works": 95402,
                  "advanced": 1291,
                  "needTime": 94110,
                  "needYield": 0,
                  "saveState": 95,
                  "restoreState": 95,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 95400
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 2037,
            "executionTimeMillis": 63,
            "totalKeysExamined": 0,
            "totalDocsExamined": 138053,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 2037,
               "executionTimeMillisEstimate": 3,
               "works": 138055,
               "advanced": 2037,
               "needTime": 136017,
               "needYield": 0,
               "saveState": 138,
               "restoreState": 138,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 2037,
                  "executionTimeMillisEstimate": 3,
                  "works": 138055,
                  "advanced": 2037,
                  "needTime": 136017,
                  "needYield": 0,
                  "saveState": 138,
                  "restoreState": 138,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 138053
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_DEST_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 11497,
            "executionTimeMillis": 448,
            "totalKeysExamined": 0,
            "totalDocsExamined": 1003991,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 11497,
               "executionTimeMillisEstimate": 11,
               "works": 1003993,
               "advanced": 11497,
               "needTime": 992495,
               "needYield": 0,
               "saveState": 1003,
               "restoreState": 1003,
               "isEOF": 1,
               "chunkSkips": 1767,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 13264,
                  "executionTimeMillisEstimate": 8,
                  "works": 1003993,
                  "advanced": 13264,
                  "needTime": 990728,
                  "needYield": 0,
                  "saveState": 1003,
                  "restoreState": 1003,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 1003991
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425416,
         "i": 23
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425416,
            "i": 23
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 95400,
                     "executionTimeMillis": 370,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 95400,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 95400,
                        "executionTimeMillisEstimate": 48,
                        "works": 95402,
                        "advanced": 95400,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 106,
                        "restoreState": 106,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 95400,
                           "executionTimeMillisEstimate": 15,
                           "works": 95402,
                           "advanced": 95400,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 106,
                           "restoreState": 106,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 95400,
                              "executionTimeMillisEstimate": 5,
                              "works": 95402,
                              "advanced": 95400,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 106,
                              "restoreState": 106,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 95400
                           }
                        }
                     }
                  }
               },
               "nReturned": 95400,
               "executionTimeMillisEstimate": 328
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 551,
               "executionTimeMillisEstimate": 366
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138053,
                     "executionTimeMillis": 544,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138053,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 138053,
                        "executionTimeMillisEstimate": 68,
                        "works": 138055,
                        "advanced": 138053,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 154,
                        "restoreState": 154,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138053,
                           "executionTimeMillisEstimate": 29,
                           "works": 138055,
                           "advanced": 138053,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 154,
                           "restoreState": 154,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138053,
                              "executionTimeMillisEstimate": 2,
                              "works": 138055,
                              "advanced": 138053,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 154,
                              "restoreState": 154,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138053
                           }
                        }
                     }
                  }
               },
               "nReturned": 138053,
               "executionTimeMillisEstimate": 459
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 983,
               "executionTimeMillisEstimate": 536
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 875966,
                     "executionTimeMillis": 4089,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1003991,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 875966,
                        "executionTimeMillisEstimate": 674,
                        "works": 1003993,
                        "advanced": 875966,
                        "needTime": 128026,
                        "needYield": 0,
                        "saveState": 1102,
                        "restoreState": 1102,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 875966,
                           "executionTimeMillisEstimate": 308,
                           "works": 1003993,
                           "advanced": 875966,
                           "needTime": 128026,
                           "needYield": 0,
                           "saveState": 1102,
                           "restoreState": 1102,
                           "isEOF": 1,
                           "chunkSkips": 128025,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1003991,
                              "executionTimeMillisEstimate": 94,
                              "works": 1003993,
                              "advanced": 1003991,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1102,
                              "restoreState": 1102,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1003991
                           }
                        }
                     }
                  }
               },
               "nReturned": 875966,
               "executionTimeMillisEstimate": 3442
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2464,
               "executionTimeMillisEstimate": 4087
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425420,
         "i": 14
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425420,
            "i": 22
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 95607,
                     "executionTimeMillis": 377,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 95607,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 95607,
                        "executionTimeMillisEstimate": 51,
                        "works": 95609,
                        "advanced": 95607,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 106,
                        "restoreState": 106,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 95607,
                           "executionTimeMillisEstimate": 23,
                           "works": 95609,
                           "advanced": 95607,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 106,
                           "restoreState": 106,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 95607,
                              "executionTimeMillisEstimate": 9,
                              "works": 95609,
                              "advanced": 95607,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 106,
                              "restoreState": 106,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 95607
                           }
                        }
                     }
                  }
               },
               "nReturned": 95607,
               "executionTimeMillisEstimate": 321
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 753,
               "executionTimeMillisEstimate": 369
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138053,
                     "executionTimeMillis": 592,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138053,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 138053,
                        "executionTimeMillisEstimate": 259,
                        "works": 138055,
                        "advanced": 138053,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 154,
                        "restoreState": 154,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138053,
                           "executionTimeMillisEstimate": 81,
                           "works": 138055,
                           "advanced": 138053,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 154,
                           "restoreState": 154,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138053,
                              "executionTimeMillisEstimate": 15,
                              "works": 138055,
                              "advanced": 138053,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 154,
                              "restoreState": 154,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138053
                           }
                        }
                     }
                  }
               },
               "nReturned": 138053,
               "executionTimeMillisEstimate": 473
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 934,
               "executionTimeMillisEstimate": 586
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 875759,
                     "executionTimeMillis": 4020,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1003991,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 875759,
                        "executionTimeMillisEstimate": 605,
                        "works": 1003993,
                        "advanced": 875759,
                        "needTime": 128233,
                        "needYield": 0,
                        "saveState": 1101,
                        "restoreState": 1101,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 875759,
                           "executionTimeMillisEstimate": 302,
                           "works": 1003993,
                           "advanced": 875759,
                           "needTime": 128233,
                           "needYield": 0,
                           "saveState": 1101,
                           "restoreState": 1101,
                           "isEOF": 1,
                           "chunkSkips": 128232,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1003991,
                              "executionTimeMillisEstimate": 93,
                              "works": 1003993,
                              "advanced": 1003991,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1101,
                              "restoreState": 1101,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1003991
                           }
                        }
                     }
                  }
               },
               "nReturned": 875759,
               "executionTimeMillisEstimate": 3385
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 864,
               "executionTimeMillisEstimate": 4015
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425423,
         "i": 2008
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425423,
            "i": 2015
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 95607,
                     "executionTimeMillis": 199,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 95607,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 95607,
                        "executionTimeMillisEstimate": 9,
                        "works": 95609,
                        "advanced": 95607,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 99,
                        "restoreState": 99,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 95607,
                           "executionTimeMillisEstimate": 7,
                           "works": 95609,
                           "advanced": 95607,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 99,
                           "restoreState": 99,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 95607,
                              "executionTimeMillisEstimate": 1,
                              "works": 95609,
                              "advanced": 95607,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 99,
                              "restoreState": 99,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 95607
                           }
                        }
                     }
                  }
               },
               "nReturned": 95607,
               "executionTimeMillisEstimate": 139
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 193
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138053,
                     "executionTimeMillis": 282,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138053,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138053,
                        "executionTimeMillisEstimate": 18,
                        "works": 138055,
                        "advanced": 138053,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 143,
                        "restoreState": 143,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138053,
                           "executionTimeMillisEstimate": 14,
                           "works": 138055,
                           "advanced": 138053,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 143,
                           "restoreState": 143,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138053,
                              "executionTimeMillisEstimate": 2,
                              "works": 138055,
                              "advanced": 138053,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 143,
                              "restoreState": 143,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138053
                           }
                        }
                     }
                  }
               },
               "nReturned": 138053,
               "executionTimeMillisEstimate": 210
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 277
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 875759,
                     "executionTimeMillis": 2120,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1003991,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 875759,
                        "executionTimeMillisEstimate": 193,
                        "works": 1003993,
                        "advanced": 875759,
                        "needTime": 128233,
                        "needYield": 0,
                        "saveState": 1043,
                        "restoreState": 1043,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 875759,
                           "executionTimeMillisEstimate": 155,
                           "works": 1003993,
                           "advanced": 875759,
                           "needTime": 128233,
                           "needYield": 0,
                           "saveState": 1043,
                           "restoreState": 1043,
                           "isEOF": 1,
                           "chunkSkips": 128232,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1003991,
                              "executionTimeMillisEstimate": 35,
                              "works": 1003993,
                              "advanced": 1003991,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1043,
                              "restoreState": 1043,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1003991
                           }
                        }
                     }
                  }
               },
               "nReturned": 875759,
               "executionTimeMillisEstimate": 1627
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2119
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425426,
         "i": 3059
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425426,
            "i": 3059
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 15771,
                     "executionTimeMillis": 87,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 95607,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 15771,
                        "executionTimeMillisEstimate": 16,
                        "works": 95609,
                        "advanced": 15771,
                        "needTime": 79837,
                        "needYield": 0,
                        "saveState": 96,
                        "restoreState": 96,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 15771,
                           "executionTimeMillisEstimate": 12,
                           "works": 95609,
                           "advanced": 15771,
                           "needTime": 79837,
                           "needYield": 0,
                           "saveState": 96,
                           "restoreState": 96,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 15771,
                              "executionTimeMillisEstimate": 11,
                              "works": 95609,
                              "advanced": 15771,
                              "needTime": 79837,
                              "needYield": 0,
                              "saveState": 96,
                              "restoreState": 96,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 95607
                           }
                        }
                     }
                  }
               },
               "nReturned": 15771,
               "executionTimeMillisEstimate": 77
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 77,
               "executionTimeMillisEstimate": 80
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 22940,
                     "executionTimeMillis": 123,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138053,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 22940,
                        "executionTimeMillisEstimate": 5,
                        "works": 138055,
                        "advanced": 22940,
                        "needTime": 115114,
                        "needYield": 0,
                        "saveState": 139,
                        "restoreState": 139,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 22940,
                           "executionTimeMillisEstimate": 5,
                           "works": 138055,
                           "advanced": 22940,
                           "needTime": 115114,
                           "needYield": 0,
                           "saveState": 139,
                           "restoreState": 139,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 22940,
                              "executionTimeMillisEstimate": 2,
                              "works": 138055,
                              "advanced": 22940,
                              "needTime": 115114,
                              "needYield": 0,
                              "saveState": 139,
                              "restoreState": 139,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138053
                           }
                        }
                     }
                  }
               },
               "nReturned": 22940,
               "executionTimeMillisEstimate": 109
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 151,
               "executionTimeMillisEstimate": 120
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 143942,
                     "executionTimeMillis": 909,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1003991,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 143942,
                        "executionTimeMillisEstimate": 91,
                        "works": 1003993,
                        "advanced": 143942,
                        "needTime": 860050,
                        "needYield": 0,
                        "saveState": 1011,
                        "restoreState": 1011,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 143942,
                           "executionTimeMillisEstimate": 89,
                           "works": 1003993,
                           "advanced": 143942,
                           "needTime": 860050,
                           "needYield": 0,
                           "saveState": 1011,
                           "restoreState": 1011,
                           "isEOF": 1,
                           "chunkSkips": 21146,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 165088,
                              "executionTimeMillisEstimate": 65,
                              "works": 1003993,
                              "advanced": 165088,
                              "needTime": 838904,
                              "needYield": 0,
                              "saveState": 1011,
                              "restoreState": 1011,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1003991
                           }
                        }
                     }
                  }
               },
               "nReturned": 143942,
               "executionTimeMillisEstimate": 821
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 351,
               "executionTimeMillisEstimate": 909
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425427,
         "i": 23
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425427,
            "i": 31
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 15771,
                     "executionTimeMillis": 77,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 95607,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 15771,
                        "executionTimeMillisEstimate": 3,
                        "works": 95609,
                        "advanced": 15771,
                        "needTime": 79837,
                        "needYield": 0,
                        "saveState": 96,
                        "restoreState": 96,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 15771,
                           "executionTimeMillisEstimate": 3,
                           "works": 95609,
                           "advanced": 15771,
                           "needTime": 79837,
                           "needYield": 0,
                           "saveState": 96,
                           "restoreState": 96,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 15771,
                              "executionTimeMillisEstimate": 2,
                              "works": 95609,
                              "advanced": 15771,
                              "needTime": 79837,
                              "needYield": 0,
                              "saveState": 96,
                              "restoreState": 96,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 95607
                           }
                        }
                     }
                  }
               },
               "nReturned": 15771,
               "executionTimeMillisEstimate": 68
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 107,
               "executionTimeMillisEstimate": 70
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 22940,
                     "executionTimeMillis": 113,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138053,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 22940,
                        "executionTimeMillisEstimate": 7,
                        "works": 138055,
                        "advanced": 22940,
                        "needTime": 115114,
                        "needYield": 0,
                        "saveState": 139,
                        "restoreState": 139,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 22940,
                           "executionTimeMillisEstimate": 6,
                           "works": 138055,
                           "advanced": 22940,
                           "needTime": 115114,
                           "needYield": 0,
                           "saveState": 139,
                           "restoreState": 139,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 22940,
                              "executionTimeMillisEstimate": 4,
                              "works": 138055,
                              "advanced": 22940,
                              "needTime": 115114,
                              "needYield": 0,
                              "saveState": 139,
                              "restoreState": 139,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138053
                           }
                        }
                     }
                  }
               },
               "nReturned": 22940,
               "executionTimeMillisEstimate": 100
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 134,
               "executionTimeMillisEstimate": 110
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_DEST_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 143942,
                     "executionTimeMillis": 812,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1003991,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 143942,
                        "executionTimeMillisEstimate": 62,
                        "works": 1003993,
                        "advanced": 143942,
                        "needTime": 860050,
                        "needYield": 0,
                        "saveState": 1008,
                        "restoreState": 1008,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 143942,
                           "executionTimeMillisEstimate": 53,
                           "works": 1003993,
                           "advanced": 143942,
                           "needTime": 860050,
                           "needYield": 0,
                           "saveState": 1008,
                           "restoreState": 1008,
                           "isEOF": 1,
                           "chunkSkips": 21146,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 165088,
                              "executionTimeMillisEstimate": 31,
                              "works": 1003993,
                              "advanced": 165088,
                              "needTime": 838904,
                              "needYield": 0,
                              "saveState": 1008,
                              "restoreState": 1008,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1003991
                           }
                        }
                     }
                  }
               },
               "nReturned": 143942,
               "executionTimeMillisEstimate": 734
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 124,
               "executionTimeMillisEstimate": 808
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425428,
         "i": 2548
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425428,
            "i": 2549
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_FL_DATE<a name="AirlineData_FL_DATE"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "splitPipeline": null,
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_FL_DATE",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1601510400000), new Date(1601510400000)]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": [
               {
                  "stage": "SHARDING_FILTER",
                  "inputStage": {
                     "stage": "FETCH",
                     "filter": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$eq": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "ARR_DELAY": {
                                 "$gt": 1000
                              }
                           }
                        ]
                     },
                     "inputStage": {
                        "stage": "IXSCAN",
                        "keyPattern": {
                           "FL_DATE": "hashed"
                        },
                        "indexName": "FL_DATE_hashed",
                        "isMultiKey": false,
                        "isUnique": false,
                        "isSparse": false,
                        "isPartial": false,
                        "indexVersion": 2,
                        "direction": "forward",
                        "indexBounds": {
                           "FL_DATE": [
                              "[-3359744213950938654, -3359744213950938654]"
                           ]
                        }
                     }
                  }
               }
            ]
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 2,
            "executionTimeMillis": 46,
            "totalKeysExamined": 12530,
            "totalDocsExamined": 12530,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 2,
               "executionTimeMillisEstimate": 10,
               "works": 12532,
               "advanced": 2,
               "needTime": 12528,
               "needYield": 0,
               "saveState": 25,
               "restoreState": 25,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  },
                  "nReturned": 2,
                  "executionTimeMillisEstimate": 10,
                  "works": 12531,
                  "advanced": 2,
                  "needTime": 12528,
                  "needYield": 0,
                  "saveState": 25,
                  "restoreState": 25,
                  "isEOF": 1,
                  "docsExamined": 12530,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 12530,
                     "executionTimeMillisEstimate": 4,
                     "works": 12531,
                     "advanced": 12530,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 25,
                     "restoreState": 25,
                     "isEOF": 1,
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1601510400000), new Date(1601510400000)]"
                        ]
                     },
                     "keysExamined": 12530,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425428,
         "i": 2552
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425428,
            "i": 2553
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345135,
                     "executionTimeMillis": 992,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345135,
                        "executionTimeMillisEstimate": 97,
                        "works": 345137,
                        "advanced": 345135,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 363,
                        "restoreState": 363,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345135,
                           "executionTimeMillisEstimate": 80,
                           "works": 345137,
                           "advanced": 345135,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 363,
                           "restoreState": 363,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 345135,
                              "executionTimeMillisEstimate": 21,
                              "works": 345137,
                              "advanced": 345135,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 363,
                              "restoreState": 363,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 345135,
               "executionTimeMillisEstimate": 774
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 989
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 390514,
                     "executionTimeMillis": 1123,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 390514,
                        "executionTimeMillisEstimate": 86,
                        "works": 390516,
                        "advanced": 390514,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 410,
                        "restoreState": 410,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 390514,
                           "executionTimeMillisEstimate": 58,
                           "works": 390516,
                           "advanced": 390514,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 410,
                           "restoreState": 410,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 390514,
                              "executionTimeMillisEstimate": 17,
                              "works": 390516,
                              "advanced": 390514,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 410,
                              "restoreState": 410,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 390514,
               "executionTimeMillisEstimate": 885
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1113
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 373770,
                     "executionTimeMillis": 1190,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 373770,
                        "executionTimeMillisEstimate": 138,
                        "works": 373772,
                        "advanced": 373770,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 393,
                        "restoreState": 393,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 373770,
                           "executionTimeMillisEstimate": 113,
                           "works": 373772,
                           "advanced": 373770,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 393,
                           "restoreState": 393,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 373770,
                              "executionTimeMillisEstimate": 51,
                              "works": 373772,
                              "advanced": 373770,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 393,
                              "restoreState": 393,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 373770,
               "executionTimeMillisEstimate": 956
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1187
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425428,
         "i": 2560
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425428,
            "i": 2560
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345135,
                     "executionTimeMillis": 852,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345135,
                        "executionTimeMillisEstimate": 75,
                        "works": 345137,
                        "advanced": 345135,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 358,
                        "restoreState": 358,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345135,
                           "executionTimeMillisEstimate": 51,
                           "works": 345137,
                           "advanced": 345135,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 358,
                           "restoreState": 358,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 345135,
                              "executionTimeMillisEstimate": 11,
                              "works": 345137,
                              "advanced": 345135,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 358,
                              "restoreState": 358,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 345135,
               "executionTimeMillisEstimate": 647
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 369,
               "executionTimeMillisEstimate": 847
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 373770,
                     "executionTimeMillis": 944,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 373770,
                        "executionTimeMillisEstimate": 101,
                        "works": 373772,
                        "advanced": 373770,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 388,
                        "restoreState": 388,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 373770,
                           "executionTimeMillisEstimate": 66,
                           "works": 373772,
                           "advanced": 373770,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 388,
                           "restoreState": 388,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 373770,
                              "executionTimeMillisEstimate": 11,
                              "works": 373772,
                              "advanced": 373770,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 388,
                              "restoreState": 388,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 373770,
               "executionTimeMillisEstimate": 715
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 942
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 390514,
                     "executionTimeMillis": 974,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 390514,
                        "executionTimeMillisEstimate": 82,
                        "works": 390516,
                        "advanced": 390514,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 405,
                        "restoreState": 405,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 390514,
                           "executionTimeMillisEstimate": 68,
                           "works": 390516,
                           "advanced": 390514,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 405,
                           "restoreState": 405,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 390514,
                              "executionTimeMillisEstimate": 14,
                              "works": 390516,
                              "advanced": 390514,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 405,
                              "restoreState": 405,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 390514,
               "executionTimeMillisEstimate": 715
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 968
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425430,
         "i": 3989
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425430,
            "i": 3989
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345135,
                     "executionTimeMillis": 834,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345135,
                        "executionTimeMillisEstimate": 50,
                        "works": 345137,
                        "advanced": 345135,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 364,
                        "restoreState": 364,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345135,
                           "executionTimeMillisEstimate": 40,
                           "works": 345137,
                           "advanced": 345135,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 364,
                           "restoreState": 364,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 345135,
                              "executionTimeMillisEstimate": 11,
                              "works": 345137,
                              "advanced": 345135,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 364,
                              "restoreState": 364,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 345135,
               "executionTimeMillisEstimate": 657
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 369,
               "executionTimeMillisEstimate": 834
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 373770,
                     "executionTimeMillis": 947,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 373770,
                        "executionTimeMillisEstimate": 83,
                        "works": 373772,
                        "advanced": 373770,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 393,
                        "restoreState": 393,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 373770,
                           "executionTimeMillisEstimate": 66,
                           "works": 373772,
                           "advanced": 373770,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 393,
                           "restoreState": 393,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 373770,
                              "executionTimeMillisEstimate": 13,
                              "works": 373772,
                              "advanced": 373770,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 393,
                              "restoreState": 393,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 373770,
               "executionTimeMillisEstimate": 710
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 946
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 390514,
                     "executionTimeMillis": 979,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 390514,
                        "executionTimeMillisEstimate": 62,
                        "works": 390516,
                        "advanced": 390514,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 411,
                        "restoreState": 411,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 390514,
                           "executionTimeMillisEstimate": 46,
                           "works": 390516,
                           "advanced": 390514,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 411,
                           "restoreState": 411,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 390514,
                              "executionTimeMillisEstimate": 14,
                              "works": 390516,
                              "advanced": 390514,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 411,
                              "restoreState": 411,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 390514,
               "executionTimeMillisEstimate": 747
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 976
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425431,
         "i": 602
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425431,
            "i": 602
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 68397,
                     "executionTimeMillis": 320,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 68397,
                        "executionTimeMillisEstimate": 14,
                        "works": 345137,
                        "advanced": 68397,
                        "needTime": 276739,
                        "needYield": 0,
                        "saveState": 349,
                        "restoreState": 349,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 68397,
                           "executionTimeMillisEstimate": 13,
                           "works": 345137,
                           "advanced": 68397,
                           "needTime": 276739,
                           "needYield": 0,
                           "saveState": 349,
                           "restoreState": 349,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 68397,
                              "executionTimeMillisEstimate": 5,
                              "works": 345137,
                              "advanced": 68397,
                              "needTime": 276739,
                              "needYield": 0,
                              "saveState": 349,
                              "restoreState": 349,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 68397,
               "executionTimeMillisEstimate": 281
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 363,
               "executionTimeMillisEstimate": 316
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 70838,
                     "executionTimeMillis": 343,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 70838,
                        "executionTimeMillisEstimate": 16,
                        "works": 373772,
                        "advanced": 70838,
                        "needTime": 302933,
                        "needYield": 0,
                        "saveState": 377,
                        "restoreState": 377,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 70838,
                           "executionTimeMillisEstimate": 15,
                           "works": 373772,
                           "advanced": 70838,
                           "needTime": 302933,
                           "needYield": 0,
                           "saveState": 377,
                           "restoreState": 377,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 70838,
                              "executionTimeMillisEstimate": 9,
                              "works": 373772,
                              "advanced": 70838,
                              "needTime": 302933,
                              "needYield": 0,
                              "saveState": 377,
                              "restoreState": 377,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 70838,
               "executionTimeMillisEstimate": 291
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 342
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76280,
                     "executionTimeMillis": 371,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76280,
                        "executionTimeMillisEstimate": 18,
                        "works": 390516,
                        "advanced": 76280,
                        "needTime": 314235,
                        "needYield": 0,
                        "saveState": 394,
                        "restoreState": 394,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76280,
                           "executionTimeMillisEstimate": 15,
                           "works": 390516,
                           "advanced": 76280,
                           "needTime": 314235,
                           "needYield": 0,
                           "saveState": 394,
                           "restoreState": 394,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 76280,
                              "executionTimeMillisEstimate": 10,
                              "works": 390516,
                              "advanced": 76280,
                              "needTime": 314235,
                              "needYield": 0,
                              "saveState": 394,
                              "restoreState": 394,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 76280,
               "executionTimeMillisEstimate": 321
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 367,
               "executionTimeMillisEstimate": 365
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425431,
         "i": 602
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425431,
            "i": 605
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 68397,
                     "executionTimeMillis": 318,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 68397,
                        "executionTimeMillisEstimate": 11,
                        "works": 345137,
                        "advanced": 68397,
                        "needTime": 276739,
                        "needYield": 0,
                        "saveState": 349,
                        "restoreState": 349,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 68397,
                           "executionTimeMillisEstimate": 9,
                           "works": 345137,
                           "advanced": 68397,
                           "needTime": 276739,
                           "needYield": 0,
                           "saveState": 349,
                           "restoreState": 349,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 68397,
                              "executionTimeMillisEstimate": 9,
                              "works": 345137,
                              "advanced": 68397,
                              "needTime": 276739,
                              "needYield": 0,
                              "saveState": 349,
                              "restoreState": 349,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 68397,
               "executionTimeMillisEstimate": 279
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 316
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 70838,
                     "executionTimeMillis": 341,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 70838,
                        "executionTimeMillisEstimate": 17,
                        "works": 373772,
                        "advanced": 70838,
                        "needTime": 302933,
                        "needYield": 0,
                        "saveState": 377,
                        "restoreState": 377,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 70838,
                           "executionTimeMillisEstimate": 14,
                           "works": 373772,
                           "advanced": 70838,
                           "needTime": 302933,
                           "needYield": 0,
                           "saveState": 377,
                           "restoreState": 377,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 70838,
                              "executionTimeMillisEstimate": 8,
                              "works": 373772,
                              "advanced": 70838,
                              "needTime": 302933,
                              "needYield": 0,
                              "saveState": 377,
                              "restoreState": 377,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 70838,
               "executionTimeMillisEstimate": 297
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 340
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76280,
                     "executionTimeMillis": 368,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76280,
                        "executionTimeMillisEstimate": 11,
                        "works": 390516,
                        "advanced": 76280,
                        "needTime": 314235,
                        "needYield": 0,
                        "saveState": 394,
                        "restoreState": 394,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76280,
                           "executionTimeMillisEstimate": 10,
                           "works": 390516,
                           "advanced": 76280,
                           "needTime": 314235,
                           "needYield": 0,
                           "saveState": 394,
                           "restoreState": 394,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 76280,
                              "executionTimeMillisEstimate": 5,
                              "works": 390516,
                              "advanced": 76280,
                              "needTime": 314235,
                              "needYield": 0,
                              "saveState": 394,
                              "restoreState": 394,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 76280,
               "executionTimeMillisEstimate": 318
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 362
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425431,
         "i": 602
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425432,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 68397,
                     "executionTimeMillis": 317,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 68397,
                        "executionTimeMillisEstimate": 16,
                        "works": 345137,
                        "advanced": 68397,
                        "needTime": 276739,
                        "needYield": 0,
                        "saveState": 348,
                        "restoreState": 348,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 68397,
                           "executionTimeMillisEstimate": 13,
                           "works": 345137,
                           "advanced": 68397,
                           "needTime": 276739,
                           "needYield": 0,
                           "saveState": 348,
                           "restoreState": 348,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 68397,
                              "executionTimeMillisEstimate": 11,
                              "works": 345137,
                              "advanced": 68397,
                              "needTime": 276739,
                              "needYield": 0,
                              "saveState": 348,
                              "restoreState": 348,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 68397,
               "executionTimeMillisEstimate": 283
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 315
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 70838,
                     "executionTimeMillis": 338,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 70838,
                        "executionTimeMillisEstimate": 9,
                        "works": 373772,
                        "advanced": 70838,
                        "needTime": 302933,
                        "needYield": 0,
                        "saveState": 377,
                        "restoreState": 377,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 70838,
                           "executionTimeMillisEstimate": 7,
                           "works": 373772,
                           "advanced": 70838,
                           "needTime": 302933,
                           "needYield": 0,
                           "saveState": 377,
                           "restoreState": 377,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 70838,
                              "executionTimeMillisEstimate": 6,
                              "works": 373772,
                              "advanced": 70838,
                              "needTime": 302933,
                              "needYield": 0,
                              "saveState": 377,
                              "restoreState": 377,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 70838,
               "executionTimeMillisEstimate": 291
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 327
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76280,
                     "executionTimeMillis": 365,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76280,
                        "executionTimeMillisEstimate": 13,
                        "works": 390516,
                        "advanced": 76280,
                        "needTime": 314235,
                        "needYield": 0,
                        "saveState": 394,
                        "restoreState": 394,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76280,
                           "executionTimeMillisEstimate": 12,
                           "works": 390516,
                           "advanced": 76280,
                           "needTime": 314235,
                           "needYield": 0,
                           "saveState": 394,
                           "restoreState": 394,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 76280,
                              "executionTimeMillisEstimate": 6,
                              "works": 390516,
                              "advanced": 76280,
                              "needTime": 314235,
                              "needYield": 0,
                              "saveState": 394,
                              "restoreState": 394,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 76280,
               "executionTimeMillisEstimate": 322
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 363
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425431,
         "i": 602
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425432,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "79415CC2",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 69047,
                     "executionTimeMillis": 235,
                     "totalKeysExamined": 69047,
                     "totalDocsExamined": 69047,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 69047,
                        "executionTimeMillisEstimate": 23,
                        "works": 69048,
                        "advanced": 69047,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 72,
                        "restoreState": 72,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 69047,
                           "executionTimeMillisEstimate": 22,
                           "works": 69048,
                           "advanced": 69047,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 72,
                           "restoreState": 72,
                           "isEOF": 1,
                           "docsExamined": 69047,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 69047,
                              "executionTimeMillisEstimate": 18,
                              "works": 69048,
                              "advanced": 69047,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 72,
                              "restoreState": 72,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 69047,
                                 "executionTimeMillisEstimate": 4,
                                 "works": 69048,
                                 "advanced": 69047,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 72,
                                 "restoreState": 72,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 69047,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 69047,
               "executionTimeMillisEstimate": 190
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 228
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "79415CC2",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 116660,
                     "executionTimeMillis": 414,
                     "totalKeysExamined": 116660,
                     "totalDocsExamined": 116660,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 116660,
                        "executionTimeMillisEstimate": 73,
                        "works": 116661,
                        "advanced": 116660,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 121,
                        "restoreState": 121,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 116660,
                           "executionTimeMillisEstimate": 65,
                           "works": 116661,
                           "advanced": 116660,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 121,
                           "restoreState": 121,
                           "isEOF": 1,
                           "docsExamined": 116660,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 116660,
                              "executionTimeMillisEstimate": 47,
                              "works": 116661,
                              "advanced": 116660,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 121,
                              "restoreState": 121,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 116660,
                                 "executionTimeMillisEstimate": 12,
                                 "works": 116661,
                                 "advanced": 116660,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 121,
                                 "restoreState": 121,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 116660,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 116660,
               "executionTimeMillisEstimate": 326
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 403
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "79415CC2",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 159587,
                     "executionTimeMillis": 554,
                     "totalKeysExamined": 159587,
                     "totalDocsExamined": 159587,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 159587,
                        "executionTimeMillisEstimate": 92,
                        "works": 159588,
                        "advanced": 159587,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 166,
                        "restoreState": 166,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 159587,
                           "executionTimeMillisEstimate": 85,
                           "works": 159588,
                           "advanced": 159587,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 166,
                           "restoreState": 166,
                           "isEOF": 1,
                           "docsExamined": 159587,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 159587,
                              "executionTimeMillisEstimate": 67,
                              "works": 159588,
                              "advanced": 159587,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 166,
                              "restoreState": 166,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 159587,
                                 "executionTimeMillisEstimate": 19,
                                 "works": 159588,
                                 "advanced": 159587,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 166,
                                 "restoreState": 166,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 159587,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 159587,
               "executionTimeMillisEstimate": 442
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 551
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425433,
         "i": 2549
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425433,
            "i": 2549
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "F12D75A3",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 69047,
                     "executionTimeMillis": 234,
                     "totalKeysExamined": 69047,
                     "totalDocsExamined": 69047,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 69047,
                        "executionTimeMillisEstimate": 25,
                        "works": 69048,
                        "advanced": 69047,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 73,
                        "restoreState": 73,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 69047,
                           "executionTimeMillisEstimate": 19,
                           "works": 69048,
                           "advanced": 69047,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 73,
                           "restoreState": 73,
                           "isEOF": 1,
                           "docsExamined": 69047,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 69047,
                              "executionTimeMillisEstimate": 11,
                              "works": 69048,
                              "advanced": 69047,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 73,
                              "restoreState": 73,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 69047,
                                 "executionTimeMillisEstimate": 8,
                                 "works": 69048,
                                 "advanced": 69047,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 73,
                                 "restoreState": 73,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 69047,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 69047,
               "executionTimeMillisEstimate": 200
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 229
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "F12D75A3",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 116660,
                     "executionTimeMillis": 403,
                     "totalKeysExamined": 116660,
                     "totalDocsExamined": 116660,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 116660,
                        "executionTimeMillisEstimate": 42,
                        "works": 116661,
                        "advanced": 116660,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 122,
                        "restoreState": 122,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 116660,
                           "executionTimeMillisEstimate": 34,
                           "works": 116661,
                           "advanced": 116660,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 122,
                           "restoreState": 122,
                           "isEOF": 1,
                           "docsExamined": 116660,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 116660,
                              "executionTimeMillisEstimate": 24,
                              "works": 116661,
                              "advanced": 116660,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 122,
                              "restoreState": 122,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 116660,
                                 "executionTimeMillisEstimate": 6,
                                 "works": 116661,
                                 "advanced": 116660,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 122,
                                 "restoreState": 122,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 116660,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 116660,
               "executionTimeMillisEstimate": 323
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 397
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "F12D75A3",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 159587,
                     "executionTimeMillis": 537,
                     "totalKeysExamined": 159587,
                     "totalDocsExamined": 159587,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 159587,
                        "executionTimeMillisEstimate": 63,
                        "works": 159588,
                        "advanced": 159587,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 169,
                        "restoreState": 169,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 159587,
                           "executionTimeMillisEstimate": 55,
                           "works": 159588,
                           "advanced": 159587,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 169,
                           "restoreState": 169,
                           "isEOF": 1,
                           "docsExamined": 159587,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 159587,
                              "executionTimeMillisEstimate": 41,
                              "works": 159588,
                              "advanced": 159587,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 169,
                              "restoreState": 169,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 159587,
                                 "executionTimeMillisEstimate": 11,
                                 "works": 159588,
                                 "advanced": 159587,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 169,
                                 "restoreState": 169,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 159587,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 159587,
               "executionTimeMillisEstimate": 446
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 535
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425433,
         "i": 2559
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425433,
            "i": 2559
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "1AE8D25C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 69047,
                     "executionTimeMillis": 231,
                     "totalKeysExamined": 69047,
                     "totalDocsExamined": 69047,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 69047,
                        "executionTimeMillisEstimate": 32,
                        "works": 69048,
                        "advanced": 69047,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 72,
                        "restoreState": 72,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 69047,
                           "executionTimeMillisEstimate": 27,
                           "works": 69048,
                           "advanced": 69047,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 72,
                           "restoreState": 72,
                           "isEOF": 1,
                           "docsExamined": 69047,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 69047,
                              "executionTimeMillisEstimate": 14,
                              "works": 69048,
                              "advanced": 69047,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 72,
                              "restoreState": 72,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 69047,
                                 "executionTimeMillisEstimate": 3,
                                 "works": 69048,
                                 "advanced": 69047,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 72,
                                 "restoreState": 72,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 69047,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 69047,
               "executionTimeMillisEstimate": 183
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 229
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "1AE8D25C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 116660,
                     "executionTimeMillis": 401,
                     "totalKeysExamined": 116660,
                     "totalDocsExamined": 116660,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 116660,
                        "executionTimeMillisEstimate": 44,
                        "works": 116661,
                        "advanced": 116660,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 123,
                        "restoreState": 123,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 116660,
                           "executionTimeMillisEstimate": 30,
                           "works": 116661,
                           "advanced": 116660,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 123,
                           "restoreState": 123,
                           "isEOF": 1,
                           "docsExamined": 116660,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 116660,
                              "executionTimeMillisEstimate": 20,
                              "works": 116661,
                              "advanced": 116660,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 123,
                              "restoreState": 123,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 116660,
                                 "executionTimeMillisEstimate": 3,
                                 "works": 116661,
                                 "advanced": 116660,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 123,
                                 "restoreState": 123,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 116660,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 116660,
               "executionTimeMillisEstimate": 312
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 397
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "1AE8D25C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 159587,
                     "executionTimeMillis": 529,
                     "totalKeysExamined": 159587,
                     "totalDocsExamined": 159587,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 159587,
                        "executionTimeMillisEstimate": 57,
                        "works": 159588,
                        "advanced": 159587,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 167,
                        "restoreState": 167,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 159587,
                           "executionTimeMillisEstimate": 48,
                           "works": 159588,
                           "advanced": 159587,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 167,
                           "restoreState": 167,
                           "isEOF": 1,
                           "docsExamined": 159587,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 159587,
                              "executionTimeMillisEstimate": 31,
                              "works": 159588,
                              "advanced": 159587,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 167,
                              "restoreState": 167,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 159587,
                                 "executionTimeMillisEstimate": 11,
                                 "works": 159588,
                                 "advanced": 159587,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 167,
                                 "restoreState": 167,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 159587,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 159587,
               "executionTimeMillisEstimate": 424
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 527
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425434,
         "i": 2
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425434,
            "i": 2
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345135,
                     "executionTimeMillis": 1043,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345135,
                        "executionTimeMillisEstimate": 73,
                        "works": 345137,
                        "advanced": 345135,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 362,
                        "restoreState": 362,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345135,
                           "executionTimeMillisEstimate": 59,
                           "works": 345137,
                           "advanced": 345135,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 362,
                           "restoreState": 362,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 345135,
                              "executionTimeMillisEstimate": 23,
                              "works": 345137,
                              "advanced": 345135,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 362,
                              "restoreState": 362,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 345135,
               "executionTimeMillisEstimate": 651
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1194,
               "executionTimeMillisEstimate": 1032
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 390514,
                     "executionTimeMillis": 1166,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 390514,
                        "executionTimeMillisEstimate": 64,
                        "works": 390516,
                        "advanced": 390514,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 410,
                        "restoreState": 410,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 390514,
                           "executionTimeMillisEstimate": 51,
                           "works": 390516,
                           "advanced": 390514,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 410,
                           "restoreState": 410,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 390514,
                              "executionTimeMillisEstimate": 13,
                              "works": 390516,
                              "advanced": 390514,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 410,
                              "restoreState": 410,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 390514,
               "executionTimeMillisEstimate": 731
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1203,
               "executionTimeMillisEstimate": 1165
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 373770,
                     "executionTimeMillis": 1193,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 373770,
                        "executionTimeMillisEstimate": 89,
                        "works": 373772,
                        "advanced": 373770,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 392,
                        "restoreState": 392,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 373770,
                           "executionTimeMillisEstimate": 69,
                           "works": 373772,
                           "advanced": 373770,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 392,
                           "restoreState": 392,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 373770,
                              "executionTimeMillisEstimate": 22,
                              "works": 373772,
                              "advanced": 373770,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 392,
                              "restoreState": 392,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 373770,
               "executionTimeMillisEstimate": 714
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1202,
               "executionTimeMillisEstimate": 1192
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425435,
         "i": 2545
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425435,
            "i": 2545
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345135,
                     "executionTimeMillis": 1087,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345135,
                        "executionTimeMillisEstimate": 77,
                        "works": 345137,
                        "advanced": 345135,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 371,
                        "restoreState": 371,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345135,
                           "executionTimeMillisEstimate": 67,
                           "works": 345137,
                           "advanced": 345135,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 371,
                           "restoreState": 371,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 345135,
                              "executionTimeMillisEstimate": 13,
                              "works": 345137,
                              "advanced": 345135,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 371,
                              "restoreState": 371,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 345135,
               "executionTimeMillisEstimate": 715
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1194,
               "executionTimeMillisEstimate": 1076
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 390514,
                     "executionTimeMillis": 1193,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 390514,
                        "executionTimeMillisEstimate": 76,
                        "works": 390516,
                        "advanced": 390514,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 418,
                        "restoreState": 418,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 390514,
                           "executionTimeMillisEstimate": 63,
                           "works": 390516,
                           "advanced": 390514,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 418,
                           "restoreState": 418,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 390514,
                              "executionTimeMillisEstimate": 19,
                              "works": 390516,
                              "advanced": 390514,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 418,
                              "restoreState": 418,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 390514,
               "executionTimeMillisEstimate": 753
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1203,
               "executionTimeMillisEstimate": 1182
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 373770,
                     "executionTimeMillis": 1220,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 373770,
                        "executionTimeMillisEstimate": 108,
                        "works": 373772,
                        "advanced": 373770,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 402,
                        "restoreState": 402,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 373770,
                           "executionTimeMillisEstimate": 86,
                           "works": 373772,
                           "advanced": 373770,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 402,
                           "restoreState": 402,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 373770,
                              "executionTimeMillisEstimate": 12,
                              "works": 373772,
                              "advanced": 373770,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 402,
                              "restoreState": 402,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 373770,
               "executionTimeMillisEstimate": 740
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1201,
               "executionTimeMillisEstimate": 1218
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425436,
         "i": 2081
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425436,
            "i": 2081
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_FL_DATE",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1598918400000), new Date(1600214400000))"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 414,
            "executionTimeMillis": 13,
            "totalKeysExamined": 10103,
            "totalDocsExamined": 10103,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 414,
               "executionTimeMillisEstimate": 0,
               "works": 10104,
               "advanced": 414,
               "needTime": 9689,
               "needYield": 0,
               "saveState": 10,
               "restoreState": 10,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  "nReturned": 414,
                  "executionTimeMillisEstimate": 0,
                  "works": 10104,
                  "advanced": 414,
                  "needTime": 9689,
                  "needYield": 0,
                  "saveState": 10,
                  "restoreState": 10,
                  "isEOF": 1,
                  "docsExamined": 10103,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 10103,
                     "executionTimeMillisEstimate": 0,
                     "works": 10104,
                     "advanced": 10103,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 10,
                     "restoreState": 10,
                     "isEOF": 1,
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1598918400000), new Date(1600214400000))"
                        ]
                     },
                     "keysExamined": 10103,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_FL_DATE",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1598918400000), new Date(1600214400000))"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 6503,
            "executionTimeMillis": 88,
            "totalKeysExamined": 70967,
            "totalDocsExamined": 70967,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 6503,
               "executionTimeMillisEstimate": 5,
               "works": 70968,
               "advanced": 6503,
               "needTime": 64464,
               "needYield": 0,
               "saveState": 70,
               "restoreState": 70,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  "nReturned": 6503,
                  "executionTimeMillisEstimate": 5,
                  "works": 70968,
                  "advanced": 6503,
                  "needTime": 64464,
                  "needYield": 0,
                  "saveState": 70,
                  "restoreState": 70,
                  "isEOF": 1,
                  "docsExamined": 70967,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 70967,
                     "executionTimeMillisEstimate": 4,
                     "works": 70968,
                     "advanced": 70967,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 70,
                     "restoreState": 70,
                     "isEOF": 1,
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1598918400000), new Date(1600214400000))"
                        ]
                     },
                     "keysExamined": 70967,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_FL_DATE",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1598918400000), new Date(1600214400000))"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 7908,
            "executionTimeMillis": 115,
            "totalKeysExamined": 93882,
            "totalDocsExamined": 93882,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 7908,
               "executionTimeMillisEstimate": 6,
               "works": 93883,
               "advanced": 7908,
               "needTime": 85974,
               "needYield": 0,
               "saveState": 93,
               "restoreState": 93,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  "nReturned": 7908,
                  "executionTimeMillisEstimate": 6,
                  "works": 93883,
                  "advanced": 7908,
                  "needTime": 85974,
                  "needYield": 0,
                  "saveState": 93,
                  "restoreState": 93,
                  "isEOF": 1,
                  "docsExamined": 93882,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 93882,
                     "executionTimeMillisEstimate": 4,
                     "works": 93883,
                     "advanced": 93882,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 93,
                     "restoreState": 93,
                     "isEOF": 1,
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1598918400000), new Date(1600214400000))"
                        ]
                     },
                     "keysExamined": 93882,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425436,
         "i": 2081
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425436,
            "i": 2081
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345135,
                     "executionTimeMillis": 1459,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 345135,
                        "executionTimeMillisEstimate": 205,
                        "works": 345137,
                        "advanced": 345135,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 386,
                        "restoreState": 386,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345135,
                           "executionTimeMillisEstimate": 86,
                           "works": 345137,
                           "advanced": 345135,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 386,
                           "restoreState": 386,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 345135,
                              "executionTimeMillisEstimate": 20,
                              "works": 345137,
                              "advanced": 345135,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 386,
                              "restoreState": 386,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 345135,
               "executionTimeMillisEstimate": 1228
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2500,
               "executionTimeMillisEstimate": 1452
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 373770,
                     "executionTimeMillis": 1621,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 373770,
                        "executionTimeMillisEstimate": 262,
                        "works": 373772,
                        "advanced": 373770,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 418,
                        "restoreState": 418,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 373770,
                           "executionTimeMillisEstimate": 108,
                           "works": 373772,
                           "advanced": 373770,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 418,
                           "restoreState": 418,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 373770,
                              "executionTimeMillisEstimate": 20,
                              "works": 373772,
                              "advanced": 373770,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 418,
                              "restoreState": 418,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 373770,
               "executionTimeMillisEstimate": 1393
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2528,
               "executionTimeMillisEstimate": 1619
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 390514,
                     "executionTimeMillis": 1657,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 390514,
                        "executionTimeMillisEstimate": 262,
                        "works": 390516,
                        "advanced": 390514,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 436,
                        "restoreState": 436,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 390514,
                           "executionTimeMillisEstimate": 98,
                           "works": 390516,
                           "advanced": 390514,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 436,
                           "restoreState": 436,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 390514,
                              "executionTimeMillisEstimate": 16,
                              "works": 390516,
                              "advanced": 390514,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 436,
                              "restoreState": 436,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 390514,
               "executionTimeMillisEstimate": 1408
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2516,
               "executionTimeMillisEstimate": 1646
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425438,
         "i": 1394
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425438,
            "i": 1394
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345135,
                     "executionTimeMillis": 1579,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 345135,
                        "executionTimeMillisEstimate": 245,
                        "works": 345137,
                        "advanced": 345135,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 386,
                        "restoreState": 386,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345135,
                           "executionTimeMillisEstimate": 94,
                           "works": 345137,
                           "advanced": 345135,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 386,
                           "restoreState": 386,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 345135,
                              "executionTimeMillisEstimate": 11,
                              "works": 345137,
                              "advanced": 345135,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 386,
                              "restoreState": 386,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 345135,
               "executionTimeMillisEstimate": 1376
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2499,
               "executionTimeMillisEstimate": 1572
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 373770,
                     "executionTimeMillis": 1738,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 373770,
                        "executionTimeMillisEstimate": 311,
                        "works": 373772,
                        "advanced": 373770,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 418,
                        "restoreState": 418,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 373770,
                           "executionTimeMillisEstimate": 129,
                           "works": 373772,
                           "advanced": 373770,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 418,
                           "restoreState": 418,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 373770,
                              "executionTimeMillisEstimate": 18,
                              "works": 373772,
                              "advanced": 373770,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 418,
                              "restoreState": 418,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 373770,
               "executionTimeMillisEstimate": 1456
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2527,
               "executionTimeMillisEstimate": 1736
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 390514,
                     "executionTimeMillis": 1765,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 390514,
                        "executionTimeMillisEstimate": 304,
                        "works": 390516,
                        "advanced": 390514,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 436,
                        "restoreState": 436,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 390514,
                           "executionTimeMillisEstimate": 125,
                           "works": 390516,
                           "advanced": 390514,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 436,
                           "restoreState": 436,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 390514,
                              "executionTimeMillisEstimate": 38,
                              "works": 390516,
                              "advanced": 390514,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 436,
                              "restoreState": 436,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 390514,
               "executionTimeMillisEstimate": 1534
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2515,
               "executionTimeMillisEstimate": 1758
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425440,
         "i": 1711
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425440,
            "i": 1711
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345135,
                     "executionTimeMillis": 832,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 345135,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345135,
                        "executionTimeMillisEstimate": 60,
                        "works": 345137,
                        "advanced": 345135,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 358,
                        "restoreState": 358,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345135,
                           "executionTimeMillisEstimate": 51,
                           "works": 345137,
                           "advanced": 345135,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 358,
                           "restoreState": 358,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 345135,
                              "executionTimeMillisEstimate": 17,
                              "works": 345137,
                              "advanced": 345135,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 358,
                              "restoreState": 358,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 345135
                           }
                        }
                     }
                  }
               },
               "nReturned": 345135,
               "executionTimeMillisEstimate": 648
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 823
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 373770,
                     "executionTimeMillis": 929,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 373770,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 373770,
                        "executionTimeMillisEstimate": 68,
                        "works": 373772,
                        "advanced": 373770,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 388,
                        "restoreState": 388,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 373770,
                           "executionTimeMillisEstimate": 55,
                           "works": 373772,
                           "advanced": 373770,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 388,
                           "restoreState": 388,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 373770,
                              "executionTimeMillisEstimate": 10,
                              "works": 373772,
                              "advanced": 373770,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 388,
                              "restoreState": 388,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 373770
                           }
                        }
                     }
                  }
               },
               "nReturned": 373770,
               "executionTimeMillisEstimate": 714
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 923
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 390514,
                     "executionTimeMillis": 937,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 390514,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 390514,
                        "executionTimeMillisEstimate": 70,
                        "works": 390516,
                        "advanced": 390514,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 405,
                        "restoreState": 405,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 390514,
                           "executionTimeMillisEstimate": 63,
                           "works": 390516,
                           "advanced": 390514,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 405,
                           "restoreState": 405,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 390514,
                              "executionTimeMillisEstimate": 10,
                              "works": 390516,
                              "advanced": 390514,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 405,
                              "restoreState": 405,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 390514
                           }
                        }
                     }
                  }
               },
               "nReturned": 390514,
               "executionTimeMillisEstimate": 753
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 936
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425441,
         "i": 2
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425441,
            "i": 2
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "84894ADE",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 48202,
                     "executionTimeMillis": 169,
                     "totalKeysExamined": 48202,
                     "totalDocsExamined": 48202,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 48202,
                        "executionTimeMillisEstimate": 25,
                        "works": 48203,
                        "advanced": 48202,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 50,
                        "restoreState": 50,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 48202,
                           "executionTimeMillisEstimate": 25,
                           "works": 48203,
                           "advanced": 48202,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 50,
                           "restoreState": 50,
                           "isEOF": 1,
                           "docsExamined": 48202,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 48202,
                              "executionTimeMillisEstimate": 20,
                              "works": 48203,
                              "advanced": 48202,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 50,
                              "restoreState": 50,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 48202,
                                 "executionTimeMillisEstimate": 6,
                                 "works": 48203,
                                 "advanced": 48202,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 50,
                                 "restoreState": 50,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 },
                                 "keysExamined": 48202,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 48202,
               "executionTimeMillisEstimate": 140
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 359,
               "executionTimeMillisEstimate": 163
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "84894ADE",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 46468,
                     "executionTimeMillis": 171,
                     "totalKeysExamined": 46468,
                     "totalDocsExamined": 46468,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 46468,
                        "executionTimeMillisEstimate": 30,
                        "works": 46469,
                        "advanced": 46468,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 48,
                        "restoreState": 48,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 46468,
                           "executionTimeMillisEstimate": 26,
                           "works": 46469,
                           "advanced": 46468,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 48,
                           "restoreState": 48,
                           "isEOF": 1,
                           "docsExamined": 46468,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 46468,
                              "executionTimeMillisEstimate": 20,
                              "works": 46469,
                              "advanced": 46468,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 48,
                              "restoreState": 48,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 46468,
                                 "executionTimeMillisEstimate": 7,
                                 "works": 46469,
                                 "advanced": 46468,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 48,
                                 "restoreState": 48,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 },
                                 "keysExamined": 46468,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 46468,
               "executionTimeMillisEstimate": 139
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 356,
               "executionTimeMillisEstimate": 165
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "84894ADE",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 87983,
                     "executionTimeMillis": 322,
                     "totalKeysExamined": 87983,
                     "totalDocsExamined": 87983,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 87983,
                        "executionTimeMillisEstimate": 39,
                        "works": 87984,
                        "advanced": 87983,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 91,
                        "restoreState": 91,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 87983,
                           "executionTimeMillisEstimate": 38,
                           "works": 87984,
                           "advanced": 87983,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 91,
                           "restoreState": 91,
                           "isEOF": 1,
                           "docsExamined": 87983,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 87983,
                              "executionTimeMillisEstimate": 29,
                              "works": 87984,
                              "advanced": 87983,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 91,
                              "restoreState": 91,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 87983,
                                 "executionTimeMillisEstimate": 7,
                                 "works": 87984,
                                 "advanced": 87983,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 91,
                                 "restoreState": 91,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 },
                                 "keysExamined": 87983,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 87983,
               "executionTimeMillisEstimate": 267
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 321
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425441,
         "i": 15
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425441,
            "i": 15
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "5222333C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 46468,
                     "executionTimeMillis": 177,
                     "totalKeysExamined": 46468,
                     "totalDocsExamined": 46468,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 46468,
                        "executionTimeMillisEstimate": 38,
                        "works": 46469,
                        "advanced": 46468,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 48,
                        "restoreState": 48,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 46468,
                           "executionTimeMillisEstimate": 35,
                           "works": 46469,
                           "advanced": 46468,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 48,
                           "restoreState": 48,
                           "isEOF": 1,
                           "docsExamined": 46468,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 46468,
                              "executionTimeMillisEstimate": 31,
                              "works": 46469,
                              "advanced": 46468,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 48,
                              "restoreState": 48,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 46468,
                                 "executionTimeMillisEstimate": 4,
                                 "works": 46469,
                                 "advanced": 46468,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 48,
                                 "restoreState": 48,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 },
                                 "keysExamined": 46468,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 46468,
               "executionTimeMillisEstimate": 147
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 356,
               "executionTimeMillisEstimate": 175
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "5222333C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 48202,
                     "executionTimeMillis": 176,
                     "totalKeysExamined": 48202,
                     "totalDocsExamined": 48202,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 48202,
                        "executionTimeMillisEstimate": 24,
                        "works": 48203,
                        "advanced": 48202,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 50,
                        "restoreState": 50,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 48202,
                           "executionTimeMillisEstimate": 17,
                           "works": 48203,
                           "advanced": 48202,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 50,
                           "restoreState": 50,
                           "isEOF": 1,
                           "docsExamined": 48202,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 48202,
                              "executionTimeMillisEstimate": 11,
                              "works": 48203,
                              "advanced": 48202,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 50,
                              "restoreState": 50,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 48202,
                                 "executionTimeMillisEstimate": 4,
                                 "works": 48203,
                                 "advanced": 48202,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 50,
                                 "restoreState": 50,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 },
                                 "keysExamined": 48202,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 48202,
               "executionTimeMillisEstimate": 151
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 359,
               "executionTimeMillisEstimate": 171
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "5222333C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 87983,
                     "executionTimeMillis": 326,
                     "totalKeysExamined": 87983,
                     "totalDocsExamined": 87983,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 87983,
                        "executionTimeMillisEstimate": 74,
                        "works": 87984,
                        "advanced": 87983,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 92,
                        "restoreState": 92,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 87983,
                           "executionTimeMillisEstimate": 67,
                           "works": 87984,
                           "advanced": 87983,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 92,
                           "restoreState": 92,
                           "isEOF": 1,
                           "docsExamined": 87983,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 87983,
                              "executionTimeMillisEstimate": 43,
                              "works": 87984,
                              "advanced": 87983,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 92,
                              "restoreState": 92,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 87983,
                                 "executionTimeMillisEstimate": 14,
                                 "works": 87984,
                                 "advanced": 87983,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 92,
                                 "restoreState": 92,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 },
                                 "keysExamined": 87983,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 87983,
               "executionTimeMillisEstimate": 279
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 321
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425442,
         "i": 1659
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425442,
            "i": 1659
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_FL_DATE_range<a name="AirlineData_FL_DATE_range"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "splitPipeline": null,
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_FL_DATE_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1601510400000), new Date(1601510400000)]"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 2,
            "executionTimeMillis": 26,
            "totalKeysExamined": 12530,
            "totalDocsExamined": 12530,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 2,
               "executionTimeMillisEstimate": 4,
               "works": 12531,
               "advanced": 2,
               "needTime": 12528,
               "needYield": 0,
               "saveState": 12,
               "restoreState": 12,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  },
                  "nReturned": 2,
                  "executionTimeMillisEstimate": 4,
                  "works": 12531,
                  "advanced": 2,
                  "needTime": 12528,
                  "needYield": 0,
                  "saveState": 12,
                  "restoreState": 12,
                  "isEOF": 1,
                  "docsExamined": 12530,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 12530,
                     "executionTimeMillisEstimate": 0,
                     "works": 12531,
                     "advanced": 12530,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 12,
                     "restoreState": 12,
                     "isEOF": 1,
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1601510400000), new Date(1601510400000)]"
                        ]
                     },
                     "keysExamined": 12530,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425442,
         "i": 1651
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425442,
            "i": 1659
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 3713,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 563,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1166,
                        "restoreState": 1166,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 475,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1166,
                           "restoreState": 1166,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 311,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1166,
                              "restoreState": 1166,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 2924
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 3711
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425445,
         "i": 2550
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425445,
            "i": 2556
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 2704,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 193,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1150,
                        "restoreState": 1150,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 149,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1150,
                           "restoreState": 1150,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 44,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1150,
                              "restoreState": 1150,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 1964
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 2698
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425448,
         "i": 2531
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425448,
            "i": 2531
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 2608,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 195,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1169,
                        "restoreState": 1169,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 152,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1169,
                           "restoreState": 1169,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 44,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1169,
                              "restoreState": 1169,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 1890
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 2604
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425451,
         "i": 2699
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425451,
            "i": 2699
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 215515,
                     "executionTimeMillis": 997,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 215515,
                        "executionTimeMillisEstimate": 38,
                        "works": 1109421,
                        "advanced": 215515,
                        "needTime": 893905,
                        "needYield": 0,
                        "saveState": 1119,
                        "restoreState": 1119,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 215515,
                           "executionTimeMillisEstimate": 34,
                           "works": 1109421,
                           "advanced": 215515,
                           "needTime": 893905,
                           "needYield": 0,
                           "saveState": 1119,
                           "restoreState": 1119,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 215515,
                              "executionTimeMillisEstimate": 20,
                              "works": 1109421,
                              "advanced": 215515,
                              "needTime": 893905,
                              "needYield": 0,
                              "saveState": 1119,
                              "restoreState": 1119,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 215515,
               "executionTimeMillisEstimate": 830
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 369,
               "executionTimeMillisEstimate": 991
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425451,
         "i": 2707
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425451,
            "i": 2707
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 215515,
                     "executionTimeMillis": 982,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 215515,
                        "executionTimeMillisEstimate": 57,
                        "works": 1109421,
                        "advanced": 215515,
                        "needTime": 893905,
                        "needYield": 0,
                        "saveState": 1118,
                        "restoreState": 1118,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 215515,
                           "executionTimeMillisEstimate": 48,
                           "works": 1109421,
                           "advanced": 215515,
                           "needTime": 893905,
                           "needYield": 0,
                           "saveState": 1118,
                           "restoreState": 1118,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 215515,
                              "executionTimeMillisEstimate": 39,
                              "works": 1109421,
                              "advanced": 215515,
                              "needTime": 893905,
                              "needYield": 0,
                              "saveState": 1118,
                              "restoreState": 1118,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 215515,
               "executionTimeMillisEstimate": 829
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 368,
               "executionTimeMillisEstimate": 980
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425452,
         "i": 1190
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425452,
            "i": 1198
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 215515,
                     "executionTimeMillis": 980,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 215515,
                        "executionTimeMillisEstimate": 50,
                        "works": 1109421,
                        "advanced": 215515,
                        "needTime": 893905,
                        "needYield": 0,
                        "saveState": 1122,
                        "restoreState": 1122,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 215515,
                           "executionTimeMillisEstimate": 41,
                           "works": 1109421,
                           "advanced": 215515,
                           "needTime": 893905,
                           "needYield": 0,
                           "saveState": 1122,
                           "restoreState": 1122,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 215515,
                              "executionTimeMillisEstimate": 26,
                              "works": 1109421,
                              "advanced": 215515,
                              "needTime": 893905,
                              "needYield": 0,
                              "saveState": 1122,
                              "restoreState": 1122,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 215515,
               "executionTimeMillisEstimate": 838
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 972
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425454,
         "i": 6
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425454,
            "i": 13
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "splitPipeline": null,
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "1A8468AA",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345294,
                     "executionTimeMillis": 1237,
                     "totalKeysExamined": 345294,
                     "totalDocsExamined": 345294,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345294,
                        "executionTimeMillisEstimate": 179,
                        "works": 345295,
                        "advanced": 345294,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 359,
                        "restoreState": 359,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 345294,
                           "executionTimeMillisEstimate": 160,
                           "works": 345295,
                           "advanced": 345294,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 359,
                           "restoreState": 359,
                           "isEOF": 1,
                           "docsExamined": 345294,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 345294,
                              "executionTimeMillisEstimate": 133,
                              "works": 345295,
                              "advanced": 345294,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 359,
                              "restoreState": 359,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 345294,
                                 "executionTimeMillisEstimate": 64,
                                 "works": 345295,
                                 "advanced": 345294,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 359,
                                 "restoreState": 359,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 345294,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 345294,
               "executionTimeMillisEstimate": 994
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 1231
            },
            {
               "$sort": {
                  "sortKey": {
                     "avgDelay": -1
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 1231
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425454,
         "i": 1278
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425454,
            "i": 1286
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "splitPipeline": null,
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "69F098DA",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345294,
                     "executionTimeMillis": 1114,
                     "totalKeysExamined": 345294,
                     "totalDocsExamined": 345294,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345294,
                        "executionTimeMillisEstimate": 138,
                        "works": 345295,
                        "advanced": 345294,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 364,
                        "restoreState": 364,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 345294,
                           "executionTimeMillisEstimate": 119,
                           "works": 345295,
                           "advanced": 345294,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 364,
                           "restoreState": 364,
                           "isEOF": 1,
                           "docsExamined": 345294,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 345294,
                              "executionTimeMillisEstimate": 82,
                              "works": 345295,
                              "advanced": 345294,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 364,
                              "restoreState": 364,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 345294,
                                 "executionTimeMillisEstimate": 20,
                                 "works": 345295,
                                 "advanced": 345294,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 364,
                                 "restoreState": 364,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 345294,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 345294,
               "executionTimeMillisEstimate": 877
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 1111
            },
            {
               "$sort": {
                  "sortKey": {
                     "avgDelay": -1
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 1111
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425456,
         "i": 876
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425456,
            "i": 876
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "splitPipeline": null,
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "09C17B7B",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345294,
                     "executionTimeMillis": 1120,
                     "totalKeysExamined": 345294,
                     "totalDocsExamined": 345294,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345294,
                        "executionTimeMillisEstimate": 150,
                        "works": 345295,
                        "advanced": 345294,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 363,
                        "restoreState": 363,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 345294,
                           "executionTimeMillisEstimate": 133,
                           "works": 345295,
                           "advanced": 345294,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 363,
                           "restoreState": 363,
                           "isEOF": 1,
                           "docsExamined": 345294,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 345294,
                              "executionTimeMillisEstimate": 98,
                              "works": 345295,
                              "advanced": 345294,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 363,
                              "restoreState": 363,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 345294,
                                 "executionTimeMillisEstimate": 38,
                                 "works": 345295,
                                 "advanced": 345294,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 363,
                                 "restoreState": 363,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1598918400000), new Date(1601510400000))"
                                    ]
                                 },
                                 "keysExamined": 345294,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 345294,
               "executionTimeMillisEstimate": 888
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1116
            },
            {
               "$sort": {
                  "sortKey": {
                     "avgDelay": -1
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1116
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425457,
         "i": 360
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425457,
            "i": 368
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 3306,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 207,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1164,
                        "restoreState": 1164,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 151,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1164,
                           "restoreState": 1164,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 37,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1164,
                              "restoreState": 1164,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 1916
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1203,
               "executionTimeMillisEstimate": 3302
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425460,
         "i": 29
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425460,
            "i": 38
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 3467,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 245,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1192,
                        "restoreState": 1192,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 171,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1192,
                           "restoreState": 1192,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 46,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1192,
                              "restoreState": 1192,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 2074
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1203,
               "executionTimeMillisEstimate": 3460
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425464,
         "i": 13
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425464,
            "i": 20
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "splitPipeline": null,
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_FL_DATE_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  "inputStage": {
                     "stage": "IXSCAN",
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1598918400000), new Date(1600214400000))"
                        ]
                     }
                  }
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 14825,
            "executionTimeMillis": 209,
            "totalKeysExamined": 174952,
            "totalDocsExamined": 174952,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 14825,
               "executionTimeMillisEstimate": 12,
               "works": 174953,
               "advanced": 14825,
               "needTime": 160127,
               "needYield": 0,
               "saveState": 174,
               "restoreState": 174,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "FETCH",
                  "filter": {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  "nReturned": 14825,
                  "executionTimeMillisEstimate": 11,
                  "works": 174953,
                  "advanced": 14825,
                  "needTime": 160127,
                  "needYield": 0,
                  "saveState": 174,
                  "restoreState": 174,
                  "isEOF": 1,
                  "docsExamined": 174952,
                  "alreadyHasObj": 0,
                  "inputStage": {
                     "stage": "IXSCAN",
                     "nReturned": 174952,
                     "executionTimeMillisEstimate": 5,
                     "works": 174953,
                     "advanced": 174952,
                     "needTime": 0,
                     "needYield": 0,
                     "saveState": 174,
                     "restoreState": 174,
                     "isEOF": 1,
                     "keyPattern": {
                        "FL_DATE": 1
                     },
                     "indexName": "FL_DATE_1",
                     "isMultiKey": false,
                     "multiKeyPaths": {
                        "FL_DATE": []
                     },
                     "isUnique": false,
                     "isSparse": false,
                     "isPartial": false,
                     "indexVersion": 2,
                     "direction": "forward",
                     "indexBounds": {
                        "FL_DATE": [
                           "[new Date(1598918400000), new Date(1600214400000))"
                        ]
                     },
                     "keysExamined": 174952,
                     "seeks": 1,
                     "dupsTested": 0,
                     "dupsDropped": 0
                  }
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425464,
         "i": 13
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425464,
            "i": 20
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 4399,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 642,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1240,
                        "restoreState": 1240,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 235,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1240,
                           "restoreState": 1240,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 58,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1240,
                              "restoreState": 1240,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 3678
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2552,
               "executionTimeMillisEstimate": 4397
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425468,
         "i": 6
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425469,
            "i": 9
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 4472,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 669,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1240,
                        "restoreState": 1240,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 249,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1240,
                           "restoreState": 1240,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 72,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1240,
                              "restoreState": 1240,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 3744
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2551,
               "executionTimeMillisEstimate": 4469
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425472,
         "i": 2411
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425473,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 2285,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 169,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1151,
                        "restoreState": 1151,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 136,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1151,
                           "restoreState": 1151,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 34,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1151,
                              "restoreState": 1151,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 1702
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2277
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425475,
         "i": 2227
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425475,
            "i": 2227
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "splitPipeline": null,
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "6CA788BB",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 182653,
                     "executionTimeMillis": 548,
                     "totalKeysExamined": 182653,
                     "totalDocsExamined": 182653,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 182653,
                        "executionTimeMillisEstimate": 48,
                        "works": 182654,
                        "advanced": 182653,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 189,
                        "restoreState": 189,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 182653,
                           "executionTimeMillisEstimate": 46,
                           "works": 182654,
                           "advanced": 182653,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 189,
                           "restoreState": 189,
                           "isEOF": 1,
                           "docsExamined": 182653,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 182653,
                              "executionTimeMillisEstimate": 27,
                              "works": 182654,
                              "advanced": 182653,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 189,
                              "restoreState": 189,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 182653,
                                 "executionTimeMillisEstimate": 6,
                                 "works": 182654,
                                 "advanced": 182653,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 189,
                                 "restoreState": 189,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 },
                                 "keysExamined": 182653,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 182653,
               "executionTimeMillisEstimate": 458
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 546
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425476,
         "i": 1663
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425476,
            "i": 1663
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "splitPipeline": null,
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_FL_DATE_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "C7744E80",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 }
                              }
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 182653,
                     "executionTimeMillis": 587,
                     "totalKeysExamined": 182653,
                     "totalDocsExamined": 182653,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 182653,
                        "executionTimeMillisEstimate": 81,
                        "works": 182654,
                        "advanced": 182653,
                        "needTime": 0,
                        "needYield": 0,
                        "saveState": 191,
                        "restoreState": 191,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "FETCH",
                           "nReturned": 182653,
                           "executionTimeMillisEstimate": 63,
                           "works": 182654,
                           "advanced": 182653,
                           "needTime": 0,
                           "needYield": 0,
                           "saveState": 191,
                           "restoreState": 191,
                           "isEOF": 1,
                           "docsExamined": 182653,
                           "alreadyHasObj": 0,
                           "inputStage": {
                              "stage": "SHARDING_FILTER",
                              "nReturned": 182653,
                              "executionTimeMillisEstimate": 49,
                              "works": 182654,
                              "advanced": 182653,
                              "needTime": 0,
                              "needYield": 0,
                              "saveState": 191,
                              "restoreState": 191,
                              "isEOF": 1,
                              "chunkSkips": 0,
                              "inputStage": {
                                 "stage": "IXSCAN",
                                 "nReturned": 182653,
                                 "executionTimeMillisEstimate": 18,
                                 "works": 182654,
                                 "advanced": 182653,
                                 "needTime": 0,
                                 "needYield": 0,
                                 "saveState": 191,
                                 "restoreState": 191,
                                 "isEOF": 1,
                                 "keyPattern": {
                                    "FL_DATE": 1
                                 },
                                 "indexName": "FL_DATE_1",
                                 "isMultiKey": false,
                                 "multiKeyPaths": {
                                    "FL_DATE": []
                                 },
                                 "isUnique": false,
                                 "isSparse": false,
                                 "isPartial": false,
                                 "indexVersion": 2,
                                 "direction": "forward",
                                 "indexBounds": {
                                    "FL_DATE": [
                                       "[new Date(1601510400000), new Date(1602806400000))"
                                    ]
                                 },
                                 "keysExamined": 182653,
                                 "seeks": 1,
                                 "dupsTested": 0,
                                 "dupsDropped": 0
                              }
                           }
                        }
                     }
                  }
               },
               "nReturned": 182653,
               "executionTimeMillisEstimate": 489
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 586
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425476,
         "i": 1664
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425476,
            "i": 1664
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_MKT_UNIQUE_CARRIER<a name="AirlineData_MKT_UNIQUE_CARRIER"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 14,
            "totalKeysExamined": 0,
            "totalDocsExamined": 18993,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 2,
               "works": 18995,
               "advanced": 1,
               "needTime": 18993,
               "needYield": 0,
               "saveState": 18,
               "restoreState": 18,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 2,
                  "works": 18995,
                  "advanced": 1,
                  "needTime": 18993,
                  "needYield": 0,
                  "saveState": 18,
                  "restoreState": 18,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 18993
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 505,
            "totalKeysExamined": 0,
            "totalDocsExamined": 581745,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 54,
               "works": 581747,
               "advanced": 1,
               "needTime": 581745,
               "needYield": 0,
               "saveState": 581,
               "restoreState": 581,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 53,
                  "works": 581747,
                  "advanced": 1,
                  "needTime": 581745,
                  "needYield": 0,
                  "saveState": 581,
                  "restoreState": 581,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 581745
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 598,
            "totalKeysExamined": 0,
            "totalDocsExamined": 508681,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 83,
               "works": 508683,
               "advanced": 0,
               "needTime": 508682,
               "needYield": 0,
               "saveState": 508,
               "restoreState": 508,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 83,
                  "works": 508683,
                  "advanced": 0,
                  "needTime": 508682,
                  "needYield": 0,
                  "saveState": 508,
                  "restoreState": 508,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 508681
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425477,
         "i": 1024
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425477,
            "i": 1025
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 18993,
                     "executionTimeMillis": 60,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 18993,
                        "executionTimeMillisEstimate": 6,
                        "works": 18995,
                        "advanced": 18993,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 18993,
                           "executionTimeMillisEstimate": 3,
                           "works": 18995,
                           "advanced": 18993,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 18993,
                              "executionTimeMillisEstimate": 2,
                              "works": 18995,
                              "advanced": 18993,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 18993,
               "executionTimeMillisEstimate": 45
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 1,
               "executionTimeMillisEstimate": 50
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 508681,
                     "executionTimeMillis": 1303,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 508681,
                        "executionTimeMillisEstimate": 103,
                        "works": 508683,
                        "advanced": 508681,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 534,
                        "restoreState": 534,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 508681,
                           "executionTimeMillisEstimate": 84,
                           "works": 508683,
                           "advanced": 508681,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 534,
                           "restoreState": 534,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 508681,
                              "executionTimeMillisEstimate": 21,
                              "works": 508683,
                              "advanced": 508681,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 534,
                              "restoreState": 534,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 508681,
               "executionTimeMillisEstimate": 996
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 4,
               "executionTimeMillisEstimate": 1302
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 581745,
                     "executionTimeMillis": 1409,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 581745,
                        "executionTimeMillisEstimate": 97,
                        "works": 581747,
                        "advanced": 581745,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 612,
                        "restoreState": 612,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 581745,
                           "executionTimeMillisEstimate": 76,
                           "works": 581747,
                           "advanced": 581745,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 612,
                           "restoreState": 612,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 581745,
                              "executionTimeMillisEstimate": 15,
                              "works": 581747,
                              "advanced": 581745,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 612,
                              "restoreState": 612,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 581745,
               "executionTimeMillisEstimate": 1106
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 5,
               "executionTimeMillisEstimate": 1403
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425479,
         "i": 2
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425479,
            "i": 10
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 18993,
                     "executionTimeMillis": 47,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 18993,
                        "executionTimeMillisEstimate": 7,
                        "works": 18995,
                        "advanced": 18993,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 18993,
                           "executionTimeMillisEstimate": 4,
                           "works": 18995,
                           "advanced": 18993,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 18993,
                              "executionTimeMillisEstimate": 2,
                              "works": 18995,
                              "advanced": 18993,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 18993,
               "executionTimeMillisEstimate": 32
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 121,
               "executionTimeMillisEstimate": 47
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 508681,
                     "executionTimeMillis": 1268,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 508681,
                        "executionTimeMillisEstimate": 90,
                        "works": 508683,
                        "advanced": 508681,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 528,
                        "restoreState": 528,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 508681,
                           "executionTimeMillisEstimate": 67,
                           "works": 508683,
                           "advanced": 508681,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 528,
                           "restoreState": 528,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 508681,
                              "executionTimeMillisEstimate": 12,
                              "works": 508683,
                              "advanced": 508681,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 528,
                              "restoreState": 528,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 508681,
               "executionTimeMillisEstimate": 944
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 296,
               "executionTimeMillisEstimate": 1262
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 581745,
                     "executionTimeMillis": 1394,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 581745,
                        "executionTimeMillisEstimate": 82,
                        "works": 581747,
                        "advanced": 581745,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 603,
                        "restoreState": 603,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 581745,
                           "executionTimeMillisEstimate": 61,
                           "works": 581747,
                           "advanced": 581745,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 603,
                           "restoreState": 603,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 581745,
                              "executionTimeMillisEstimate": 15,
                              "works": 581747,
                              "advanced": 581745,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 603,
                              "restoreState": 603,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 581745,
               "executionTimeMillisEstimate": 1096
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 248,
               "executionTimeMillisEstimate": 1382
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425479,
         "i": 37
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425479,
            "i": 38
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 18993,
                     "executionTimeMillis": 60,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 18993,
                        "executionTimeMillisEstimate": 6,
                        "works": 18995,
                        "advanced": 18993,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 18993,
                           "executionTimeMillisEstimate": 6,
                           "works": 18995,
                           "advanced": 18993,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 18993,
                              "executionTimeMillisEstimate": 2,
                              "works": 18995,
                              "advanced": 18993,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 18993,
               "executionTimeMillisEstimate": 44
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 121,
               "executionTimeMillisEstimate": 55
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 508681,
                     "executionTimeMillis": 1278,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 508681,
                        "executionTimeMillisEstimate": 112,
                        "works": 508683,
                        "advanced": 508681,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 536,
                        "restoreState": 536,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 508681,
                           "executionTimeMillisEstimate": 78,
                           "works": 508683,
                           "advanced": 508681,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 536,
                           "restoreState": 536,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 508681,
                              "executionTimeMillisEstimate": 22,
                              "works": 508683,
                              "advanced": 508681,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 536,
                              "restoreState": 536,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 508681,
               "executionTimeMillisEstimate": 1000
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 296,
               "executionTimeMillisEstimate": 1271
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 581745,
                     "executionTimeMillis": 1409,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 581745,
                        "executionTimeMillisEstimate": 108,
                        "works": 581747,
                        "advanced": 581745,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 613,
                        "restoreState": 613,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 581745,
                           "executionTimeMillisEstimate": 83,
                           "works": 581747,
                           "advanced": 581745,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 613,
                           "restoreState": 613,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 581745,
                              "executionTimeMillisEstimate": 21,
                              "works": 581747,
                              "advanced": 581745,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 613,
                              "restoreState": 613,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 581745,
               "executionTimeMillisEstimate": 1104
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 248,
               "executionTimeMillisEstimate": 1406
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425481,
         "i": 4
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425481,
            "i": 7
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 5159,
                     "executionTimeMillis": 21,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 5159,
                        "executionTimeMillisEstimate": 0,
                        "works": 18995,
                        "advanced": 5159,
                        "needTime": 13835,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 5159,
                           "executionTimeMillisEstimate": 0,
                           "works": 18995,
                           "advanced": 5159,
                           "needTime": 13835,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 5159,
                              "executionTimeMillisEstimate": 0,
                              "works": 18995,
                              "advanced": 5159,
                              "needTime": 13835,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 5159,
               "executionTimeMillisEstimate": 16
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 120,
               "executionTimeMillisEstimate": 21
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 96851,
                     "executionTimeMillis": 491,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 96851,
                        "executionTimeMillisEstimate": 20,
                        "works": 581747,
                        "advanced": 96851,
                        "needTime": 484895,
                        "needYield": 0,
                        "saveState": 587,
                        "restoreState": 587,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 96851,
                           "executionTimeMillisEstimate": 17,
                           "works": 581747,
                           "advanced": 96851,
                           "needTime": 484895,
                           "needYield": 0,
                           "saveState": 587,
                           "restoreState": 587,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 96851,
                              "executionTimeMillisEstimate": 12,
                              "works": 581747,
                              "advanced": 96851,
                              "needTime": 484895,
                              "needYield": 0,
                              "saveState": 587,
                              "restoreState": 587,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 96851,
               "executionTimeMillisEstimate": 435
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 246,
               "executionTimeMillisEstimate": 488
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 113505,
                     "executionTimeMillis": 499,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 113505,
                        "executionTimeMillisEstimate": 25,
                        "works": 508683,
                        "advanced": 113505,
                        "needTime": 395177,
                        "needYield": 0,
                        "saveState": 513,
                        "restoreState": 513,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 113505,
                           "executionTimeMillisEstimate": 24,
                           "works": 508683,
                           "advanced": 113505,
                           "needTime": 395177,
                           "needYield": 0,
                           "saveState": 513,
                           "restoreState": 513,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 113505,
                              "executionTimeMillisEstimate": 12,
                              "works": 508683,
                              "advanced": 113505,
                              "needTime": 395177,
                              "needYield": 0,
                              "saveState": 513,
                              "restoreState": 513,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 113505,
               "executionTimeMillisEstimate": 419
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 295,
               "executionTimeMillisEstimate": 492
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425481,
         "i": 4
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425482,
            "i": 2
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 5159,
                     "executionTimeMillis": 30,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 5159,
                        "executionTimeMillisEstimate": 3,
                        "works": 18995,
                        "advanced": 5159,
                        "needTime": 13835,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 5159,
                           "executionTimeMillisEstimate": 3,
                           "works": 18995,
                           "advanced": 5159,
                           "needTime": 13835,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 5159,
                              "executionTimeMillisEstimate": 1,
                              "works": 18995,
                              "advanced": 5159,
                              "needTime": 13835,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 5159,
               "executionTimeMillisEstimate": 25
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 119,
               "executionTimeMillisEstimate": 25
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 96851,
                     "executionTimeMillis": 509,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 96851,
                        "executionTimeMillisEstimate": 53,
                        "works": 581747,
                        "advanced": 96851,
                        "needTime": 484895,
                        "needYield": 0,
                        "saveState": 586,
                        "restoreState": 586,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 96851,
                           "executionTimeMillisEstimate": 49,
                           "works": 581747,
                           "advanced": 96851,
                           "needTime": 484895,
                           "needYield": 0,
                           "saveState": 586,
                           "restoreState": 586,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 96851,
                              "executionTimeMillisEstimate": 28,
                              "works": 581747,
                              "advanced": 96851,
                              "needTime": 484895,
                              "needYield": 0,
                              "saveState": 586,
                              "restoreState": 586,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 96851,
               "executionTimeMillisEstimate": 455
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 246,
               "executionTimeMillisEstimate": 506
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 113505,
                     "executionTimeMillis": 517,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 113505,
                        "executionTimeMillisEstimate": 40,
                        "works": 508683,
                        "advanced": 113505,
                        "needTime": 395177,
                        "needYield": 0,
                        "saveState": 513,
                        "restoreState": 513,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 113505,
                           "executionTimeMillisEstimate": 34,
                           "works": 508683,
                           "advanced": 113505,
                           "needTime": 395177,
                           "needYield": 0,
                           "saveState": 513,
                           "restoreState": 513,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 113505,
                              "executionTimeMillisEstimate": 25,
                              "works": 508683,
                              "advanced": 113505,
                              "needTime": 395177,
                              "needYield": 0,
                              "saveState": 513,
                              "restoreState": 513,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 113505,
               "executionTimeMillisEstimate": 435
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 294,
               "executionTimeMillisEstimate": 506
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425482,
         "i": 37
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425482,
            "i": 37
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 5159,
                     "executionTimeMillis": 20,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 5159,
                        "executionTimeMillisEstimate": 0,
                        "works": 18995,
                        "advanced": 5159,
                        "needTime": 13835,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 5159,
                           "executionTimeMillisEstimate": 0,
                           "works": 18995,
                           "advanced": 5159,
                           "needTime": 13835,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 5159,
                              "executionTimeMillisEstimate": 0,
                              "works": 18995,
                              "advanced": 5159,
                              "needTime": 13835,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 5159,
               "executionTimeMillisEstimate": 16
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1,
               "executionTimeMillisEstimate": 16
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 96851,
                     "executionTimeMillis": 492,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 96851,
                        "executionTimeMillisEstimate": 11,
                        "works": 581747,
                        "advanced": 96851,
                        "needTime": 484895,
                        "needYield": 0,
                        "saveState": 586,
                        "restoreState": 586,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 96851,
                           "executionTimeMillisEstimate": 10,
                           "works": 581747,
                           "advanced": 96851,
                           "needTime": 484895,
                           "needYield": 0,
                           "saveState": 586,
                           "restoreState": 586,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 96851,
                              "executionTimeMillisEstimate": 6,
                              "works": 581747,
                              "advanced": 96851,
                              "needTime": 484895,
                              "needYield": 0,
                              "saveState": 586,
                              "restoreState": 586,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 96851,
               "executionTimeMillisEstimate": 447
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 5,
               "executionTimeMillisEstimate": 491
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 113505,
                     "executionTimeMillis": 500,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 113505,
                        "executionTimeMillisEstimate": 19,
                        "works": 508683,
                        "advanced": 113505,
                        "needTime": 395177,
                        "needYield": 0,
                        "saveState": 513,
                        "restoreState": 513,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 113505,
                           "executionTimeMillisEstimate": 17,
                           "works": 508683,
                           "advanced": 113505,
                           "needTime": 395177,
                           "needYield": 0,
                           "saveState": 513,
                           "restoreState": 513,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 113505,
                              "executionTimeMillisEstimate": 11,
                              "works": 508683,
                              "advanced": 113505,
                              "needTime": 395177,
                              "needYield": 0,
                              "saveState": 513,
                              "restoreState": 513,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 113505,
               "executionTimeMillisEstimate": 433
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 4,
               "executionTimeMillisEstimate": 497
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425482,
         "i": 37
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425483,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 4917,
                     "executionTimeMillis": 30,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 4917,
                        "executionTimeMillisEstimate": 1,
                        "works": 18995,
                        "advanced": 4917,
                        "needTime": 14077,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 4917,
                           "executionTimeMillisEstimate": 1,
                           "works": 18995,
                           "advanced": 4917,
                           "needTime": 14077,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 4917,
                              "executionTimeMillisEstimate": 1,
                              "works": 18995,
                              "advanced": 4917,
                              "needTime": 14077,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 4917,
               "executionTimeMillisEstimate": 25
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 118,
               "executionTimeMillisEstimate": 25
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 157947,
                     "executionTimeMillis": 614,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 157947,
                        "executionTimeMillisEstimate": 57,
                        "works": 508683,
                        "advanced": 157947,
                        "needTime": 350735,
                        "needYield": 0,
                        "saveState": 515,
                        "restoreState": 515,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 157947,
                           "executionTimeMillisEstimate": 43,
                           "works": 508683,
                           "advanced": 157947,
                           "needTime": 350735,
                           "needYield": 0,
                           "saveState": 515,
                           "restoreState": 515,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 157947,
                              "executionTimeMillisEstimate": 26,
                              "works": 508683,
                              "advanced": 157947,
                              "needTime": 350735,
                              "needYield": 0,
                              "saveState": 515,
                              "restoreState": 515,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 157947,
               "executionTimeMillisEstimate": 512
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 291,
               "executionTimeMillisEstimate": 611
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 182430,
                     "executionTimeMillis": 683,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 182430,
                        "executionTimeMillisEstimate": 58,
                        "works": 581747,
                        "advanced": 182430,
                        "needTime": 399316,
                        "needYield": 0,
                        "saveState": 588,
                        "restoreState": 588,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 182430,
                           "executionTimeMillisEstimate": 44,
                           "works": 581747,
                           "advanced": 182430,
                           "needTime": 399316,
                           "needYield": 0,
                           "saveState": 588,
                           "restoreState": 588,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 182430,
                              "executionTimeMillisEstimate": 23,
                              "works": 581747,
                              "advanced": 182430,
                              "needTime": 399316,
                              "needYield": 0,
                              "saveState": 588,
                              "restoreState": 588,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 182430,
               "executionTimeMillisEstimate": 582
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 248,
               "executionTimeMillisEstimate": 680
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425484,
         "i": 15
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425484,
            "i": 15
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 4917,
                     "executionTimeMillis": 31,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 4917,
                        "executionTimeMillisEstimate": 4,
                        "works": 18995,
                        "advanced": 4917,
                        "needTime": 14077,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 4917,
                           "executionTimeMillisEstimate": 4,
                           "works": 18995,
                           "advanced": 4917,
                           "needTime": 14077,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 4917,
                              "executionTimeMillisEstimate": 3,
                              "works": 18995,
                              "advanced": 4917,
                              "needTime": 14077,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 4917,
               "executionTimeMillisEstimate": 27
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 118,
               "executionTimeMillisEstimate": 30
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 157947,
                     "executionTimeMillis": 648,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 157947,
                        "executionTimeMillisEstimate": 65,
                        "works": 508683,
                        "advanced": 157947,
                        "needTime": 350735,
                        "needYield": 0,
                        "saveState": 518,
                        "restoreState": 518,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 157947,
                           "executionTimeMillisEstimate": 61,
                           "works": 508683,
                           "advanced": 157947,
                           "needTime": 350735,
                           "needYield": 0,
                           "saveState": 518,
                           "restoreState": 518,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 157947,
                              "executionTimeMillisEstimate": 26,
                              "works": 508683,
                              "advanced": 157947,
                              "needTime": 350735,
                              "needYield": 0,
                              "saveState": 518,
                              "restoreState": 518,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 157947,
               "executionTimeMillisEstimate": 532
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 291,
               "executionTimeMillisEstimate": 646
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 182430,
                     "executionTimeMillis": 714,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 182430,
                        "executionTimeMillisEstimate": 56,
                        "works": 581747,
                        "advanced": 182430,
                        "needTime": 399316,
                        "needYield": 0,
                        "saveState": 591,
                        "restoreState": 591,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 182430,
                           "executionTimeMillisEstimate": 47,
                           "works": 581747,
                           "advanced": 182430,
                           "needTime": 399316,
                           "needYield": 0,
                           "saveState": 591,
                           "restoreState": 591,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 182430,
                              "executionTimeMillisEstimate": 20,
                              "works": 581747,
                              "advanced": 182430,
                              "needTime": 399316,
                              "needYield": 0,
                              "saveState": 591,
                              "restoreState": 591,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 182430,
               "executionTimeMillisEstimate": 593
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 248,
               "executionTimeMillisEstimate": 707
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425484,
         "i": 2355
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425484,
            "i": 2355
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 4917,
                     "executionTimeMillis": 19,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 4917,
                        "executionTimeMillisEstimate": 1,
                        "works": 18995,
                        "advanced": 4917,
                        "needTime": 14077,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 4917,
                           "executionTimeMillisEstimate": 1,
                           "works": 18995,
                           "advanced": 4917,
                           "needTime": 14077,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 4917,
                              "executionTimeMillisEstimate": 1,
                              "works": 18995,
                              "advanced": 4917,
                              "needTime": 14077,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 4917,
               "executionTimeMillisEstimate": 16
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1,
               "executionTimeMillisEstimate": 16
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 157947,
                     "executionTimeMillis": 598,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 157947,
                        "executionTimeMillisEstimate": 42,
                        "works": 508683,
                        "advanced": 157947,
                        "needTime": 350735,
                        "needYield": 0,
                        "saveState": 517,
                        "restoreState": 517,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 157947,
                           "executionTimeMillisEstimate": 39,
                           "works": 508683,
                           "advanced": 157947,
                           "needTime": 350735,
                           "needYield": 0,
                           "saveState": 517,
                           "restoreState": 517,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 157947,
                              "executionTimeMillisEstimate": 21,
                              "works": 508683,
                              "advanced": 157947,
                              "needTime": 350735,
                              "needYield": 0,
                              "saveState": 517,
                              "restoreState": 517,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 157947,
               "executionTimeMillisEstimate": 501
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 4,
               "executionTimeMillisEstimate": 590
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 182430,
                     "executionTimeMillis": 673,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 182430,
                        "executionTimeMillisEstimate": 50,
                        "works": 581747,
                        "advanced": 182430,
                        "needTime": 399316,
                        "needYield": 0,
                        "saveState": 591,
                        "restoreState": 591,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 182430,
                           "executionTimeMillisEstimate": 41,
                           "works": 581747,
                           "advanced": 182430,
                           "needTime": 399316,
                           "needYield": 0,
                           "saveState": 591,
                           "restoreState": 591,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 182430,
                              "executionTimeMillisEstimate": 23,
                              "works": 581747,
                              "advanced": 182430,
                              "needTime": 399316,
                              "needYield": 0,
                              "saveState": 591,
                              "restoreState": 591,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 182430,
               "executionTimeMillisEstimate": 576
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 5,
               "executionTimeMillisEstimate": 671
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425484,
         "i": 2355
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425485,
            "i": 3
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 18993,
                     "executionTimeMillis": 67,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 18993,
                        "executionTimeMillisEstimate": 11,
                        "works": 18995,
                        "advanced": 18993,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 18993,
                           "executionTimeMillisEstimate": 11,
                           "works": 18995,
                           "advanced": 18993,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 18993,
                              "executionTimeMillisEstimate": 4,
                              "works": 18995,
                              "advanced": 18993,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 18993,
               "executionTimeMillisEstimate": 42
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 121,
               "executionTimeMillisEstimate": 65
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 508681,
                     "executionTimeMillis": 1684,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 508681,
                        "executionTimeMillisEstimate": 140,
                        "works": 508683,
                        "advanced": 508681,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 533,
                        "restoreState": 533,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 508681,
                           "executionTimeMillisEstimate": 111,
                           "works": 508683,
                           "advanced": 508681,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 533,
                           "restoreState": 533,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 508681,
                              "executionTimeMillisEstimate": 21,
                              "works": 508683,
                              "advanced": 508681,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 533,
                              "restoreState": 533,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 508681,
               "executionTimeMillisEstimate": 1021
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 542,
               "executionTimeMillisEstimate": 1678
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 581745,
                     "executionTimeMillis": 1782,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 581745,
                        "executionTimeMillisEstimate": 114,
                        "works": 581747,
                        "advanced": 581745,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 610,
                        "restoreState": 610,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 581745,
                           "executionTimeMillisEstimate": 93,
                           "works": 581747,
                           "advanced": 581745,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 610,
                           "restoreState": 610,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 581745,
                              "executionTimeMillisEstimate": 21,
                              "works": 581747,
                              "advanced": 581745,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 610,
                              "restoreState": 610,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 581745,
               "executionTimeMillisEstimate": 1150
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 540,
               "executionTimeMillisEstimate": 1777
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425487,
         "i": 2643
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425487,
            "i": 2643
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 18993,
                     "executionTimeMillis": 58,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 18993,
                        "executionTimeMillisEstimate": 2,
                        "works": 18995,
                        "advanced": 18993,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 18993,
                           "executionTimeMillisEstimate": 2,
                           "works": 18995,
                           "advanced": 18993,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 18993,
                              "executionTimeMillisEstimate": 0,
                              "works": 18995,
                              "advanced": 18993,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 18993,
               "executionTimeMillisEstimate": 33
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 121,
               "executionTimeMillisEstimate": 52
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 508681,
                     "executionTimeMillis": 1619,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 508681,
                        "executionTimeMillisEstimate": 122,
                        "works": 508683,
                        "advanced": 508681,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 546,
                        "restoreState": 546,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 508681,
                           "executionTimeMillisEstimate": 99,
                           "works": 508683,
                           "advanced": 508681,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 546,
                           "restoreState": 546,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 508681,
                              "executionTimeMillisEstimate": 23,
                              "works": 508683,
                              "advanced": 508681,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 546,
                              "restoreState": 546,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 508681,
               "executionTimeMillisEstimate": 998
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 542,
               "executionTimeMillisEstimate": 1613
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 581745,
                     "executionTimeMillis": 1725,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 581745,
                        "executionTimeMillisEstimate": 113,
                        "works": 581747,
                        "advanced": 581745,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 625,
                        "restoreState": 625,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 581745,
                           "executionTimeMillisEstimate": 84,
                           "works": 581747,
                           "advanced": 581745,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 625,
                           "restoreState": 625,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 581745,
                              "executionTimeMillisEstimate": 11,
                              "works": 581747,
                              "advanced": 581745,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 625,
                              "restoreState": 625,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 581745,
               "executionTimeMillisEstimate": 1123
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 540,
               "executionTimeMillisEstimate": 1721
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425489,
         "i": 2685
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425489,
            "i": 2685
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 414,
            "executionTimeMillis": 9,
            "totalKeysExamined": 0,
            "totalDocsExamined": 18993,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 414,
               "executionTimeMillisEstimate": 0,
               "works": 18995,
               "advanced": 414,
               "needTime": 18580,
               "needYield": 0,
               "saveState": 18,
               "restoreState": 18,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 414,
                  "executionTimeMillisEstimate": 0,
                  "works": 18995,
                  "advanced": 414,
                  "needTime": 18580,
                  "needYield": 0,
                  "saveState": 18,
                  "restoreState": 18,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 18993
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 8376,
            "executionTimeMillis": 230,
            "totalKeysExamined": 0,
            "totalDocsExamined": 508681,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 8376,
               "executionTimeMillisEstimate": 7,
               "works": 508683,
               "advanced": 8376,
               "needTime": 500306,
               "needYield": 0,
               "saveState": 508,
               "restoreState": 508,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 8376,
                  "executionTimeMillisEstimate": 7,
                  "works": 508683,
                  "advanced": 8376,
                  "needTime": 500306,
                  "needYield": 0,
                  "saveState": 508,
                  "restoreState": 508,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 508681
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 6035,
            "executionTimeMillis": 267,
            "totalKeysExamined": 0,
            "totalDocsExamined": 581745,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 6035,
               "executionTimeMillisEstimate": 9,
               "works": 581747,
               "advanced": 6035,
               "needTime": 575711,
               "needYield": 0,
               "saveState": 581,
               "restoreState": 581,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 6035,
                  "executionTimeMillisEstimate": 9,
                  "works": 581747,
                  "advanced": 6035,
                  "needTime": 575711,
                  "needYield": 0,
                  "saveState": 581,
                  "restoreState": 581,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 581745
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425489,
         "i": 2685
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425489,
            "i": 2685
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 18993,
                     "executionTimeMillis": 78,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 18993,
                        "executionTimeMillisEstimate": 10,
                        "works": 18995,
                        "advanced": 18993,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 21,
                        "restoreState": 21,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 18993,
                           "executionTimeMillisEstimate": 3,
                           "works": 18995,
                           "advanced": 18993,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 21,
                           "restoreState": 21,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 18993,
                              "executionTimeMillisEstimate": 2,
                              "works": 18995,
                              "advanced": 18993,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 21,
                              "restoreState": 21,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 18993,
               "executionTimeMillisEstimate": 63
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 749,
               "executionTimeMillisEstimate": 74
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 508681,
                     "executionTimeMillis": 2140,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 508681,
                        "executionTimeMillisEstimate": 295,
                        "works": 508683,
                        "advanced": 508681,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 568,
                        "restoreState": 568,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 508681,
                           "executionTimeMillisEstimate": 138,
                           "works": 508683,
                           "advanced": 508681,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 568,
                           "restoreState": 568,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 508681,
                              "executionTimeMillisEstimate": 26,
                              "works": 508683,
                              "advanced": 508681,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 568,
                              "restoreState": 568,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 508681,
               "executionTimeMillisEstimate": 1819
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2062,
               "executionTimeMillisEstimate": 2130
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 581745,
                     "executionTimeMillis": 2380,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 581745,
                        "executionTimeMillisEstimate": 309,
                        "works": 581747,
                        "advanced": 581745,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 650,
                        "restoreState": 650,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 581745,
                           "executionTimeMillisEstimate": 124,
                           "works": 581747,
                           "advanced": 581745,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 650,
                           "restoreState": 650,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 581745,
                              "executionTimeMillisEstimate": 22,
                              "works": 581747,
                              "advanced": 581745,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 650,
                              "restoreState": 650,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 581745,
               "executionTimeMillisEstimate": 2067
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1713,
               "executionTimeMillisEstimate": 2374
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425490,
         "i": 3642
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425490,
            "i": 3649
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 18993,
                     "executionTimeMillis": 80,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 18993,
                        "executionTimeMillisEstimate": 17,
                        "works": 18995,
                        "advanced": 18993,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 21,
                        "restoreState": 21,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 18993,
                           "executionTimeMillisEstimate": 5,
                           "works": 18995,
                           "advanced": 18993,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 21,
                           "restoreState": 21,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 18993,
                              "executionTimeMillisEstimate": 2,
                              "works": 18995,
                              "advanced": 18993,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 21,
                              "restoreState": 21,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 18993,
               "executionTimeMillisEstimate": 62
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 748,
               "executionTimeMillisEstimate": 80
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 508681,
                     "executionTimeMillis": 2158,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 508681,
                        "executionTimeMillisEstimate": 338,
                        "works": 508683,
                        "advanced": 508681,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 568,
                        "restoreState": 568,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 508681,
                           "executionTimeMillisEstimate": 134,
                           "works": 508683,
                           "advanced": 508681,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 568,
                           "restoreState": 568,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 508681,
                              "executionTimeMillisEstimate": 28,
                              "works": 508683,
                              "advanced": 508681,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 568,
                              "restoreState": 568,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 508681,
               "executionTimeMillisEstimate": 1841
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2061,
               "executionTimeMillisEstimate": 2158
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 581745,
                     "executionTimeMillis": 2449,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 581745,
                        "executionTimeMillisEstimate": 416,
                        "works": 581747,
                        "advanced": 581745,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 650,
                        "restoreState": 650,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 581745,
                           "executionTimeMillisEstimate": 186,
                           "works": 581747,
                           "advanced": 581745,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 650,
                           "restoreState": 650,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 581745,
                              "executionTimeMillisEstimate": 41,
                              "works": 581747,
                              "advanced": 581745,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 650,
                              "restoreState": 650,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 581745,
               "executionTimeMillisEstimate": 2108
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1713,
               "executionTimeMillisEstimate": 2448
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425494,
         "i": 822
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425494,
            "i": 822
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 18993,
                     "executionTimeMillis": 45,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 18993,
                        "executionTimeMillisEstimate": 4,
                        "works": 18995,
                        "advanced": 18993,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 18993,
                           "executionTimeMillisEstimate": 3,
                           "works": 18995,
                           "advanced": 18993,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 18993,
                              "executionTimeMillisEstimate": 0,
                              "works": 18995,
                              "advanced": 18993,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 18993,
               "executionTimeMillisEstimate": 33
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 1,
               "executionTimeMillisEstimate": 43
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 508681,
                     "executionTimeMillis": 1146,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 508681,
                        "executionTimeMillisEstimate": 84,
                        "works": 508683,
                        "advanced": 508681,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 528,
                        "restoreState": 528,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 508681,
                           "executionTimeMillisEstimate": 73,
                           "works": 508683,
                           "advanced": 508681,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 528,
                           "restoreState": 528,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 508681,
                              "executionTimeMillisEstimate": 13,
                              "works": 508683,
                              "advanced": 508681,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 528,
                              "restoreState": 528,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 508681,
               "executionTimeMillisEstimate": 898
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 4,
               "executionTimeMillisEstimate": 1140
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 581745,
                     "executionTimeMillis": 1275,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 581745,
                        "executionTimeMillisEstimate": 97,
                        "works": 581747,
                        "advanced": 581745,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 603,
                        "restoreState": 603,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 581745,
                           "executionTimeMillisEstimate": 81,
                           "works": 581747,
                           "advanced": 581745,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 603,
                           "restoreState": 603,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 581745,
                              "executionTimeMillisEstimate": 24,
                              "works": 581747,
                              "advanced": 581745,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 603,
                              "restoreState": 603,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 581745,
               "executionTimeMillisEstimate": 979
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 5,
               "executionTimeMillisEstimate": 1268
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425495,
         "i": 7
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425495,
            "i": 10
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 3622,
                     "executionTimeMillis": 17,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 3622,
                        "executionTimeMillisEstimate": 0,
                        "works": 18995,
                        "advanced": 3622,
                        "needTime": 15372,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 3622,
                           "executionTimeMillisEstimate": 0,
                           "works": 18995,
                           "advanced": 3622,
                           "needTime": 15372,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 3622,
                              "executionTimeMillisEstimate": 0,
                              "works": 18995,
                              "advanced": 3622,
                              "needTime": 15372,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 3622,
               "executionTimeMillisEstimate": 16
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 118,
               "executionTimeMillisEstimate": 16
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 84159,
                     "executionTimeMillis": 423,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 84159,
                        "executionTimeMillisEstimate": 27,
                        "works": 508683,
                        "advanced": 84159,
                        "needTime": 424523,
                        "needYield": 0,
                        "saveState": 512,
                        "restoreState": 512,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 84159,
                           "executionTimeMillisEstimate": 22,
                           "works": 508683,
                           "advanced": 84159,
                           "needTime": 424523,
                           "needYield": 0,
                           "saveState": 512,
                           "restoreState": 512,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 84159,
                              "executionTimeMillisEstimate": 14,
                              "works": 508683,
                              "advanced": 84159,
                              "needTime": 424523,
                              "needYield": 0,
                              "saveState": 512,
                              "restoreState": 512,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 84159,
               "executionTimeMillisEstimate": 372
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 290,
               "executionTimeMillisEstimate": 419
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 94872,
                     "executionTimeMillis": 485,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 94872,
                        "executionTimeMillisEstimate": 29,
                        "works": 581747,
                        "advanced": 94872,
                        "needTime": 486874,
                        "needYield": 0,
                        "saveState": 585,
                        "restoreState": 585,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 94872,
                           "executionTimeMillisEstimate": 22,
                           "works": 581747,
                           "advanced": 94872,
                           "needTime": 486874,
                           "needYield": 0,
                           "saveState": 585,
                           "restoreState": 585,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 94872,
                              "executionTimeMillisEstimate": 11,
                              "works": 581747,
                              "advanced": 94872,
                              "needTime": 486874,
                              "needYield": 0,
                              "saveState": 585,
                              "restoreState": 585,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 94872,
               "executionTimeMillisEstimate": 443
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 244,
               "executionTimeMillisEstimate": 476
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425495,
         "i": 31
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425495,
            "i": 31
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 3622,
                     "executionTimeMillis": 17,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 18993,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 3622,
                        "executionTimeMillisEstimate": 2,
                        "works": 18995,
                        "advanced": 3622,
                        "needTime": 15372,
                        "needYield": 0,
                        "saveState": 19,
                        "restoreState": 19,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 3622,
                           "executionTimeMillisEstimate": 2,
                           "works": 18995,
                           "advanced": 3622,
                           "needTime": 15372,
                           "needYield": 0,
                           "saveState": 19,
                           "restoreState": 19,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 3622,
                              "executionTimeMillisEstimate": 2,
                              "works": 18995,
                              "advanced": 3622,
                              "needTime": 15372,
                              "needYield": 0,
                              "saveState": 19,
                              "restoreState": 19,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 18993
                           }
                        }
                     }
                  }
               },
               "nReturned": 3622,
               "executionTimeMillisEstimate": 15
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 118,
               "executionTimeMillisEstimate": 15
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 84159,
                     "executionTimeMillis": 426,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 508681,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 84159,
                        "executionTimeMillisEstimate": 31,
                        "works": 508683,
                        "advanced": 84159,
                        "needTime": 424523,
                        "needYield": 0,
                        "saveState": 512,
                        "restoreState": 512,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 84159,
                           "executionTimeMillisEstimate": 27,
                           "works": 508683,
                           "advanced": 84159,
                           "needTime": 424523,
                           "needYield": 0,
                           "saveState": 512,
                           "restoreState": 512,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 84159,
                              "executionTimeMillisEstimate": 10,
                              "works": 508683,
                              "advanced": 84159,
                              "needTime": 424523,
                              "needYield": 0,
                              "saveState": 512,
                              "restoreState": 512,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 508681
                           }
                        }
                     }
                  }
               },
               "nReturned": 84159,
               "executionTimeMillisEstimate": 384
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 290,
               "executionTimeMillisEstimate": 426
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 94872,
                     "executionTimeMillis": 483,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 581745,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 94872,
                        "executionTimeMillisEstimate": 34,
                        "works": 581747,
                        "advanced": 94872,
                        "needTime": 486874,
                        "needYield": 0,
                        "saveState": 585,
                        "restoreState": 585,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 94872,
                           "executionTimeMillisEstimate": 29,
                           "works": 581747,
                           "advanced": 94872,
                           "needTime": 486874,
                           "needYield": 0,
                           "saveState": 585,
                           "restoreState": 585,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 94872,
                              "executionTimeMillisEstimate": 15,
                              "works": 581747,
                              "advanced": 94872,
                              "needTime": 486874,
                              "needYield": 0,
                              "saveState": 585,
                              "restoreState": 585,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 581745
                           }
                        }
                     }
                  }
               },
               "nReturned": 94872,
               "executionTimeMillisEstimate": 434
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 244,
               "executionTimeMillisEstimate": 476
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425496,
         "i": 2
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425496,
            "i": 2
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_MKT_UNIQUE_CARRIER_range<a name="AirlineData_MKT_UNIQUE_CARRIER_range"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 0,
            "totalKeysExamined": 0,
            "totalDocsExamined": 0,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 0,
               "works": 2,
               "advanced": 0,
               "needTime": 1,
               "needYield": 0,
               "saveState": 0,
               "restoreState": 0,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 0,
                  "works": 2,
                  "advanced": 0,
                  "needTime": 1,
                  "needYield": 0,
                  "saveState": 0,
                  "restoreState": 0,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 0
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 2,
            "executionTimeMillis": 1429,
            "totalKeysExamined": 0,
            "totalDocsExamined": 1109419,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 2,
               "executionTimeMillisEstimate": 200,
               "works": 1109421,
               "advanced": 2,
               "needTime": 1109418,
               "needYield": 0,
               "saveState": 1109,
               "restoreState": 1109,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 2,
                  "executionTimeMillisEstimate": 199,
                  "works": 1109421,
                  "advanced": 2,
                  "needTime": 1109418,
                  "needYield": 0,
                  "saveState": 1109,
                  "restoreState": 1109,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 1109419
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425497,
         "i": 3248
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425497,
            "i": 3254
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 2838,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 269,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1166,
                        "restoreState": 1166,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 212,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1166,
                           "restoreState": 1166,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 71,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1166,
                              "restoreState": 1166,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 2197
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2833
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425500,
         "i": 375
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425500,
            "i": 381
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 2785,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 233,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1151,
                        "restoreState": 1151,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 184,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1151,
                           "restoreState": 1151,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 59,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1151,
                              "restoreState": 1151,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 2053
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 2785
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425503,
         "i": 2054
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425503,
            "i": 2054
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 2665,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 205,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1169,
                        "restoreState": 1169,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 149,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1169,
                           "restoreState": 1169,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 37,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1169,
                              "restoreState": 1169,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 1978
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 370,
               "executionTimeMillisEstimate": 2661
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425505,
         "i": 1325
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425505,
            "i": 1333
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 215515,
                     "executionTimeMillis": 1006,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 215515,
                        "executionTimeMillisEstimate": 76,
                        "works": 1109421,
                        "advanced": 215515,
                        "needTime": 893905,
                        "needYield": 0,
                        "saveState": 1119,
                        "restoreState": 1119,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 215515,
                           "executionTimeMillisEstimate": 67,
                           "works": 1109421,
                           "advanced": 215515,
                           "needTime": 893905,
                           "needYield": 0,
                           "saveState": 1119,
                           "restoreState": 1119,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 215515,
                              "executionTimeMillisEstimate": 51,
                              "works": 1109421,
                              "advanced": 215515,
                              "needTime": 893905,
                              "needYield": 0,
                              "saveState": 1119,
                              "restoreState": 1119,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 215515,
               "executionTimeMillisEstimate": 858
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 369,
               "executionTimeMillisEstimate": 1000
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425507,
         "i": 4176
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425507,
            "i": 4177
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 215515,
                     "executionTimeMillis": 1019,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 215515,
                        "executionTimeMillisEstimate": 45,
                        "works": 1109421,
                        "advanced": 215515,
                        "needTime": 893905,
                        "needYield": 0,
                        "saveState": 1118,
                        "restoreState": 1118,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 215515,
                           "executionTimeMillisEstimate": 40,
                           "works": 1109421,
                           "advanced": 215515,
                           "needTime": 893905,
                           "needYield": 0,
                           "saveState": 1118,
                           "restoreState": 1118,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 215515,
                              "executionTimeMillisEstimate": 26,
                              "works": 1109421,
                              "advanced": 215515,
                              "needTime": 893905,
                              "needYield": 0,
                              "saveState": 1118,
                              "restoreState": 1118,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 215515,
               "executionTimeMillisEstimate": 875
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 368,
               "executionTimeMillisEstimate": 1012
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425507,
         "i": 4180
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425507,
            "i": 4188
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 215515,
                     "executionTimeMillis": 1011,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 215515,
                        "executionTimeMillisEstimate": 72,
                        "works": 1109421,
                        "advanced": 215515,
                        "needTime": 893905,
                        "needYield": 0,
                        "saveState": 1122,
                        "restoreState": 1122,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 215515,
                           "executionTimeMillisEstimate": 68,
                           "works": 1109421,
                           "advanced": 215515,
                           "needTime": 893905,
                           "needYield": 0,
                           "saveState": 1122,
                           "restoreState": 1122,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 215515,
                              "executionTimeMillisEstimate": 45,
                              "works": 1109421,
                              "advanced": 215515,
                              "needTime": 893905,
                              "needYield": 0,
                              "saveState": 1122,
                              "restoreState": 1122,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 215515,
               "executionTimeMillisEstimate": 857
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1002
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425509,
         "i": 15
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425509,
            "i": 23
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345294,
                     "executionTimeMillis": 1256,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345294,
                        "executionTimeMillisEstimate": 95,
                        "works": 1109421,
                        "advanced": 345294,
                        "needTime": 764126,
                        "needYield": 0,
                        "saveState": 1123,
                        "restoreState": 1123,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345294,
                           "executionTimeMillisEstimate": 74,
                           "works": 1109421,
                           "advanced": 345294,
                           "needTime": 764126,
                           "needYield": 0,
                           "saveState": 1123,
                           "restoreState": 1123,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 345294,
                              "executionTimeMillisEstimate": 45,
                              "works": 1109421,
                              "advanced": 345294,
                              "needTime": 764126,
                              "needYield": 0,
                              "saveState": 1123,
                              "restoreState": 1123,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 345294,
               "executionTimeMillisEstimate": 1012
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 1251
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425510,
         "i": 3196
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425510,
            "i": 3197
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345294,
                     "executionTimeMillis": 1301,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345294,
                        "executionTimeMillisEstimate": 92,
                        "works": 1109421,
                        "advanced": 345294,
                        "needTime": 764126,
                        "needYield": 0,
                        "saveState": 1129,
                        "restoreState": 1129,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345294,
                           "executionTimeMillisEstimate": 81,
                           "works": 1109421,
                           "advanced": 345294,
                           "needTime": 764126,
                           "needYield": 0,
                           "saveState": 1129,
                           "restoreState": 1129,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 345294,
                              "executionTimeMillisEstimate": 49,
                              "works": 1109421,
                              "advanced": 345294,
                              "needTime": 764126,
                              "needYield": 0,
                              "saveState": 1129,
                              "restoreState": 1129,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 345294,
               "executionTimeMillisEstimate": 1099
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 1300
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425512,
         "i": 6
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425512,
            "i": 6
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 345294,
                     "executionTimeMillis": 1283,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 345294,
                        "executionTimeMillisEstimate": 113,
                        "works": 1109421,
                        "advanced": 345294,
                        "needTime": 764126,
                        "needYield": 0,
                        "saveState": 1128,
                        "restoreState": 1128,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 345294,
                           "executionTimeMillisEstimate": 102,
                           "works": 1109421,
                           "advanced": 345294,
                           "needTime": 764126,
                           "needYield": 0,
                           "saveState": 1128,
                           "restoreState": 1128,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 345294,
                              "executionTimeMillisEstimate": 37,
                              "works": 1109421,
                              "advanced": 345294,
                              "needTime": 764126,
                              "needYield": 0,
                              "saveState": 1128,
                              "restoreState": 1128,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 345294,
               "executionTimeMillisEstimate": 1018
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1282
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425512,
         "i": 3981
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425512,
            "i": 3981
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 3334,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 197,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1164,
                        "restoreState": 1164,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 159,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1164,
                           "restoreState": 1164,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 31,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1164,
                              "restoreState": 1164,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 1923
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1203,
               "executionTimeMillisEstimate": 3326
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425516,
         "i": 802
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425516,
            "i": 802
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 3304,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 210,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1192,
                        "restoreState": 1192,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 166,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1192,
                           "restoreState": 1192,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 52,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1192,
                              "restoreState": 1192,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 1994
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1203,
               "executionTimeMillisEstimate": 3296
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425518,
         "i": 5075
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425519,
            "i": 3
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 0,
            "totalKeysExamined": 0,
            "totalDocsExamined": 0,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 0,
               "works": 2,
               "advanced": 0,
               "needTime": 1,
               "needYield": 0,
               "saveState": 0,
               "restoreState": 0,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 0,
                  "works": 2,
                  "advanced": 0,
                  "needTime": 1,
                  "needYield": 0,
                  "saveState": 0,
                  "restoreState": 0,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 0
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 14825,
            "executionTimeMillis": 516,
            "totalKeysExamined": 0,
            "totalDocsExamined": 1109419,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 14825,
               "executionTimeMillisEstimate": 38,
               "works": 1109421,
               "advanced": 14825,
               "needTime": 1094595,
               "needYield": 0,
               "saveState": 1109,
               "restoreState": 1109,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 14825,
                  "executionTimeMillisEstimate": 37,
                  "works": 1109421,
                  "advanced": 14825,
                  "needTime": 1094595,
                  "needYield": 0,
                  "saveState": 1109,
                  "restoreState": 1109,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 1109419
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425520,
         "i": 5182
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425520,
            "i": 5182
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 4512,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 699,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1240,
                        "restoreState": 1240,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 272,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1240,
                           "restoreState": 1240,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 61,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1240,
                              "restoreState": 1240,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 3772
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2552,
               "executionTimeMillisEstimate": 4501
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425524,
         "i": 296
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425524,
            "i": 302
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 4685,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 812,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1240,
                        "restoreState": 1240,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 285,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1240,
                           "restoreState": 1240,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 99,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1240,
                              "restoreState": 1240,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 3957
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2551,
               "executionTimeMillisEstimate": 4675
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425529,
         "i": 4127
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425529,
            "i": 4127
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 1109419,
                     "executionTimeMillis": 2496,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 1109419,
                        "executionTimeMillisEstimate": 200,
                        "works": 1109421,
                        "advanced": 1109419,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1151,
                        "restoreState": 1151,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 1109419,
                           "executionTimeMillisEstimate": 174,
                           "works": 1109421,
                           "advanced": 1109419,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1151,
                           "restoreState": 1151,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1109419,
                              "executionTimeMillisEstimate": 72,
                              "works": 1109421,
                              "advanced": 1109419,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1151,
                              "restoreState": 1151,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 1109419,
               "executionTimeMillisEstimate": 1899
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2496
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425532,
         "i": 3155
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425532,
            "i": 3155
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 182653,
                     "executionTimeMillis": 927,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 182653,
                        "executionTimeMillisEstimate": 81,
                        "works": 1109421,
                        "advanced": 182653,
                        "needTime": 926767,
                        "needYield": 0,
                        "saveState": 1116,
                        "restoreState": 1116,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 182653,
                           "executionTimeMillisEstimate": 73,
                           "works": 1109421,
                           "advanced": 182653,
                           "needTime": 926767,
                           "needYield": 0,
                           "saveState": 1116,
                           "restoreState": 1116,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 182653,
                              "executionTimeMillisEstimate": 42,
                              "works": 1109421,
                              "advanced": 182653,
                              "needTime": 926767,
                              "needYield": 0,
                              "saveState": 1116,
                              "restoreState": 1116,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 182653,
               "executionTimeMillisEstimate": 826
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 925
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425532,
         "i": 3166
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425532,
            "i": 3169
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 0,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 0,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 0,
                        "works": 2,
                        "advanced": 0,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 1,
                        "restoreState": 1,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 0,
                           "works": 2,
                           "advanced": 0,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 1,
                           "restoreState": 1,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 0,
                              "works": 2,
                              "advanced": 0,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1,
                              "restoreState": 1,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 0
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 0
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_MKT_UNIQUE_CARRIER_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 182653,
                     "executionTimeMillis": 1521,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1109419,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 182653,
                        "executionTimeMillisEstimate": 238,
                        "works": 1109421,
                        "advanced": 182653,
                        "needTime": 926767,
                        "needYield": 0,
                        "saveState": 1117,
                        "restoreState": 1117,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 182653,
                           "executionTimeMillisEstimate": 220,
                           "works": 1109421,
                           "advanced": 182653,
                           "needTime": 926767,
                           "needYield": 0,
                           "saveState": 1117,
                           "restoreState": 1117,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 182653,
                              "executionTimeMillisEstimate": 178,
                              "works": 1109421,
                              "advanced": 182653,
                              "needTime": 926767,
                              "needYield": 0,
                              "saveState": 1117,
                              "restoreState": 1117,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1109419
                           }
                        }
                     }
                  }
               },
               "nReturned": 182653,
               "executionTimeMillisEstimate": 1332
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 1520
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425534,
         "i": 4786
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425534,
            "i": 4786
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_ORIGIN<a name="AirlineData_ORIGIN"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 383,
            "totalKeysExamined": 0,
            "totalDocsExamined": 347615,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 86,
               "works": 347617,
               "advanced": 0,
               "needTime": 347616,
               "needYield": 0,
               "saveState": 348,
               "restoreState": 348,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 85,
                  "works": 347617,
                  "advanced": 0,
                  "needTime": 347616,
                  "needYield": 0,
                  "saveState": 348,
                  "restoreState": 348,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 347615
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 2,
            "executionTimeMillis": 424,
            "totalKeysExamined": 0,
            "totalDocsExamined": 301737,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 2,
               "executionTimeMillisEstimate": 100,
               "works": 301739,
               "advanced": 2,
               "needTime": 301736,
               "needYield": 0,
               "saveState": 301,
               "restoreState": 301,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 2,
                  "executionTimeMillisEstimate": 100,
                  "works": 301739,
                  "advanced": 2,
                  "needTime": 301736,
                  "needYield": 0,
                  "saveState": 301,
                  "restoreState": 301,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 301737
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 477,
            "totalKeysExamined": 0,
            "totalDocsExamined": 460067,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 87,
               "works": 460069,
               "advanced": 0,
               "needTime": 460068,
               "needYield": 0,
               "saveState": 460,
               "restoreState": 460,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 87,
                  "works": 460069,
                  "advanced": 0,
                  "needTime": 460068,
                  "needYield": 0,
                  "saveState": 460,
                  "restoreState": 460,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 460067
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425535,
         "i": 11
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425535,
            "i": 11
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 301737,
                     "executionTimeMillis": 930,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 301737,
                        "executionTimeMillisEstimate": 105,
                        "works": 301739,
                        "advanced": 301737,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 317,
                        "restoreState": 317,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 301737,
                           "executionTimeMillisEstimate": 84,
                           "works": 301739,
                           "advanced": 301737,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 317,
                           "restoreState": 317,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 301737,
                              "executionTimeMillisEstimate": 20,
                              "works": 301739,
                              "advanced": 301737,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 317,
                              "restoreState": 317,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 301737,
               "executionTimeMillisEstimate": 708
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 921
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 347615,
                     "executionTimeMillis": 1025,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 347615,
                        "executionTimeMillisEstimate": 99,
                        "works": 347617,
                        "advanced": 347615,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 366,
                        "restoreState": 366,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 347615,
                           "executionTimeMillisEstimate": 75,
                           "works": 347617,
                           "advanced": 347615,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 366,
                           "restoreState": 366,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 347615,
                              "executionTimeMillisEstimate": 13,
                              "works": 347617,
                              "advanced": 347615,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 366,
                              "restoreState": 366,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 347615,
               "executionTimeMillisEstimate": 823
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1021
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 460067,
                     "executionTimeMillis": 1360,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 460067,
                        "executionTimeMillisEstimate": 134,
                        "works": 460069,
                        "advanced": 460067,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 484,
                        "restoreState": 484,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 460067,
                           "executionTimeMillisEstimate": 111,
                           "works": 460069,
                           "advanced": 460067,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 484,
                           "restoreState": 484,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 460067,
                              "executionTimeMillisEstimate": 27,
                              "works": 460069,
                              "advanced": 460067,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 484,
                              "restoreState": 484,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 460067,
               "executionTimeMillisEstimate": 1074
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1357
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425536,
         "i": 773
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425536,
            "i": 773
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 301737,
                     "executionTimeMillis": 804,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 301737,
                        "executionTimeMillisEstimate": 79,
                        "works": 301739,
                        "advanced": 301737,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 313,
                        "restoreState": 313,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 301737,
                           "executionTimeMillisEstimate": 52,
                           "works": 301739,
                           "advanced": 301737,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 313,
                           "restoreState": 313,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 301737,
                              "executionTimeMillisEstimate": 12,
                              "works": 301739,
                              "advanced": 301737,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 313,
                              "restoreState": 313,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 301737,
               "executionTimeMillisEstimate": 620
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 111,
               "executionTimeMillisEstimate": 801
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 347615,
                     "executionTimeMillis": 850,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 347615,
                        "executionTimeMillisEstimate": 57,
                        "works": 347617,
                        "advanced": 347615,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 361,
                        "restoreState": 361,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 347615,
                           "executionTimeMillisEstimate": 43,
                           "works": 347617,
                           "advanced": 347615,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 361,
                           "restoreState": 361,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 347615,
                              "executionTimeMillisEstimate": 15,
                              "works": 347617,
                              "advanced": 347615,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 361,
                              "restoreState": 361,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 347615,
               "executionTimeMillisEstimate": 635
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 132,
               "executionTimeMillisEstimate": 846
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 460067,
                     "executionTimeMillis": 1180,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 460067,
                        "executionTimeMillisEstimate": 106,
                        "works": 460069,
                        "advanced": 460067,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 477,
                        "restoreState": 477,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 460067,
                           "executionTimeMillisEstimate": 90,
                           "works": 460069,
                           "advanced": 460067,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 477,
                           "restoreState": 477,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 460067,
                              "executionTimeMillisEstimate": 11,
                              "works": 460069,
                              "advanced": 460067,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 477,
                              "restoreState": 477,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 460067,
               "executionTimeMillisEstimate": 905
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 127,
               "executionTimeMillisEstimate": 1179
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425536,
         "i": 3325
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425536,
            "i": 3326
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 301737,
                     "executionTimeMillis": 785,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 301737,
                        "executionTimeMillisEstimate": 93,
                        "works": 301739,
                        "advanced": 301737,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 318,
                        "restoreState": 318,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 301737,
                           "executionTimeMillisEstimate": 83,
                           "works": 301739,
                           "advanced": 301737,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 318,
                           "restoreState": 318,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 301737,
                              "executionTimeMillisEstimate": 9,
                              "works": 301739,
                              "advanced": 301737,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 318,
                              "restoreState": 318,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 301737,
               "executionTimeMillisEstimate": 594
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 250,
               "executionTimeMillisEstimate": 782
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 347615,
                     "executionTimeMillis": 850,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 347615,
                        "executionTimeMillisEstimate": 59,
                        "works": 347617,
                        "advanced": 347615,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 367,
                        "restoreState": 367,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 347615,
                           "executionTimeMillisEstimate": 45,
                           "works": 347617,
                           "advanced": 347615,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 367,
                           "restoreState": 367,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 347615,
                              "executionTimeMillisEstimate": 5,
                              "works": 347617,
                              "advanced": 347615,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 367,
                              "restoreState": 367,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 347615,
               "executionTimeMillisEstimate": 659
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 259,
               "executionTimeMillisEstimate": 848
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 460067,
                     "executionTimeMillis": 1182,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 460067,
                        "executionTimeMillisEstimate": 114,
                        "works": 460069,
                        "advanced": 460067,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 484,
                        "restoreState": 484,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 460067,
                           "executionTimeMillisEstimate": 90,
                           "works": 460069,
                           "advanced": 460067,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 484,
                           "restoreState": 484,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 460067,
                              "executionTimeMillisEstimate": 14,
                              "works": 460069,
                              "advanced": 460067,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 484,
                              "restoreState": 484,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 460067,
               "executionTimeMillisEstimate": 902
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 304,
               "executionTimeMillisEstimate": 1172
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425538,
         "i": 2556
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425538,
            "i": 2556
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 62406,
                     "executionTimeMillis": 290,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 62406,
                        "executionTimeMillisEstimate": 11,
                        "works": 301739,
                        "advanced": 62406,
                        "needTime": 239332,
                        "needYield": 0,
                        "saveState": 306,
                        "restoreState": 306,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 62406,
                           "executionTimeMillisEstimate": 8,
                           "works": 301739,
                           "advanced": 62406,
                           "needTime": 239332,
                           "needYield": 0,
                           "saveState": 306,
                           "restoreState": 306,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 62406,
                              "executionTimeMillisEstimate": 3,
                              "works": 301739,
                              "advanced": 62406,
                              "needTime": 239332,
                              "needYield": 0,
                              "saveState": 306,
                              "restoreState": 306,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 62406,
               "executionTimeMillisEstimate": 249
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 111,
               "executionTimeMillisEstimate": 289
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 68792,
                     "executionTimeMillis": 317,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 68792,
                        "executionTimeMillisEstimate": 13,
                        "works": 347617,
                        "advanced": 68792,
                        "needTime": 278824,
                        "needYield": 0,
                        "saveState": 351,
                        "restoreState": 351,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 68792,
                           "executionTimeMillisEstimate": 12,
                           "works": 347617,
                           "advanced": 68792,
                           "needTime": 278824,
                           "needYield": 0,
                           "saveState": 351,
                           "restoreState": 351,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 68792,
                              "executionTimeMillisEstimate": 7,
                              "works": 347617,
                              "advanced": 68792,
                              "needTime": 278824,
                              "needYield": 0,
                              "saveState": 351,
                              "restoreState": 351,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 68792,
               "executionTimeMillisEstimate": 284
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 132,
               "executionTimeMillisEstimate": 311
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 84317,
                     "executionTimeMillis": 412,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 84317,
                        "executionTimeMillisEstimate": 15,
                        "works": 460069,
                        "advanced": 84317,
                        "needTime": 375751,
                        "needYield": 0,
                        "saveState": 463,
                        "restoreState": 463,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 84317,
                           "executionTimeMillisEstimate": 13,
                           "works": 460069,
                           "advanced": 84317,
                           "needTime": 375751,
                           "needYield": 0,
                           "saveState": 463,
                           "restoreState": 463,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 84317,
                              "executionTimeMillisEstimate": 9,
                              "works": 460069,
                              "advanced": 84317,
                              "needTime": 375751,
                              "needYield": 0,
                              "saveState": 463,
                              "restoreState": 463,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 84317,
               "executionTimeMillisEstimate": 366
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 126,
               "executionTimeMillisEstimate": 406
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425539,
         "i": 10
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425539,
            "i": 10
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 62406,
                     "executionTimeMillis": 308,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 62406,
                        "executionTimeMillisEstimate": 26,
                        "works": 301739,
                        "advanced": 62406,
                        "needTime": 239332,
                        "needYield": 0,
                        "saveState": 303,
                        "restoreState": 303,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 62406,
                           "executionTimeMillisEstimate": 23,
                           "works": 301739,
                           "advanced": 62406,
                           "needTime": 239332,
                           "needYield": 0,
                           "saveState": 303,
                           "restoreState": 303,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 62406,
                              "executionTimeMillisEstimate": 14,
                              "works": 301739,
                              "advanced": 62406,
                              "needTime": 239332,
                              "needYield": 0,
                              "saveState": 303,
                              "restoreState": 303,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 62406,
               "executionTimeMillisEstimate": 263
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 249,
               "executionTimeMillisEstimate": 300
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 68792,
                     "executionTimeMillis": 332,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 68792,
                        "executionTimeMillisEstimate": 33,
                        "works": 347617,
                        "advanced": 68792,
                        "needTime": 278824,
                        "needYield": 0,
                        "saveState": 351,
                        "restoreState": 351,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 68792,
                           "executionTimeMillisEstimate": 32,
                           "works": 347617,
                           "advanced": 68792,
                           "needTime": 278824,
                           "needYield": 0,
                           "saveState": 351,
                           "restoreState": 351,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 68792,
                              "executionTimeMillisEstimate": 18,
                              "works": 347617,
                              "advanced": 68792,
                              "needTime": 278824,
                              "needYield": 0,
                              "saveState": 351,
                              "restoreState": 351,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 68792,
               "executionTimeMillisEstimate": 287
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 255,
               "executionTimeMillisEstimate": 328
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 84317,
                     "executionTimeMillis": 428,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 84317,
                        "executionTimeMillisEstimate": 20,
                        "works": 460069,
                        "advanced": 84317,
                        "needTime": 375751,
                        "needYield": 0,
                        "saveState": 463,
                        "restoreState": 463,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 84317,
                           "executionTimeMillisEstimate": 18,
                           "works": 460069,
                           "advanced": 84317,
                           "needTime": 375751,
                           "needYield": 0,
                           "saveState": 463,
                           "restoreState": 463,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 84317,
                              "executionTimeMillisEstimate": 14,
                              "works": 460069,
                              "advanced": 84317,
                              "needTime": 375751,
                              "needYield": 0,
                              "saveState": 463,
                              "restoreState": 463,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 84317,
               "executionTimeMillisEstimate": 371
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 301,
               "executionTimeMillisEstimate": 426
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425539,
         "i": 2362
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425539,
            "i": 2362
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 62406,
                     "executionTimeMillis": 303,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 62406,
                        "executionTimeMillisEstimate": 17,
                        "works": 301739,
                        "advanced": 62406,
                        "needTime": 239332,
                        "needYield": 0,
                        "saveState": 306,
                        "restoreState": 306,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 62406,
                           "executionTimeMillisEstimate": 13,
                           "works": 301739,
                           "advanced": 62406,
                           "needTime": 239332,
                           "needYield": 0,
                           "saveState": 306,
                           "restoreState": 306,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 62406,
                              "executionTimeMillisEstimate": 9,
                              "works": 301739,
                              "advanced": 62406,
                              "needTime": 239332,
                              "needYield": 0,
                              "saveState": 306,
                              "restoreState": 306,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 62406,
               "executionTimeMillisEstimate": 270
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 303
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 68792,
                     "executionTimeMillis": 328,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 68792,
                        "executionTimeMillisEstimate": 22,
                        "works": 347617,
                        "advanced": 68792,
                        "needTime": 278824,
                        "needYield": 0,
                        "saveState": 351,
                        "restoreState": 351,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 68792,
                           "executionTimeMillisEstimate": 21,
                           "works": 347617,
                           "advanced": 68792,
                           "needTime": 278824,
                           "needYield": 0,
                           "saveState": 351,
                           "restoreState": 351,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 68792,
                              "executionTimeMillisEstimate": 16,
                              "works": 347617,
                              "advanced": 68792,
                              "needTime": 278824,
                              "needYield": 0,
                              "saveState": 351,
                              "restoreState": 351,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 68792,
               "executionTimeMillisEstimate": 285
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 327
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 84317,
                     "executionTimeMillis": 425,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 84317,
                        "executionTimeMillisEstimate": 15,
                        "works": 460069,
                        "advanced": 84317,
                        "needTime": 375751,
                        "needYield": 0,
                        "saveState": 463,
                        "restoreState": 463,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 84317,
                           "executionTimeMillisEstimate": 11,
                           "works": 460069,
                           "advanced": 84317,
                           "needTime": 375751,
                           "needYield": 0,
                           "saveState": 463,
                           "restoreState": 463,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 84317,
                              "executionTimeMillisEstimate": 9,
                              "works": 460069,
                              "advanced": 84317,
                              "needTime": 375751,
                              "needYield": 0,
                              "saveState": 463,
                              "restoreState": 463,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 84317,
               "executionTimeMillisEstimate": 376
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 418
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425540,
         "i": 12
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425540,
            "i": 12
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 92714,
                     "executionTimeMillis": 354,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 92714,
                        "executionTimeMillisEstimate": 25,
                        "works": 301739,
                        "advanced": 92714,
                        "needTime": 209024,
                        "needYield": 0,
                        "saveState": 306,
                        "restoreState": 306,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 92714,
                           "executionTimeMillisEstimate": 23,
                           "works": 301739,
                           "advanced": 92714,
                           "needTime": 209024,
                           "needYield": 0,
                           "saveState": 306,
                           "restoreState": 306,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 92714,
                              "executionTimeMillisEstimate": 7,
                              "works": 301739,
                              "advanced": 92714,
                              "needTime": 209024,
                              "needYield": 0,
                              "saveState": 306,
                              "restoreState": 306,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 92714,
               "executionTimeMillisEstimate": 304
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 109,
               "executionTimeMillisEstimate": 354
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 108413,
                     "executionTimeMillis": 398,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 108413,
                        "executionTimeMillisEstimate": 26,
                        "works": 347617,
                        "advanced": 108413,
                        "needTime": 239203,
                        "needYield": 0,
                        "saveState": 352,
                        "restoreState": 352,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 108413,
                           "executionTimeMillisEstimate": 19,
                           "works": 347617,
                           "advanced": 108413,
                           "needTime": 239203,
                           "needYield": 0,
                           "saveState": 352,
                           "restoreState": 352,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 108413,
                              "executionTimeMillisEstimate": 7,
                              "works": 347617,
                              "advanced": 108413,
                              "needTime": 239203,
                              "needYield": 0,
                              "saveState": 352,
                              "restoreState": 352,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 108413,
               "executionTimeMillisEstimate": 339
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 131,
               "executionTimeMillisEstimate": 396
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 144167,
                     "executionTimeMillis": 542,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 144167,
                        "executionTimeMillisEstimate": 50,
                        "works": 460069,
                        "advanced": 144167,
                        "needTime": 315901,
                        "needYield": 0,
                        "saveState": 465,
                        "restoreState": 465,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 144167,
                           "executionTimeMillisEstimate": 38,
                           "works": 460069,
                           "advanced": 144167,
                           "needTime": 315901,
                           "needYield": 0,
                           "saveState": 465,
                           "restoreState": 465,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 144167,
                              "executionTimeMillisEstimate": 13,
                              "works": 460069,
                              "advanced": 144167,
                              "needTime": 315901,
                              "needYield": 0,
                              "saveState": 465,
                              "restoreState": 465,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 144167,
               "executionTimeMillisEstimate": 480
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 126,
               "executionTimeMillisEstimate": 535
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425540,
         "i": 12
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425540,
            "i": 12
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 92714,
                     "executionTimeMillis": 414,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 92714,
                        "executionTimeMillisEstimate": 45,
                        "works": 301739,
                        "advanced": 92714,
                        "needTime": 209024,
                        "needYield": 0,
                        "saveState": 306,
                        "restoreState": 306,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 92714,
                           "executionTimeMillisEstimate": 38,
                           "works": 301739,
                           "advanced": 92714,
                           "needTime": 209024,
                           "needYield": 0,
                           "saveState": 306,
                           "restoreState": 306,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 92714,
                              "executionTimeMillisEstimate": 13,
                              "works": 301739,
                              "advanced": 92714,
                              "needTime": 209024,
                              "needYield": 0,
                              "saveState": 306,
                              "restoreState": 306,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 92714,
               "executionTimeMillisEstimate": 328
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 247,
               "executionTimeMillisEstimate": 413
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 108413,
                     "executionTimeMillis": 462,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 108413,
                        "executionTimeMillisEstimate": 42,
                        "works": 347617,
                        "advanced": 108413,
                        "needTime": 239203,
                        "needYield": 0,
                        "saveState": 353,
                        "restoreState": 353,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 108413,
                           "executionTimeMillisEstimate": 38,
                           "works": 347617,
                           "advanced": 108413,
                           "needTime": 239203,
                           "needYield": 0,
                           "saveState": 353,
                           "restoreState": 353,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 108413,
                              "executionTimeMillisEstimate": 17,
                              "works": 347617,
                              "advanced": 108413,
                              "needTime": 239203,
                              "needYield": 0,
                              "saveState": 353,
                              "restoreState": 353,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 108413,
               "executionTimeMillisEstimate": 389
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 252,
               "executionTimeMillisEstimate": 454
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 144167,
                     "executionTimeMillis": 622,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 144167,
                        "executionTimeMillisEstimate": 74,
                        "works": 460069,
                        "advanced": 144167,
                        "needTime": 315901,
                        "needYield": 0,
                        "saveState": 467,
                        "restoreState": 467,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 144167,
                           "executionTimeMillisEstimate": 67,
                           "works": 460069,
                           "advanced": 144167,
                           "needTime": 315901,
                           "needYield": 0,
                           "saveState": 467,
                           "restoreState": 467,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 144167,
                              "executionTimeMillisEstimate": 31,
                              "works": 460069,
                              "advanced": 144167,
                              "needTime": 315901,
                              "needYield": 0,
                              "saveState": 467,
                              "restoreState": 467,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 144167,
               "executionTimeMillisEstimate": 527
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 299,
               "executionTimeMillisEstimate": 616
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425541,
         "i": 4263
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425541,
            "i": 4763
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 92714,
                     "executionTimeMillis": 379,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 92714,
                        "executionTimeMillisEstimate": 49,
                        "works": 301739,
                        "advanced": 92714,
                        "needTime": 209024,
                        "needYield": 0,
                        "saveState": 307,
                        "restoreState": 307,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 92714,
                           "executionTimeMillisEstimate": 32,
                           "works": 301739,
                           "advanced": 92714,
                           "needTime": 209024,
                           "needYield": 0,
                           "saveState": 307,
                           "restoreState": 307,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 92714,
                              "executionTimeMillisEstimate": 20,
                              "works": 301739,
                              "advanced": 92714,
                              "needTime": 209024,
                              "needYield": 0,
                              "saveState": 307,
                              "restoreState": 307,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 92714,
               "executionTimeMillisEstimate": 321
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 375
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 108413,
                     "executionTimeMillis": 404,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 108413,
                        "executionTimeMillisEstimate": 36,
                        "works": 347617,
                        "advanced": 108413,
                        "needTime": 239203,
                        "needYield": 0,
                        "saveState": 353,
                        "restoreState": 353,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 108413,
                           "executionTimeMillisEstimate": 25,
                           "works": 347617,
                           "advanced": 108413,
                           "needTime": 239203,
                           "needYield": 0,
                           "saveState": 353,
                           "restoreState": 353,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 108413,
                              "executionTimeMillisEstimate": 13,
                              "works": 347617,
                              "advanced": 108413,
                              "needTime": 239203,
                              "needYield": 0,
                              "saveState": 353,
                              "restoreState": 353,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 108413,
               "executionTimeMillisEstimate": 340
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 395
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 144167,
                     "executionTimeMillis": 551,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 144167,
                        "executionTimeMillisEstimate": 51,
                        "works": 460069,
                        "advanced": 144167,
                        "needTime": 315901,
                        "needYield": 0,
                        "saveState": 468,
                        "restoreState": 468,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 144167,
                           "executionTimeMillisEstimate": 44,
                           "works": 460069,
                           "advanced": 144167,
                           "needTime": 315901,
                           "needYield": 0,
                           "saveState": 468,
                           "restoreState": 468,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 144167,
                              "executionTimeMillisEstimate": 17,
                              "works": 460069,
                              "advanced": 144167,
                              "needTime": 315901,
                              "needYield": 0,
                              "saveState": 468,
                              "restoreState": 468,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 144167,
               "executionTimeMillisEstimate": 473
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 550
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425542,
         "i": 1
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425542,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 301737,
                     "executionTimeMillis": 1004,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 301737,
                        "executionTimeMillisEstimate": 62,
                        "works": 301739,
                        "advanced": 301737,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 316,
                        "restoreState": 316,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 301737,
                           "executionTimeMillisEstimate": 45,
                           "works": 301739,
                           "advanced": 301737,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 316,
                           "restoreState": 316,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 301737,
                              "executionTimeMillisEstimate": 12,
                              "works": 301739,
                              "advanced": 301737,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 316,
                              "restoreState": 316,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 301737,
               "executionTimeMillisEstimate": 626
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 373,
               "executionTimeMillisEstimate": 1001
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 347615,
                     "executionTimeMillis": 1050,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 347615,
                        "executionTimeMillisEstimate": 62,
                        "works": 347617,
                        "advanced": 347615,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 365,
                        "restoreState": 365,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 347615,
                           "executionTimeMillisEstimate": 49,
                           "works": 347617,
                           "advanced": 347615,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 365,
                           "restoreState": 365,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 347615,
                              "executionTimeMillisEstimate": 4,
                              "works": 347617,
                              "advanced": 347615,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 365,
                              "restoreState": 365,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 347615,
               "executionTimeMillisEstimate": 703
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 410,
               "executionTimeMillisEstimate": 1047
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 460067,
                     "executionTimeMillis": 1425,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 460067,
                        "executionTimeMillisEstimate": 79,
                        "works": 460069,
                        "advanced": 460067,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 482,
                        "restoreState": 482,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 460067,
                           "executionTimeMillisEstimate": 64,
                           "works": 460069,
                           "advanced": 460067,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 482,
                           "restoreState": 482,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 460067,
                              "executionTimeMillisEstimate": 18,
                              "works": 460069,
                              "advanced": 460067,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 482,
                              "restoreState": 482,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 460067,
               "executionTimeMillisEstimate": 909
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 420,
               "executionTimeMillisEstimate": 1422
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425542,
         "i": 558
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425542,
            "i": 558
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 301737,
                     "executionTimeMillis": 1069,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 301737,
                        "executionTimeMillisEstimate": 112,
                        "works": 301739,
                        "advanced": 301737,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 324,
                        "restoreState": 324,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 301737,
                           "executionTimeMillisEstimate": 89,
                           "works": 301739,
                           "advanced": 301737,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 324,
                           "restoreState": 324,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 301737,
                              "executionTimeMillisEstimate": 17,
                              "works": 301739,
                              "advanced": 301737,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 324,
                              "restoreState": 324,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 301737,
               "executionTimeMillisEstimate": 660
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 641,
               "executionTimeMillisEstimate": 1065
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 347615,
                     "executionTimeMillis": 1118,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 347615,
                        "executionTimeMillisEstimate": 94,
                        "works": 347617,
                        "advanced": 347615,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 373,
                        "restoreState": 373,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 347615,
                           "executionTimeMillisEstimate": 74,
                           "works": 347617,
                           "advanced": 347615,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 373,
                           "restoreState": 373,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 347615,
                              "executionTimeMillisEstimate": 17,
                              "works": 347617,
                              "advanced": 347615,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 373,
                              "restoreState": 373,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 347615,
               "executionTimeMillisEstimate": 721
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 703,
               "executionTimeMillisEstimate": 1110
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 460067,
                     "executionTimeMillis": 1510,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 460067,
                        "executionTimeMillisEstimate": 118,
                        "works": 460069,
                        "advanced": 460067,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 494,
                        "restoreState": 494,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 460067,
                           "executionTimeMillisEstimate": 85,
                           "works": 460069,
                           "advanced": 460067,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 494,
                           "restoreState": 494,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 460067,
                              "executionTimeMillisEstimate": 14,
                              "works": 460069,
                              "advanced": 460067,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 494,
                              "restoreState": 494,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 460067,
               "executionTimeMillisEstimate": 985
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 949,
               "executionTimeMillisEstimate": 1504
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425544,
         "i": 5345
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425544,
            "i": 5345
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 4738,
            "executionTimeMillis": 146,
            "totalKeysExamined": 0,
            "totalDocsExamined": 301737,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 4738,
               "executionTimeMillisEstimate": 4,
               "works": 301739,
               "advanced": 4738,
               "needTime": 297000,
               "needYield": 0,
               "saveState": 301,
               "restoreState": 301,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 4738,
                  "executionTimeMillisEstimate": 3,
                  "works": 301739,
                  "advanced": 4738,
                  "needTime": 297000,
                  "needYield": 0,
                  "saveState": 301,
                  "restoreState": 301,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 301737
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 4540,
            "executionTimeMillis": 166,
            "totalKeysExamined": 0,
            "totalDocsExamined": 347615,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 4540,
               "executionTimeMillisEstimate": 3,
               "works": 347617,
               "advanced": 4540,
               "needTime": 343076,
               "needYield": 0,
               "saveState": 347,
               "restoreState": 347,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 4540,
                  "executionTimeMillisEstimate": 3,
                  "works": 347617,
                  "advanced": 4540,
                  "needTime": 343076,
                  "needYield": 0,
                  "saveState": 347,
                  "restoreState": 347,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 347615
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 5547,
            "executionTimeMillis": 220,
            "totalKeysExamined": 0,
            "totalDocsExamined": 460067,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 5547,
               "executionTimeMillisEstimate": 5,
               "works": 460069,
               "advanced": 5547,
               "needTime": 454521,
               "needYield": 0,
               "saveState": 460,
               "restoreState": 460,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 5547,
                  "executionTimeMillisEstimate": 5,
                  "works": 460069,
                  "advanced": 5547,
                  "needTime": 454521,
                  "needYield": 0,
                  "saveState": 460,
                  "restoreState": 460,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 460067
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425544,
         "i": 6782
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425544,
            "i": 6782
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 301737,
                     "executionTimeMillis": 1375,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 301737,
                        "executionTimeMillisEstimate": 260,
                        "works": 301739,
                        "advanced": 301737,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 338,
                        "restoreState": 338,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 301737,
                           "executionTimeMillisEstimate": 118,
                           "works": 301739,
                           "advanced": 301737,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 338,
                           "restoreState": 338,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 301737,
                              "executionTimeMillisEstimate": 27,
                              "works": 301739,
                              "advanced": 301737,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 338,
                              "restoreState": 338,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 301737,
               "executionTimeMillisEstimate": 1156
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 768,
               "executionTimeMillisEstimate": 1373
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 347615,
                     "executionTimeMillis": 1549,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 347615,
                        "executionTimeMillisEstimate": 221,
                        "works": 347617,
                        "advanced": 347615,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 389,
                        "restoreState": 389,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 347615,
                           "executionTimeMillisEstimate": 91,
                           "works": 347617,
                           "advanced": 347615,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 389,
                           "restoreState": 389,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 347615,
                              "executionTimeMillisEstimate": 27,
                              "works": 347617,
                              "advanced": 347615,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 389,
                              "restoreState": 389,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 347615,
               "executionTimeMillisEstimate": 1329
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 904,
               "executionTimeMillisEstimate": 1544
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 460067,
                     "executionTimeMillis": 2014,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 460067,
                        "executionTimeMillisEstimate": 345,
                        "works": 460069,
                        "advanced": 460067,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 514,
                        "restoreState": 514,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 460067,
                           "executionTimeMillisEstimate": 143,
                           "works": 460069,
                           "advanced": 460067,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 514,
                           "restoreState": 514,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 460067,
                              "executionTimeMillisEstimate": 24,
                              "works": 460069,
                              "advanced": 460067,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 514,
                              "restoreState": 514,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 460067,
               "executionTimeMillisEstimate": 1729
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 880,
               "executionTimeMillisEstimate": 2013
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425547,
         "i": 366
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425547,
            "i": 368
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 301737,
                     "executionTimeMillis": 1296,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 301737,
                        "executionTimeMillisEstimate": 182,
                        "works": 301739,
                        "advanced": 301737,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 338,
                        "restoreState": 338,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 301737,
                           "executionTimeMillisEstimate": 57,
                           "works": 301739,
                           "advanced": 301737,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 338,
                           "restoreState": 338,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 301737,
                              "executionTimeMillisEstimate": 15,
                              "works": 301739,
                              "advanced": 301737,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 338,
                              "restoreState": 338,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 301737,
               "executionTimeMillisEstimate": 1101
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1698,
               "executionTimeMillisEstimate": 1294
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 347615,
                     "executionTimeMillis": 1481,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 347615,
                        "executionTimeMillisEstimate": 211,
                        "works": 347617,
                        "advanced": 347615,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 389,
                        "restoreState": 389,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 347615,
                           "executionTimeMillisEstimate": 79,
                           "works": 347617,
                           "advanced": 347615,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 389,
                           "restoreState": 389,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 347615,
                              "executionTimeMillisEstimate": 11,
                              "works": 347617,
                              "advanced": 347615,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 389,
                              "restoreState": 389,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 347615,
               "executionTimeMillisEstimate": 1281
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1779,
               "executionTimeMillisEstimate": 1475
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 460067,
                     "executionTimeMillis": 1944,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 460067,
                        "executionTimeMillisEstimate": 299,
                        "works": 460069,
                        "advanced": 460067,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 514,
                        "restoreState": 514,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 460067,
                           "executionTimeMillisEstimate": 121,
                           "works": 460069,
                           "advanced": 460067,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 514,
                           "restoreState": 514,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 460067,
                              "executionTimeMillisEstimate": 22,
                              "works": 460069,
                              "advanced": 460067,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 514,
                              "restoreState": 514,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 460067,
               "executionTimeMillisEstimate": 1678
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2073,
               "executionTimeMillisEstimate": 1939
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425547,
         "i": 4329
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425548,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 301737,
                     "executionTimeMillis": 765,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 301737,
                        "executionTimeMillisEstimate": 69,
                        "works": 301739,
                        "advanced": 301737,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 313,
                        "restoreState": 313,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 301737,
                           "executionTimeMillisEstimate": 62,
                           "works": 301739,
                           "advanced": 301737,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 313,
                           "restoreState": 313,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 301737,
                              "executionTimeMillisEstimate": 21,
                              "works": 301739,
                              "advanced": 301737,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 313,
                              "restoreState": 313,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 301737,
               "executionTimeMillisEstimate": 576
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 759
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 347615,
                     "executionTimeMillis": 819,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 347615,
                        "executionTimeMillisEstimate": 65,
                        "works": 347617,
                        "advanced": 347615,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 360,
                        "restoreState": 360,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 347615,
                           "executionTimeMillisEstimate": 52,
                           "works": 347617,
                           "advanced": 347615,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 360,
                           "restoreState": 360,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 347615,
                              "executionTimeMillisEstimate": 12,
                              "works": 347617,
                              "advanced": 347615,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 360,
                              "restoreState": 360,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 347615,
               "executionTimeMillisEstimate": 618
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 811
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 460067,
                     "executionTimeMillis": 1077,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 460067,
                        "executionTimeMillisEstimate": 75,
                        "works": 460069,
                        "advanced": 460067,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 478,
                        "restoreState": 478,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 460067,
                           "executionTimeMillisEstimate": 66,
                           "works": 460069,
                           "advanced": 460067,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 478,
                           "restoreState": 478,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 460067,
                              "executionTimeMillisEstimate": 11,
                              "works": 460069,
                              "advanced": 460067,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 478,
                              "restoreState": 478,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 460067,
               "executionTimeMillisEstimate": 827
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1076
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425549,
         "i": 5697
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425549,
            "i": 5697
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 49202,
                     "executionTimeMillis": 263,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 49202,
                        "executionTimeMillisEstimate": 18,
                        "works": 301739,
                        "advanced": 49202,
                        "needTime": 252536,
                        "needYield": 0,
                        "saveState": 304,
                        "restoreState": 304,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 49202,
                           "executionTimeMillisEstimate": 16,
                           "works": 301739,
                           "advanced": 49202,
                           "needTime": 252536,
                           "needYield": 0,
                           "saveState": 304,
                           "restoreState": 304,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 49202,
                              "executionTimeMillisEstimate": 7,
                              "works": 301739,
                              "advanced": 49202,
                              "needTime": 252536,
                              "needYield": 0,
                              "saveState": 304,
                              "restoreState": 304,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 49202,
               "executionTimeMillisEstimate": 238
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 108,
               "executionTimeMillisEstimate": 257
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 56948,
                     "executionTimeMillis": 298,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 56948,
                        "executionTimeMillisEstimate": 10,
                        "works": 347617,
                        "advanced": 56948,
                        "needTime": 290668,
                        "needYield": 0,
                        "saveState": 350,
                        "restoreState": 350,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 56948,
                           "executionTimeMillisEstimate": 10,
                           "works": 347617,
                           "advanced": 56948,
                           "needTime": 290668,
                           "needYield": 0,
                           "saveState": 350,
                           "restoreState": 350,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 56948,
                              "executionTimeMillisEstimate": 8,
                              "works": 347617,
                              "advanced": 56948,
                              "needTime": 290668,
                              "needYield": 0,
                              "saveState": 350,
                              "restoreState": 350,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 56948,
               "executionTimeMillisEstimate": 263
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 131,
               "executionTimeMillisEstimate": 299
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76503,
                     "executionTimeMillis": 400,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76503,
                        "executionTimeMillisEstimate": 30,
                        "works": 460069,
                        "advanced": 76503,
                        "needTime": 383565,
                        "needYield": 0,
                        "saveState": 464,
                        "restoreState": 464,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76503,
                           "executionTimeMillisEstimate": 23,
                           "works": 460069,
                           "advanced": 76503,
                           "needTime": 383565,
                           "needYield": 0,
                           "saveState": 464,
                           "restoreState": 464,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 76503,
                              "executionTimeMillisEstimate": 14,
                              "works": 460069,
                              "advanced": 76503,
                              "needTime": 383565,
                              "needYield": 0,
                              "saveState": 464,
                              "restoreState": 464,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 76503,
               "executionTimeMillisEstimate": 367
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 126,
               "executionTimeMillisEstimate": 397
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425549,
         "i": 5697
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425550,
            "i": 2
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 49202,
                     "executionTimeMillis": 271,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 301737,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 49202,
                        "executionTimeMillisEstimate": 34,
                        "works": 301739,
                        "advanced": 49202,
                        "needTime": 252536,
                        "needYield": 0,
                        "saveState": 304,
                        "restoreState": 304,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 49202,
                           "executionTimeMillisEstimate": 31,
                           "works": 301739,
                           "advanced": 49202,
                           "needTime": 252536,
                           "needYield": 0,
                           "saveState": 304,
                           "restoreState": 304,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 49202,
                              "executionTimeMillisEstimate": 19,
                              "works": 301739,
                              "advanced": 49202,
                              "needTime": 252536,
                              "needYield": 0,
                              "saveState": 304,
                              "restoreState": 304,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 301737
                           }
                        }
                     }
                  }
               },
               "nReturned": 49202,
               "executionTimeMillisEstimate": 239
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 245,
               "executionTimeMillisEstimate": 264
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 56948,
                     "executionTimeMillis": 309,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 347615,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 56948,
                        "executionTimeMillisEstimate": 41,
                        "works": 347617,
                        "advanced": 56948,
                        "needTime": 290668,
                        "needYield": 0,
                        "saveState": 350,
                        "restoreState": 350,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 56948,
                           "executionTimeMillisEstimate": 38,
                           "works": 347617,
                           "advanced": 56948,
                           "needTime": 290668,
                           "needYield": 0,
                           "saveState": 350,
                           "restoreState": 350,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 56948,
                              "executionTimeMillisEstimate": 27,
                              "works": 347617,
                              "advanced": 56948,
                              "needTime": 290668,
                              "needYield": 0,
                              "saveState": 350,
                              "restoreState": 350,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 347615
                           }
                        }
                     }
                  }
               },
               "nReturned": 56948,
               "executionTimeMillisEstimate": 284
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 249,
               "executionTimeMillisEstimate": 307
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 76503,
                     "executionTimeMillis": 405,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 460067,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 76503,
                        "executionTimeMillisEstimate": 32,
                        "works": 460069,
                        "advanced": 76503,
                        "needTime": 383565,
                        "needYield": 0,
                        "saveState": 463,
                        "restoreState": 463,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 76503,
                           "executionTimeMillisEstimate": 32,
                           "works": 460069,
                           "advanced": 76503,
                           "needTime": 383565,
                           "needYield": 0,
                           "saveState": 463,
                           "restoreState": 463,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 76503,
                              "executionTimeMillisEstimate": 19,
                              "works": 460069,
                              "advanced": 76503,
                              "needTime": 383565,
                              "needYield": 0,
                              "saveState": 463,
                              "restoreState": 463,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 460067
                           }
                        }
                     }
                  }
               },
               "nReturned": 76503,
               "executionTimeMillisEstimate": 362
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 298,
               "executionTimeMillisEstimate": 403
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425551,
         "i": 21
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425551,
            "i": 21
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_ORIGIN_range<a name="AirlineData_ORIGIN_range"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 113,
            "totalKeysExamined": 0,
            "totalDocsExamined": 123131,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 12,
               "works": 123133,
               "advanced": 0,
               "needTime": 123132,
               "needYield": 0,
               "saveState": 123,
               "restoreState": 123,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 12,
                  "works": 123133,
                  "advanced": 0,
                  "needTime": 123132,
                  "needYield": 0,
                  "saveState": 123,
                  "restoreState": 123,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 123131
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 314,
            "totalKeysExamined": 0,
            "totalDocsExamined": 149456,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 60,
               "works": 149458,
               "advanced": 1,
               "needTime": 149456,
               "needYield": 0,
               "saveState": 149,
               "restoreState": 149,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 60,
                  "works": 149458,
                  "advanced": 1,
                  "needTime": 149456,
                  "needYield": 0,
                  "saveState": 149,
                  "restoreState": 149,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 149456
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 2043,
            "totalKeysExamined": 0,
            "totalDocsExamined": 954952,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 383,
               "works": 954954,
               "advanced": 1,
               "needTime": 954952,
               "needYield": 0,
               "saveState": 954,
               "restoreState": 954,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 381,
                  "works": 954954,
                  "advanced": 1,
                  "needTime": 954952,
                  "needYield": 0,
                  "saveState": 954,
                  "restoreState": 954,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 954952
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425553,
         "i": 908
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425553,
            "i": 908
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 123131,
                     "executionTimeMillis": 319,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 123131,
                        "executionTimeMillisEstimate": 25,
                        "works": 123133,
                        "advanced": 123131,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 129,
                        "restoreState": 129,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 123131,
                           "executionTimeMillisEstimate": 16,
                           "works": 123133,
                           "advanced": 123131,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 129,
                           "restoreState": 129,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 123131,
                              "executionTimeMillisEstimate": 3,
                              "works": 123133,
                              "advanced": 123131,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 129,
                              "restoreState": 129,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 123131,
               "executionTimeMillisEstimate": 230
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 317
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 149456,
                     "executionTimeMillis": 380,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 149456,
                        "executionTimeMillisEstimate": 39,
                        "works": 149458,
                        "advanced": 149456,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 157,
                        "restoreState": 157,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 149456,
                           "executionTimeMillisEstimate": 18,
                           "works": 149458,
                           "advanced": 149456,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 157,
                           "restoreState": 157,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 149456,
                              "executionTimeMillisEstimate": 4,
                              "works": 149458,
                              "advanced": 149456,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 157,
                              "restoreState": 157,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 149456,
               "executionTimeMillisEstimate": 296
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 376
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 836832,
                     "executionTimeMillis": 2349,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 954952,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 836832,
                        "executionTimeMillisEstimate": 206,
                        "works": 954954,
                        "advanced": 836832,
                        "needTime": 118121,
                        "needYield": 0,
                        "saveState": 997,
                        "restoreState": 997,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 836832,
                           "executionTimeMillisEstimate": 163,
                           "works": 954954,
                           "advanced": 836832,
                           "needTime": 118121,
                           "needYield": 0,
                           "saveState": 997,
                           "restoreState": 997,
                           "isEOF": 1,
                           "chunkSkips": 118120,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 954952,
                              "executionTimeMillisEstimate": 42,
                              "works": 954954,
                              "advanced": 954952,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 997,
                              "restoreState": 997,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 954952
                           }
                        }
                     }
                  }
               },
               "nReturned": 836832,
               "executionTimeMillisEstimate": 1780
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2341
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425555,
         "i": 847
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425555,
            "i": 847
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 123131,
                     "executionTimeMillis": 271,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 123131,
                        "executionTimeMillisEstimate": 18,
                        "works": 123133,
                        "advanced": 123131,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 127,
                        "restoreState": 127,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 123131,
                           "executionTimeMillisEstimate": 13,
                           "works": 123133,
                           "advanced": 123131,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 127,
                           "restoreState": 127,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 123131,
                              "executionTimeMillisEstimate": 5,
                              "works": 123133,
                              "advanced": 123131,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 127,
                              "restoreState": 127,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 123131,
               "executionTimeMillisEstimate": 197
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 122,
               "executionTimeMillisEstimate": 262
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 149456,
                     "executionTimeMillis": 323,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 149456,
                        "executionTimeMillisEstimate": 18,
                        "works": 149458,
                        "advanced": 149456,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 155,
                        "restoreState": 155,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 149456,
                           "executionTimeMillisEstimate": 15,
                           "works": 149458,
                           "advanced": 149456,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 155,
                           "restoreState": 155,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 149456,
                              "executionTimeMillisEstimate": 4,
                              "works": 149458,
                              "advanced": 149456,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 155,
                              "restoreState": 155,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 149456,
               "executionTimeMillisEstimate": 233
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 153,
               "executionTimeMillisEstimate": 320
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 836832,
                     "executionTimeMillis": 2214,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 954360,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 836832,
                        "executionTimeMillisEstimate": 173,
                        "works": 954362,
                        "advanced": 836832,
                        "needTime": 117529,
                        "needYield": 0,
                        "saveState": 1000,
                        "restoreState": 1000,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 836832,
                           "executionTimeMillisEstimate": 140,
                           "works": 954362,
                           "advanced": 836832,
                           "needTime": 117529,
                           "needYield": 0,
                           "saveState": 1000,
                           "restoreState": 1000,
                           "isEOF": 1,
                           "chunkSkips": 117528,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 954360,
                              "executionTimeMillisEstimate": 31,
                              "works": 954362,
                              "advanced": 954360,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1000,
                              "restoreState": 1000,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 954360
                           }
                        }
                     }
                  }
               },
               "nReturned": 836832,
               "executionTimeMillisEstimate": 1658
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 95,
               "executionTimeMillisEstimate": 2213
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425557,
         "i": 1686
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425557,
            "i": 1695
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 123131,
                     "executionTimeMillis": 285,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 123131,
                        "executionTimeMillisEstimate": 20,
                        "works": 123133,
                        "advanced": 123131,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 129,
                        "restoreState": 129,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 123131,
                           "executionTimeMillisEstimate": 15,
                           "works": 123133,
                           "advanced": 123131,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 129,
                           "restoreState": 129,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 123131,
                              "executionTimeMillisEstimate": 6,
                              "works": 123133,
                              "advanced": 123131,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 129,
                              "restoreState": 129,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 123131,
               "executionTimeMillisEstimate": 227
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 130,
               "executionTimeMillisEstimate": 283
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 149456,
                     "executionTimeMillis": 336,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 149456,
                        "executionTimeMillisEstimate": 37,
                        "works": 149458,
                        "advanced": 149456,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 157,
                        "restoreState": 157,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 149456,
                           "executionTimeMillisEstimate": 27,
                           "works": 149458,
                           "advanced": 149456,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 157,
                           "restoreState": 157,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 149456,
                              "executionTimeMillisEstimate": 3,
                              "works": 149458,
                              "advanced": 149456,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 157,
                              "restoreState": 157,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 149456,
               "executionTimeMillisEstimate": 257
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 162,
               "executionTimeMillisEstimate": 335
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 836832,
                     "executionTimeMillis": 2129,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 952336,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 836832,
                        "executionTimeMillisEstimate": 163,
                        "works": 952338,
                        "advanced": 836832,
                        "needTime": 115505,
                        "needYield": 0,
                        "saveState": 989,
                        "restoreState": 989,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 836832,
                           "executionTimeMillisEstimate": 130,
                           "works": 952338,
                           "advanced": 836832,
                           "needTime": 115505,
                           "needYield": 0,
                           "saveState": 989,
                           "restoreState": 989,
                           "isEOF": 1,
                           "chunkSkips": 115504,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 952336,
                              "executionTimeMillisEstimate": 27,
                              "works": 952338,
                              "advanced": 952336,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 989,
                              "restoreState": 989,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 952336
                           }
                        }
                     }
                  }
               },
               "nReturned": 836832,
               "executionTimeMillisEstimate": 1625
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 354,
               "executionTimeMillisEstimate": 2122
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425560,
         "i": 3
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425560,
            "i": 11
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 23897,
                     "executionTimeMillis": 117,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 23897,
                        "executionTimeMillisEstimate": 9,
                        "works": 123133,
                        "advanced": 23897,
                        "needTime": 99235,
                        "needYield": 0,
                        "saveState": 124,
                        "restoreState": 124,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 23897,
                           "executionTimeMillisEstimate": 8,
                           "works": 123133,
                           "advanced": 23897,
                           "needTime": 99235,
                           "needYield": 0,
                           "saveState": 124,
                           "restoreState": 124,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 23897,
                              "executionTimeMillisEstimate": 5,
                              "works": 123133,
                              "advanced": 23897,
                              "needTime": 99235,
                              "needYield": 0,
                              "saveState": 124,
                              "restoreState": 124,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 23897,
               "executionTimeMillisEstimate": 100
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 122,
               "executionTimeMillisEstimate": 117
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 29390,
                     "executionTimeMillis": 141,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 29390,
                        "executionTimeMillisEstimate": 6,
                        "works": 149458,
                        "advanced": 29390,
                        "needTime": 120067,
                        "needYield": 0,
                        "saveState": 150,
                        "restoreState": 150,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 29390,
                           "executionTimeMillisEstimate": 6,
                           "works": 149458,
                           "advanced": 29390,
                           "needTime": 120067,
                           "needYield": 0,
                           "saveState": 150,
                           "restoreState": 150,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 29390,
                              "executionTimeMillisEstimate": 1,
                              "works": 149458,
                              "advanced": 29390,
                              "needTime": 120067,
                              "needYield": 0,
                              "saveState": 150,
                              "restoreState": 150,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 29390,
               "executionTimeMillisEstimate": 121
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 152,
               "executionTimeMillisEstimate": 137
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 162228,
                     "executionTimeMillis": 859,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 951918,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 162228,
                        "executionTimeMillisEstimate": 40,
                        "works": 951920,
                        "advanced": 162228,
                        "needTime": 789691,
                        "needYield": 0,
                        "saveState": 960,
                        "restoreState": 960,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 162228,
                           "executionTimeMillisEstimate": 36,
                           "works": 951920,
                           "advanced": 162228,
                           "needTime": 789691,
                           "needYield": 0,
                           "saveState": 960,
                           "restoreState": 960,
                           "isEOF": 1,
                           "chunkSkips": 21403,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 183631,
                              "executionTimeMillisEstimate": 24,
                              "works": 951920,
                              "advanced": 183631,
                              "needTime": 768288,
                              "needYield": 0,
                              "saveState": 960,
                              "restoreState": 960,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 951918
                           }
                        }
                     }
                  }
               },
               "nReturned": 162228,
               "executionTimeMillisEstimate": 742
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 95,
               "executionTimeMillisEstimate": 855
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425561,
         "i": 515
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425561,
            "i": 515
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 23897,
                     "executionTimeMillis": 106,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 23897,
                        "executionTimeMillisEstimate": 1,
                        "works": 123133,
                        "advanced": 23897,
                        "needTime": 99235,
                        "needYield": 0,
                        "saveState": 124,
                        "restoreState": 124,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 23897,
                           "executionTimeMillisEstimate": 1,
                           "works": 123133,
                           "advanced": 23897,
                           "needTime": 99235,
                           "needYield": 0,
                           "saveState": 124,
                           "restoreState": 124,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 23897,
                              "executionTimeMillisEstimate": 1,
                              "works": 123133,
                              "advanced": 23897,
                              "needTime": 99235,
                              "needYield": 0,
                              "saveState": 124,
                              "restoreState": 124,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 23897,
               "executionTimeMillisEstimate": 88
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 123,
               "executionTimeMillisEstimate": 96
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 29390,
                     "executionTimeMillis": 131,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 29390,
                        "executionTimeMillisEstimate": 8,
                        "works": 149458,
                        "advanced": 29390,
                        "needTime": 120067,
                        "needYield": 0,
                        "saveState": 150,
                        "restoreState": 150,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 29390,
                           "executionTimeMillisEstimate": 6,
                           "works": 149458,
                           "advanced": 29390,
                           "needTime": 120067,
                           "needYield": 0,
                           "saveState": 150,
                           "restoreState": 150,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 29390,
                              "executionTimeMillisEstimate": 5,
                              "works": 149458,
                              "advanced": 29390,
                              "needTime": 120067,
                              "needYield": 0,
                              "saveState": 150,
                              "restoreState": 150,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 29390,
               "executionTimeMillisEstimate": 111
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 154,
               "executionTimeMillisEstimate": 126
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 162228,
                     "executionTimeMillis": 829,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 951918,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 162228,
                        "executionTimeMillisEstimate": 56,
                        "works": 951920,
                        "advanced": 162228,
                        "needTime": 789691,
                        "needYield": 0,
                        "saveState": 960,
                        "restoreState": 960,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 162228,
                           "executionTimeMillisEstimate": 49,
                           "works": 951920,
                           "advanced": 162228,
                           "needTime": 789691,
                           "needYield": 0,
                           "saveState": 960,
                           "restoreState": 960,
                           "isEOF": 1,
                           "chunkSkips": 21403,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 183631,
                              "executionTimeMillisEstimate": 27,
                              "works": 951920,
                              "advanced": 183631,
                              "needTime": 768288,
                              "needYield": 0,
                              "saveState": 960,
                              "restoreState": 960,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 951918
                           }
                        }
                     }
                  }
               },
               "nReturned": 162228,
               "executionTimeMillisEstimate": 728
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 352,
               "executionTimeMillisEstimate": 825
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425561,
         "i": 4093
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425561,
            "i": 4101
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 23897,
                     "executionTimeMillis": 123,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 23897,
                        "executionTimeMillisEstimate": 10,
                        "works": 123133,
                        "advanced": 23897,
                        "needTime": 99235,
                        "needYield": 0,
                        "saveState": 124,
                        "restoreState": 124,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 23897,
                           "executionTimeMillisEstimate": 10,
                           "works": 123133,
                           "advanced": 23897,
                           "needTime": 99235,
                           "needYield": 0,
                           "saveState": 124,
                           "restoreState": 124,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 23897,
                              "executionTimeMillisEstimate": 5,
                              "works": 123133,
                              "advanced": 23897,
                              "needTime": 99235,
                              "needYield": 0,
                              "saveState": 124,
                              "restoreState": 124,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 23897,
               "executionTimeMillisEstimate": 106
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 123
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 29390,
                     "executionTimeMillis": 150,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 29390,
                        "executionTimeMillisEstimate": 8,
                        "works": 149458,
                        "advanced": 29390,
                        "needTime": 120067,
                        "needYield": 0,
                        "saveState": 151,
                        "restoreState": 151,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 29390,
                           "executionTimeMillisEstimate": 8,
                           "works": 149458,
                           "advanced": 29390,
                           "needTime": 120067,
                           "needYield": 0,
                           "saveState": 151,
                           "restoreState": 151,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 29390,
                              "executionTimeMillisEstimate": 6,
                              "works": 149458,
                              "advanced": 29390,
                              "needTime": 120067,
                              "needYield": 0,
                              "saveState": 151,
                              "restoreState": 151,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 29390,
               "executionTimeMillisEstimate": 128
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 149
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 162228,
                     "executionTimeMillis": 890,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 951918,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 162228,
                        "executionTimeMillisEstimate": 47,
                        "works": 951920,
                        "advanced": 162228,
                        "needTime": 789691,
                        "needYield": 0,
                        "saveState": 961,
                        "restoreState": 961,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 162228,
                           "executionTimeMillisEstimate": 44,
                           "works": 951920,
                           "advanced": 162228,
                           "needTime": 789691,
                           "needYield": 0,
                           "saveState": 961,
                           "restoreState": 961,
                           "isEOF": 1,
                           "chunkSkips": 21403,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 183631,
                              "executionTimeMillisEstimate": 31,
                              "works": 951920,
                              "advanced": 183631,
                              "needTime": 768288,
                              "needYield": 0,
                              "saveState": 961,
                              "restoreState": 961,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 951918
                           }
                        }
                     }
                  }
               },
               "nReturned": 162228,
               "executionTimeMillisEstimate": 792
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 888
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425562,
         "i": 753
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425562,
            "i": 753
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 38172,
                     "executionTimeMillis": 135,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 38172,
                        "executionTimeMillisEstimate": 6,
                        "works": 123133,
                        "advanced": 38172,
                        "needTime": 84960,
                        "needYield": 0,
                        "saveState": 125,
                        "restoreState": 125,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 38172,
                           "executionTimeMillisEstimate": 5,
                           "works": 123133,
                           "advanced": 38172,
                           "needTime": 84960,
                           "needYield": 0,
                           "saveState": 125,
                           "restoreState": 125,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 38172,
                              "executionTimeMillisEstimate": 3,
                              "works": 123133,
                              "advanced": 38172,
                              "needTime": 84960,
                              "needYield": 0,
                              "saveState": 125,
                              "restoreState": 125,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 38172,
               "executionTimeMillisEstimate": 107
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 120,
               "executionTimeMillisEstimate": 129
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 45667,
                     "executionTimeMillis": 164,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 45667,
                        "executionTimeMillisEstimate": 13,
                        "works": 149458,
                        "advanced": 45667,
                        "needTime": 103790,
                        "needYield": 0,
                        "saveState": 151,
                        "restoreState": 151,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 45667,
                           "executionTimeMillisEstimate": 11,
                           "works": 149458,
                           "advanced": 45667,
                           "needTime": 103790,
                           "needYield": 0,
                           "saveState": 151,
                           "restoreState": 151,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 45667,
                              "executionTimeMillisEstimate": 5,
                              "works": 149458,
                              "advanced": 45667,
                              "needTime": 103790,
                              "needYield": 0,
                              "saveState": 151,
                              "restoreState": 151,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 45667,
               "executionTimeMillisEstimate": 144
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 152,
               "executionTimeMillisEstimate": 155
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 261455,
                     "executionTimeMillis": 1097,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948977,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 261455,
                        "executionTimeMillisEstimate": 100,
                        "works": 948979,
                        "advanced": 261455,
                        "needTime": 687523,
                        "needYield": 0,
                        "saveState": 959,
                        "restoreState": 959,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 261455,
                           "executionTimeMillisEstimate": 82,
                           "works": 948979,
                           "advanced": 261455,
                           "needTime": 687523,
                           "needYield": 0,
                           "saveState": 959,
                           "restoreState": 959,
                           "isEOF": 1,
                           "chunkSkips": 33921,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 295376,
                              "executionTimeMillisEstimate": 33,
                              "works": 948979,
                              "advanced": 295376,
                              "needTime": 653602,
                              "needYield": 0,
                              "saveState": 959,
                              "restoreState": 959,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948977
                           }
                        }
                     }
                  }
               },
               "nReturned": 261455,
               "executionTimeMillisEstimate": 903
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 94,
               "executionTimeMillisEstimate": 1093
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425563,
         "i": 3558
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425563,
            "i": 3566
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 38172,
                     "executionTimeMillis": 133,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 38172,
                        "executionTimeMillisEstimate": 11,
                        "works": 123133,
                        "advanced": 38172,
                        "needTime": 84960,
                        "needYield": 0,
                        "saveState": 126,
                        "restoreState": 126,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 38172,
                           "executionTimeMillisEstimate": 11,
                           "works": 123133,
                           "advanced": 38172,
                           "needTime": 84960,
                           "needYield": 0,
                           "saveState": 126,
                           "restoreState": 126,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 38172,
                              "executionTimeMillisEstimate": 6,
                              "works": 123133,
                              "advanced": 38172,
                              "needTime": 84960,
                              "needYield": 0,
                              "saveState": 126,
                              "restoreState": 126,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 38172,
               "executionTimeMillisEstimate": 116
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 116,
               "executionTimeMillisEstimate": 129
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 45667,
                     "executionTimeMillis": 162,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 45667,
                        "executionTimeMillisEstimate": 12,
                        "works": 149458,
                        "advanced": 45667,
                        "needTime": 103790,
                        "needYield": 0,
                        "saveState": 152,
                        "restoreState": 152,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 45667,
                           "executionTimeMillisEstimate": 10,
                           "works": 149458,
                           "advanced": 45667,
                           "needTime": 103790,
                           "needYield": 0,
                           "saveState": 152,
                           "restoreState": 152,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 45667,
                              "executionTimeMillisEstimate": 7,
                              "works": 149458,
                              "advanced": 45667,
                              "needTime": 103790,
                              "needYield": 0,
                              "saveState": 152,
                              "restoreState": 152,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 45667,
               "executionTimeMillisEstimate": 137
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 141,
               "executionTimeMillisEstimate": 156
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 261455,
                     "executionTimeMillis": 1055,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948909,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 261455,
                        "executionTimeMillisEstimate": 83,
                        "works": 948911,
                        "advanced": 261455,
                        "needTime": 687455,
                        "needYield": 0,
                        "saveState": 963,
                        "restoreState": 963,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 261455,
                           "executionTimeMillisEstimate": 71,
                           "works": 948911,
                           "advanced": 261455,
                           "needTime": 687455,
                           "needYield": 0,
                           "saveState": 963,
                           "restoreState": 963,
                           "isEOF": 1,
                           "chunkSkips": 33853,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 295308,
                              "executionTimeMillisEstimate": 35,
                              "works": 948911,
                              "advanced": 295308,
                              "needTime": 653602,
                              "needYield": 0,
                              "saveState": 963,
                              "restoreState": 963,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948909
                           }
                        }
                     }
                  }
               },
               "nReturned": 261455,
               "executionTimeMillisEstimate": 864
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 350,
               "executionTimeMillisEstimate": 1054
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425565,
         "i": 1
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425565,
            "i": 1
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 38172,
                     "executionTimeMillis": 143,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 38172,
                        "executionTimeMillisEstimate": 10,
                        "works": 123133,
                        "advanced": 38172,
                        "needTime": 84960,
                        "needYield": 0,
                        "saveState": 125,
                        "restoreState": 125,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 38172,
                           "executionTimeMillisEstimate": 9,
                           "works": 123133,
                           "advanced": 38172,
                           "needTime": 84960,
                           "needYield": 0,
                           "saveState": 125,
                           "restoreState": 125,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 38172,
                              "executionTimeMillisEstimate": 4,
                              "works": 123133,
                              "advanced": 38172,
                              "needTime": 84960,
                              "needYield": 0,
                              "saveState": 125,
                              "restoreState": 125,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 38172,
               "executionTimeMillisEstimate": 126
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 140
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 45667,
                     "executionTimeMillis": 181,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 45667,
                        "executionTimeMillisEstimate": 16,
                        "works": 149458,
                        "advanced": 45667,
                        "needTime": 103790,
                        "needYield": 0,
                        "saveState": 152,
                        "restoreState": 152,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 45667,
                           "executionTimeMillisEstimate": 16,
                           "works": 149458,
                           "advanced": 45667,
                           "needTime": 103790,
                           "needYield": 0,
                           "saveState": 152,
                           "restoreState": 152,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 45667,
                              "executionTimeMillisEstimate": 7,
                              "works": 149458,
                              "advanced": 45667,
                              "needTime": 103790,
                              "needYield": 0,
                              "saveState": 152,
                              "restoreState": 152,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 45667,
               "executionTimeMillisEstimate": 153
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 178
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 261455,
                     "executionTimeMillis": 1053,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948909,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 261455,
                        "executionTimeMillisEstimate": 68,
                        "works": 948911,
                        "advanced": 261455,
                        "needTime": 687455,
                        "needYield": 0,
                        "saveState": 966,
                        "restoreState": 966,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 261455,
                           "executionTimeMillisEstimate": 61,
                           "works": 948911,
                           "advanced": 261455,
                           "needTime": 687455,
                           "needYield": 0,
                           "saveState": 966,
                           "restoreState": 966,
                           "isEOF": 1,
                           "chunkSkips": 33853,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 295308,
                              "executionTimeMillisEstimate": 32,
                              "works": 948911,
                              "advanced": 295308,
                              "needTime": 653602,
                              "needYield": 0,
                              "saveState": 966,
                              "restoreState": 966,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948909
                           }
                        }
                     }
                  }
               },
               "nReturned": 261455,
               "executionTimeMillisEstimate": 906
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1052
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425565,
         "i": 1749
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425565,
            "i": 1749
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 123131,
                     "executionTimeMillis": 345,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 123131,
                        "executionTimeMillisEstimate": 16,
                        "works": 123133,
                        "advanced": 123131,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 129,
                        "restoreState": 129,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 123131,
                           "executionTimeMillisEstimate": 11,
                           "works": 123133,
                           "advanced": 123131,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 129,
                           "restoreState": 129,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 123131,
                              "executionTimeMillisEstimate": 2,
                              "works": 123133,
                              "advanced": 123131,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 129,
                              "restoreState": 129,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 123131,
               "executionTimeMillisEstimate": 220
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 352,
               "executionTimeMillisEstimate": 335
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 149456,
                     "executionTimeMillis": 424,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 149456,
                        "executionTimeMillisEstimate": 25,
                        "works": 149458,
                        "advanced": 149456,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 156,
                        "restoreState": 156,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 149456,
                           "executionTimeMillisEstimate": 18,
                           "works": 149458,
                           "advanced": 149456,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 156,
                           "restoreState": 156,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 149456,
                              "executionTimeMillisEstimate": 10,
                              "works": 149458,
                              "advanced": 149456,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 156,
                              "restoreState": 156,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 149456,
               "executionTimeMillisEstimate": 249
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 411,
               "executionTimeMillisEstimate": 423
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 836832,
                     "executionTimeMillis": 2652,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948909,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 836832,
                        "executionTimeMillisEstimate": 168,
                        "works": 948911,
                        "advanced": 836832,
                        "needTime": 112078,
                        "needYield": 0,
                        "saveState": 1004,
                        "restoreState": 1004,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 836832,
                           "executionTimeMillisEstimate": 140,
                           "works": 948911,
                           "advanced": 836832,
                           "needTime": 112078,
                           "needYield": 0,
                           "saveState": 1004,
                           "restoreState": 1004,
                           "isEOF": 1,
                           "chunkSkips": 112077,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 948909,
                              "executionTimeMillisEstimate": 38,
                              "works": 948911,
                              "advanced": 948909,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1004,
                              "restoreState": 1004,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948909
                           }
                        }
                     }
                  }
               },
               "nReturned": 836832,
               "executionTimeMillisEstimate": 1642
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 440,
               "executionTimeMillisEstimate": 2644
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425568,
         "i": 1148
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425568,
            "i": 1153
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 123131,
                     "executionTimeMillis": 367,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 123131,
                        "executionTimeMillisEstimate": 18,
                        "works": 123133,
                        "advanced": 123131,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 131,
                        "restoreState": 131,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 123131,
                           "executionTimeMillisEstimate": 12,
                           "works": 123133,
                           "advanced": 123131,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 131,
                           "restoreState": 131,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 123131,
                              "executionTimeMillisEstimate": 4,
                              "works": 123133,
                              "advanced": 123131,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 131,
                              "restoreState": 131,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 123131,
               "executionTimeMillisEstimate": 232
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 229,
               "executionTimeMillisEstimate": 360
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 149456,
                     "executionTimeMillis": 424,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 149456,
                        "executionTimeMillisEstimate": 20,
                        "works": 149458,
                        "advanced": 149456,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 160,
                        "restoreState": 160,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 149456,
                           "executionTimeMillisEstimate": 14,
                           "works": 149458,
                           "advanced": 149456,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 160,
                           "restoreState": 160,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 149456,
                              "executionTimeMillisEstimate": 5,
                              "works": 149458,
                              "advanced": 149456,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 160,
                              "restoreState": 160,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 149456,
               "executionTimeMillisEstimate": 254
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 275,
               "executionTimeMillisEstimate": 423
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 836832,
                     "executionTimeMillis": 2669,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948909,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 836832,
                        "executionTimeMillisEstimate": 171,
                        "works": 948911,
                        "advanced": 836832,
                        "needTime": 112078,
                        "needYield": 0,
                        "saveState": 996,
                        "restoreState": 996,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 836832,
                           "executionTimeMillisEstimate": 139,
                           "works": 948911,
                           "advanced": 836832,
                           "needTime": 112078,
                           "needYield": 0,
                           "saveState": 996,
                           "restoreState": 996,
                           "isEOF": 1,
                           "chunkSkips": 112077,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 948909,
                              "executionTimeMillisEstimate": 40,
                              "works": 948911,
                              "advanced": 948909,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 996,
                              "restoreState": 996,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948909
                           }
                        }
                     }
                  }
               },
               "nReturned": 836832,
               "executionTimeMillisEstimate": 1626
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1175,
               "executionTimeMillisEstimate": 2668
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425571,
         "i": 15
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425571,
            "i": 15
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1733,
            "executionTimeMillis": 55,
            "totalKeysExamined": 0,
            "totalDocsExamined": 123131,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1733,
               "executionTimeMillisEstimate": 4,
               "works": 123133,
               "advanced": 1733,
               "needTime": 121399,
               "needYield": 0,
               "saveState": 123,
               "restoreState": 123,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 1733,
                  "executionTimeMillisEstimate": 4,
                  "works": 123133,
                  "advanced": 1733,
                  "needTime": 121399,
                  "needYield": 0,
                  "saveState": 123,
                  "restoreState": 123,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 123131
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 2014,
            "executionTimeMillis": 68,
            "totalKeysExamined": 0,
            "totalDocsExamined": 149456,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 2014,
               "executionTimeMillisEstimate": 2,
               "works": 149458,
               "advanced": 2014,
               "needTime": 147443,
               "needYield": 0,
               "saveState": 149,
               "restoreState": 149,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 2014,
                  "executionTimeMillisEstimate": 2,
                  "works": 149458,
                  "advanced": 2014,
                  "needTime": 147443,
                  "needYield": 0,
                  "saveState": 149,
                  "restoreState": 149,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 149456
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_ORIGIN_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 11078,
            "executionTimeMillis": 437,
            "totalKeysExamined": 0,
            "totalDocsExamined": 948909,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 11078,
               "executionTimeMillisEstimate": 29,
               "works": 948911,
               "advanced": 11078,
               "needTime": 937832,
               "needYield": 0,
               "saveState": 948,
               "restoreState": 948,
               "isEOF": 1,
               "chunkSkips": 1438,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 12516,
                  "executionTimeMillisEstimate": 24,
                  "works": 948911,
                  "advanced": 12516,
                  "needTime": 936394,
                  "needYield": 0,
                  "saveState": 948,
                  "restoreState": 948,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 948909
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425571,
         "i": 39
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425571,
            "i": 39
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 123131,
                     "executionTimeMillis": 483,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 123131,
                        "executionTimeMillisEstimate": 61,
                        "works": 123133,
                        "advanced": 123131,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 137,
                        "restoreState": 137,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 123131,
                           "executionTimeMillisEstimate": 28,
                           "works": 123133,
                           "advanced": 123131,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 137,
                           "restoreState": 137,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 123131,
                              "executionTimeMillisEstimate": 5,
                              "works": 123133,
                              "advanced": 123131,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 137,
                              "restoreState": 137,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 123131,
               "executionTimeMillisEstimate": 424
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 845,
               "executionTimeMillisEstimate": 475
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 149456,
                     "executionTimeMillis": 582,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 149456,
                        "executionTimeMillisEstimate": 65,
                        "works": 149458,
                        "advanced": 149456,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 167,
                        "restoreState": 167,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 149456,
                           "executionTimeMillisEstimate": 28,
                           "works": 149458,
                           "advanced": 149456,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 167,
                           "restoreState": 167,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 149456,
                              "executionTimeMillisEstimate": 2,
                              "works": 149458,
                              "advanced": 149456,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 167,
                              "restoreState": 167,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 149456,
               "executionTimeMillisEstimate": 483
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1050,
               "executionTimeMillisEstimate": 576
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 836832,
                     "executionTimeMillis": 3492,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948909,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 836832,
                        "executionTimeMillisEstimate": 515,
                        "works": 948911,
                        "advanced": 836832,
                        "needTime": 112078,
                        "needYield": 0,
                        "saveState": 1051,
                        "restoreState": 1051,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 836832,
                           "executionTimeMillisEstimate": 225,
                           "works": 948911,
                           "advanced": 836832,
                           "needTime": 112078,
                           "needYield": 0,
                           "saveState": 1051,
                           "restoreState": 1051,
                           "isEOF": 1,
                           "chunkSkips": 112077,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 948909,
                              "executionTimeMillisEstimate": 49,
                              "works": 948911,
                              "advanced": 948909,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1051,
                              "restoreState": 1051,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948909
                           }
                        }
                     }
                  }
               },
               "nReturned": 836832,
               "executionTimeMillisEstimate": 3055
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 657,
               "executionTimeMillisEstimate": 3490
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425574,
         "i": 2551
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425574,
            "i": 2559
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 123131,
                     "executionTimeMillis": 489,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 123131,
                        "executionTimeMillisEstimate": 55,
                        "works": 123133,
                        "advanced": 123131,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 137,
                        "restoreState": 137,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 123131,
                           "executionTimeMillisEstimate": 20,
                           "works": 123133,
                           "advanced": 123131,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 137,
                           "restoreState": 137,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 123131,
                              "executionTimeMillisEstimate": 3,
                              "works": 123133,
                              "advanced": 123131,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 137,
                              "restoreState": 137,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 123131,
               "executionTimeMillisEstimate": 399
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 787,
               "executionTimeMillisEstimate": 485
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 149456,
                     "executionTimeMillis": 586,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 149456,
                        "executionTimeMillisEstimate": 85,
                        "works": 149458,
                        "advanced": 149456,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 167,
                        "restoreState": 167,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 149456,
                           "executionTimeMillisEstimate": 36,
                           "works": 149458,
                           "advanced": 149456,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 167,
                           "restoreState": 167,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 149456,
                              "executionTimeMillisEstimate": 6,
                              "works": 149458,
                              "advanced": 149456,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 167,
                              "restoreState": 167,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 149456,
               "executionTimeMillisEstimate": 505
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 945,
               "executionTimeMillisEstimate": 585
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 836832,
                     "executionTimeMillis": 3573,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948909,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 836832,
                        "executionTimeMillisEstimate": 521,
                        "works": 948911,
                        "advanced": 836832,
                        "needTime": 112078,
                        "needYield": 0,
                        "saveState": 1051,
                        "restoreState": 1051,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 836832,
                           "executionTimeMillisEstimate": 199,
                           "works": 948911,
                           "advanced": 836832,
                           "needTime": 112078,
                           "needYield": 0,
                           "saveState": 1051,
                           "restoreState": 1051,
                           "isEOF": 1,
                           "chunkSkips": 112077,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 948909,
                              "executionTimeMillisEstimate": 38,
                              "works": 948911,
                              "advanced": 948909,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1051,
                              "restoreState": 1051,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948909
                           }
                        }
                     }
                  }
               },
               "nReturned": 836832,
               "executionTimeMillisEstimate": 3047
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2449,
               "executionTimeMillisEstimate": 3569
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425578,
         "i": 3
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425578,
            "i": 11
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 123131,
                     "executionTimeMillis": 255,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 123131,
                        "executionTimeMillisEstimate": 11,
                        "works": 123133,
                        "advanced": 123131,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 127,
                        "restoreState": 127,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 123131,
                           "executionTimeMillisEstimate": 7,
                           "works": 123133,
                           "advanced": 123131,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 127,
                           "restoreState": 127,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 123131,
                              "executionTimeMillisEstimate": 3,
                              "works": 123133,
                              "advanced": 123131,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 127,
                              "restoreState": 127,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 123131,
               "executionTimeMillisEstimate": 182
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 245
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 149456,
                     "executionTimeMillis": 298,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 149456,
                        "executionTimeMillisEstimate": 20,
                        "works": 149458,
                        "advanced": 149456,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 155,
                        "restoreState": 155,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 149456,
                           "executionTimeMillisEstimate": 17,
                           "works": 149458,
                           "advanced": 149456,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 155,
                           "restoreState": 155,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 149456,
                              "executionTimeMillisEstimate": 2,
                              "works": 149458,
                              "advanced": 149456,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 155,
                              "restoreState": 155,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 149456,
               "executionTimeMillisEstimate": 223
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 296
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 836832,
                     "executionTimeMillis": 2082,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948909,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 836832,
                        "executionTimeMillisEstimate": 238,
                        "works": 948911,
                        "advanced": 836832,
                        "needTime": 112078,
                        "needYield": 0,
                        "saveState": 993,
                        "restoreState": 993,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 836832,
                           "executionTimeMillisEstimate": 211,
                           "works": 948911,
                           "advanced": 836832,
                           "needTime": 112078,
                           "needYield": 0,
                           "saveState": 993,
                           "restoreState": 993,
                           "isEOF": 1,
                           "chunkSkips": 112077,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 948909,
                              "executionTimeMillisEstimate": 69,
                              "works": 948911,
                              "advanced": 948909,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 993,
                              "restoreState": 993,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948909
                           }
                        }
                     }
                  }
               },
               "nReturned": 836832,
               "executionTimeMillisEstimate": 1616
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2079
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425580,
         "i": 355
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425580,
            "i": 355
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 20167,
                     "executionTimeMillis": 99,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 20167,
                        "executionTimeMillisEstimate": 2,
                        "works": 123133,
                        "advanced": 20167,
                        "needTime": 102965,
                        "needYield": 0,
                        "saveState": 124,
                        "restoreState": 124,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 20167,
                           "executionTimeMillisEstimate": 2,
                           "works": 123133,
                           "advanced": 20167,
                           "needTime": 102965,
                           "needYield": 0,
                           "saveState": 124,
                           "restoreState": 124,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 20167,
                              "executionTimeMillisEstimate": 1,
                              "works": 123133,
                              "advanced": 20167,
                              "needTime": 102965,
                              "needYield": 0,
                              "saveState": 124,
                              "restoreState": 124,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 20167,
               "executionTimeMillisEstimate": 87
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 119,
               "executionTimeMillisEstimate": 99
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 24870,
                     "executionTimeMillis": 124,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 24870,
                        "executionTimeMillisEstimate": 5,
                        "works": 149458,
                        "advanced": 24870,
                        "needTime": 124587,
                        "needYield": 0,
                        "saveState": 150,
                        "restoreState": 150,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 24870,
                           "executionTimeMillisEstimate": 5,
                           "works": 149458,
                           "advanced": 24870,
                           "needTime": 124587,
                           "needYield": 0,
                           "saveState": 150,
                           "restoreState": 150,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 24870,
                              "executionTimeMillisEstimate": 4,
                              "works": 149458,
                              "advanced": 24870,
                              "needTime": 124587,
                              "needYield": 0,
                              "saveState": 150,
                              "restoreState": 150,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 24870,
               "executionTimeMillisEstimate": 108
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 152,
               "executionTimeMillisEstimate": 123
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 137616,
                     "executionTimeMillis": 839,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948909,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 137616,
                        "executionTimeMillisEstimate": 78,
                        "works": 948911,
                        "advanced": 137616,
                        "needTime": 811294,
                        "needYield": 0,
                        "saveState": 953,
                        "restoreState": 953,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 137616,
                           "executionTimeMillisEstimate": 70,
                           "works": 948911,
                           "advanced": 137616,
                           "needTime": 811294,
                           "needYield": 0,
                           "saveState": 953,
                           "restoreState": 953,
                           "isEOF": 1,
                           "chunkSkips": 18458,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 156074,
                              "executionTimeMillisEstimate": 40,
                              "works": 948911,
                              "advanced": 156074,
                              "needTime": 792836,
                              "needYield": 0,
                              "saveState": 953,
                              "restoreState": 953,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948909
                           }
                        }
                     }
                  }
               },
               "nReturned": 137616,
               "executionTimeMillisEstimate": 757
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 94,
               "executionTimeMillisEstimate": 831
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425581,
         "i": 2550
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425581,
            "i": 2558
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 20167,
                     "executionTimeMillis": 100,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 123131,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 20167,
                        "executionTimeMillisEstimate": 4,
                        "works": 123133,
                        "advanced": 20167,
                        "needTime": 102965,
                        "needYield": 0,
                        "saveState": 124,
                        "restoreState": 124,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 20167,
                           "executionTimeMillisEstimate": 4,
                           "works": 123133,
                           "advanced": 20167,
                           "needTime": 102965,
                           "needYield": 0,
                           "saveState": 124,
                           "restoreState": 124,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 20167,
                              "executionTimeMillisEstimate": 2,
                              "works": 123133,
                              "advanced": 20167,
                              "needTime": 102965,
                              "needYield": 0,
                              "saveState": 124,
                              "restoreState": 124,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 123131
                           }
                        }
                     }
                  }
               },
               "nReturned": 20167,
               "executionTimeMillisEstimate": 88
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 117,
               "executionTimeMillisEstimate": 90
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 24870,
                     "executionTimeMillis": 145,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 149456,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 24870,
                        "executionTimeMillisEstimate": 5,
                        "works": 149458,
                        "advanced": 24870,
                        "needTime": 124587,
                        "needYield": 0,
                        "saveState": 150,
                        "restoreState": 150,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 24870,
                           "executionTimeMillisEstimate": 2,
                           "works": 149458,
                           "advanced": 24870,
                           "needTime": 124587,
                           "needYield": 0,
                           "saveState": 150,
                           "restoreState": 150,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 24870,
                              "executionTimeMillisEstimate": 0,
                              "works": 149458,
                              "advanced": 24870,
                              "needTime": 124587,
                              "needYield": 0,
                              "saveState": 150,
                              "restoreState": 150,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 149456
                           }
                        }
                     }
                  }
               },
               "nReturned": 24870,
               "executionTimeMillisEstimate": 128
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 144,
               "executionTimeMillisEstimate": 142
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_ORIGIN_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 137616,
                     "executionTimeMillis": 867,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 948909,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 137616,
                        "executionTimeMillisEstimate": 66,
                        "works": 948911,
                        "advanced": 137616,
                        "needTime": 811294,
                        "needYield": 0,
                        "saveState": 954,
                        "restoreState": 954,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 137616,
                           "executionTimeMillisEstimate": 58,
                           "works": 948911,
                           "advanced": 137616,
                           "needTime": 811294,
                           "needYield": 0,
                           "saveState": 954,
                           "restoreState": 954,
                           "isEOF": 1,
                           "chunkSkips": 18458,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 156074,
                              "executionTimeMillisEstimate": 34,
                              "works": 948911,
                              "advanced": 156074,
                              "needTime": 792836,
                              "needYield": 0,
                              "saveState": 954,
                              "restoreState": 954,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 948909
                           }
                        }
                     }
                  }
               },
               "nReturned": 137616,
               "executionTimeMillisEstimate": 781
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 349,
               "executionTimeMillisEstimate": 859
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425582,
         "i": 1090
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425582,
            "i": 1090
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_X<a name="AirlineData_X"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_X",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 98,
            "totalKeysExamined": 0,
            "totalDocsExamined": 138192,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 5,
               "works": 138194,
               "advanced": 1,
               "needTime": 138192,
               "needYield": 0,
               "saveState": 138,
               "restoreState": 138,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 5,
                  "works": 138194,
                  "advanced": 1,
                  "needTime": 138192,
                  "needYield": 0,
                  "saveState": 138,
                  "restoreState": 138,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 138192
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_X",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1,
            "executionTimeMillis": 172,
            "totalKeysExamined": 0,
            "totalDocsExamined": 127111,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1,
               "executionTimeMillisEstimate": 22,
               "works": 127113,
               "advanced": 1,
               "needTime": 127111,
               "needYield": 0,
               "saveState": 127,
               "restoreState": 127,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 22,
                  "works": 127113,
                  "advanced": 1,
                  "needTime": 127111,
                  "needYield": 0,
                  "saveState": 127,
                  "restoreState": 127,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 127111
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_X",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 1028,
            "totalKeysExamined": 0,
            "totalDocsExamined": 1030251,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 148,
               "works": 1030253,
               "advanced": 0,
               "needTime": 1030252,
               "needYield": 0,
               "saveState": 1030,
               "restoreState": 1030,
               "isEOF": 1,
               "chunkSkips": 1,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 148,
                  "works": 1030253,
                  "advanced": 1,
                  "needTime": 1030251,
                  "needYield": 0,
                  "saveState": 1030,
                  "restoreState": 1030,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 1030251
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425583,
         "i": 2547
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425583,
            "i": 2555
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 127111,
                     "executionTimeMillis": 329,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 127111,
                        "executionTimeMillisEstimate": 29,
                        "works": 127113,
                        "advanced": 127111,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 133,
                        "restoreState": 133,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 127111,
                           "executionTimeMillisEstimate": 22,
                           "works": 127113,
                           "advanced": 127111,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 133,
                           "restoreState": 133,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 127111,
                              "executionTimeMillisEstimate": 3,
                              "works": 127113,
                              "advanced": 127111,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 133,
                              "restoreState": 133,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 127111,
               "executionTimeMillisEstimate": 248
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 325
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138192,
                     "executionTimeMillis": 348,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138192,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138192,
                        "executionTimeMillisEstimate": 31,
                        "works": 138194,
                        "advanced": 138192,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 145,
                        "restoreState": 145,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138192,
                           "executionTimeMillisEstimate": 22,
                           "works": 138194,
                           "advanced": 138192,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 145,
                           "restoreState": 145,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138192,
                              "executionTimeMillisEstimate": 5,
                              "works": 138194,
                              "advanced": 138192,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 145,
                              "restoreState": 145,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138192
                           }
                        }
                     }
                  }
               },
               "nReturned": 138192,
               "executionTimeMillisEstimate": 277
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 346
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 844116,
                     "executionTimeMillis": 2661,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1030251,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 844116,
                        "executionTimeMillisEstimate": 272,
                        "works": 1030253,
                        "advanced": 844116,
                        "needTime": 186136,
                        "needYield": 0,
                        "saveState": 1075,
                        "restoreState": 1075,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 844116,
                           "executionTimeMillisEstimate": 228,
                           "works": 1030253,
                           "advanced": 844116,
                           "needTime": 186136,
                           "needYield": 0,
                           "saveState": 1075,
                           "restoreState": 1075,
                           "isEOF": 1,
                           "chunkSkips": 186135,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1030251,
                              "executionTimeMillisEstimate": 76,
                              "works": 1030253,
                              "advanced": 1030251,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1075,
                              "restoreState": 1075,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1030251
                           }
                        }
                     }
                  }
               },
               "nReturned": 844116,
               "executionTimeMillisEstimate": 2116
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2658
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425585,
         "i": 2538
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425585,
            "i": 2546
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 127111,
                     "executionTimeMillis": 318,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 127111,
                        "executionTimeMillisEstimate": 23,
                        "works": 127113,
                        "advanced": 127111,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 132,
                        "restoreState": 132,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 127111,
                           "executionTimeMillisEstimate": 17,
                           "works": 127113,
                           "advanced": 127111,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 132,
                           "restoreState": 132,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 127111,
                              "executionTimeMillisEstimate": 4,
                              "works": 127113,
                              "advanced": 127111,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 132,
                              "restoreState": 132,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 127111,
               "executionTimeMillisEstimate": 230
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 94,
               "executionTimeMillisEstimate": 315
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138192,
                     "executionTimeMillis": 339,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138192,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138192,
                        "executionTimeMillisEstimate": 37,
                        "works": 138194,
                        "advanced": 138192,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 143,
                        "restoreState": 143,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138192,
                           "executionTimeMillisEstimate": 27,
                           "works": 138194,
                           "advanced": 138192,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 143,
                           "restoreState": 143,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138192,
                              "executionTimeMillisEstimate": 10,
                              "works": 138194,
                              "advanced": 138192,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 143,
                              "restoreState": 143,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138192
                           }
                        }
                     }
                  }
               },
               "nReturned": 138192,
               "executionTimeMillisEstimate": 254
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 133,
               "executionTimeMillisEstimate": 338
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 844116,
                     "executionTimeMillis": 2665,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1030251,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 844116,
                        "executionTimeMillisEstimate": 304,
                        "works": 1030253,
                        "advanced": 844116,
                        "needTime": 186136,
                        "needYield": 0,
                        "saveState": 1068,
                        "restoreState": 1068,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 844116,
                           "executionTimeMillisEstimate": 254,
                           "works": 1030253,
                           "advanced": 844116,
                           "needTime": 186136,
                           "needYield": 0,
                           "saveState": 1068,
                           "restoreState": 1068,
                           "isEOF": 1,
                           "chunkSkips": 186135,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1030251,
                              "executionTimeMillisEstimate": 61,
                              "works": 1030253,
                              "advanced": 1030251,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1068,
                              "restoreState": 1068,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1030251
                           }
                        }
                     }
                  }
               },
               "nReturned": 844116,
               "executionTimeMillisEstimate": 2047
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 198,
               "executionTimeMillisEstimate": 2658
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425589,
         "i": 1
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425589,
            "i": 9
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 127111,
                     "executionTimeMillis": 325,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 127111,
                        "executionTimeMillisEstimate": 25,
                        "works": 127113,
                        "advanced": 127111,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 134,
                        "restoreState": 134,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 127111,
                           "executionTimeMillisEstimate": 16,
                           "works": 127113,
                           "advanced": 127111,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 134,
                           "restoreState": 134,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 127111,
                              "executionTimeMillisEstimate": 3,
                              "works": 127113,
                              "advanced": 127111,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 134,
                              "restoreState": 134,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 127111,
               "executionTimeMillisEstimate": 256
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 165,
               "executionTimeMillisEstimate": 323
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138192,
                     "executionTimeMillis": 344,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138192,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138192,
                        "executionTimeMillisEstimate": 28,
                        "works": 138194,
                        "advanced": 138192,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 145,
                        "restoreState": 145,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138192,
                           "executionTimeMillisEstimate": 21,
                           "works": 138194,
                           "advanced": 138192,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 145,
                           "restoreState": 145,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138192,
                              "executionTimeMillisEstimate": 3,
                              "works": 138194,
                              "advanced": 138192,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 145,
                              "restoreState": 145,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138192
                           }
                        }
                     }
                  }
               },
               "nReturned": 138192,
               "executionTimeMillisEstimate": 265
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 119,
               "executionTimeMillisEstimate": 335
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 844116,
                     "executionTimeMillis": 2636,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1030251,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 844116,
                        "executionTimeMillisEstimate": 264,
                        "works": 1030253,
                        "advanced": 844116,
                        "needTime": 186136,
                        "needYield": 0,
                        "saveState": 1071,
                        "restoreState": 1071,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 844116,
                           "executionTimeMillisEstimate": 208,
                           "works": 1030253,
                           "advanced": 844116,
                           "needTime": 186136,
                           "needYield": 0,
                           "saveState": 1071,
                           "restoreState": 1071,
                           "isEOF": 1,
                           "chunkSkips": 186135,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1030251,
                              "executionTimeMillisEstimate": 46,
                              "works": 1030253,
                              "advanced": 1030251,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1071,
                              "restoreState": 1071,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1030251
                           }
                        }
                     }
                  }
               },
               "nReturned": 844116,
               "executionTimeMillisEstimate": 2113
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 353,
               "executionTimeMillisEstimate": 2625
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425591,
         "i": 173
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425591,
            "i": 173
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 24167,
                     "executionTimeMillis": 116,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 24167,
                        "executionTimeMillisEstimate": 7,
                        "works": 127113,
                        "advanced": 24167,
                        "needTime": 102945,
                        "needYield": 0,
                        "saveState": 128,
                        "restoreState": 128,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 24167,
                           "executionTimeMillisEstimate": 7,
                           "works": 127113,
                           "advanced": 24167,
                           "needTime": 102945,
                           "needYield": 0,
                           "saveState": 128,
                           "restoreState": 128,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 24167,
                              "executionTimeMillisEstimate": 5,
                              "works": 127113,
                              "advanced": 24167,
                              "needTime": 102945,
                              "needYield": 0,
                              "saveState": 128,
                              "restoreState": 128,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 24167,
               "executionTimeMillisEstimate": 98
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 94,
               "executionTimeMillisEstimate": 107
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 28328,
                     "executionTimeMillis": 125,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138192,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 28328,
                        "executionTimeMillisEstimate": 2,
                        "works": 138194,
                        "advanced": 28328,
                        "needTime": 109865,
                        "needYield": 0,
                        "saveState": 139,
                        "restoreState": 139,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 28328,
                           "executionTimeMillisEstimate": 2,
                           "works": 138194,
                           "advanced": 28328,
                           "needTime": 109865,
                           "needYield": 0,
                           "saveState": 139,
                           "restoreState": 139,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 28328,
                              "executionTimeMillisEstimate": 1,
                              "works": 138194,
                              "advanced": 28328,
                              "needTime": 109865,
                              "needYield": 0,
                              "saveState": 139,
                              "restoreState": 139,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138192
                           }
                        }
                     }
                  }
               },
               "nReturned": 28328,
               "executionTimeMillisEstimate": 108
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 132,
               "executionTimeMillisEstimate": 117
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 163020,
                     "executionTimeMillis": 966,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1030251,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 163020,
                        "executionTimeMillisEstimate": 64,
                        "works": 1030253,
                        "advanced": 163020,
                        "needTime": 867232,
                        "needYield": 0,
                        "saveState": 1038,
                        "restoreState": 1038,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 163020,
                           "executionTimeMillisEstimate": 59,
                           "works": 1030253,
                           "advanced": 163020,
                           "needTime": 867232,
                           "needYield": 0,
                           "saveState": 1038,
                           "restoreState": 1038,
                           "isEOF": 1,
                           "chunkSkips": 36318,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 199338,
                              "executionTimeMillisEstimate": 41,
                              "works": 1030253,
                              "advanced": 199338,
                              "needTime": 830914,
                              "needYield": 0,
                              "saveState": 1038,
                              "restoreState": 1038,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1030251
                           }
                        }
                     }
                  }
               },
               "nReturned": 163020,
               "executionTimeMillisEstimate": 846
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 198,
               "executionTimeMillisEstimate": 960
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425592,
         "i": 5497
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425592,
            "i": 5497
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 28328,
                     "executionTimeMillis": 129,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138192,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 28328,
                        "executionTimeMillisEstimate": 5,
                        "works": 138194,
                        "advanced": 28328,
                        "needTime": 109865,
                        "needYield": 0,
                        "saveState": 139,
                        "restoreState": 139,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 28328,
                           "executionTimeMillisEstimate": 5,
                           "works": 138194,
                           "advanced": 28328,
                           "needTime": 109865,
                           "needYield": 0,
                           "saveState": 139,
                           "restoreState": 139,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 28328,
                              "executionTimeMillisEstimate": 3,
                              "works": 138194,
                              "advanced": 28328,
                              "needTime": 109865,
                              "needYield": 0,
                              "saveState": 139,
                              "restoreState": 139,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138192
                           }
                        }
                     }
                  }
               },
               "nReturned": 28328,
               "executionTimeMillisEstimate": 122
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 111,
               "executionTimeMillisEstimate": 126
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 24167,
                     "executionTimeMillis": 118,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 24167,
                        "executionTimeMillisEstimate": 8,
                        "works": 127113,
                        "advanced": 24167,
                        "needTime": 102945,
                        "needYield": 0,
                        "saveState": 128,
                        "restoreState": 128,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 24167,
                           "executionTimeMillisEstimate": 6,
                           "works": 127113,
                           "advanced": 24167,
                           "needTime": 102945,
                           "needYield": 0,
                           "saveState": 128,
                           "restoreState": 128,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 24167,
                              "executionTimeMillisEstimate": 5,
                              "works": 127113,
                              "advanced": 24167,
                              "needTime": 102945,
                              "needYield": 0,
                              "saveState": 128,
                              "restoreState": 128,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 24167,
               "executionTimeMillisEstimate": 100
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 161,
               "executionTimeMillisEstimate": 114
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 163020,
                     "executionTimeMillis": 984,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027984,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 163020,
                        "executionTimeMillisEstimate": 53,
                        "works": 1027986,
                        "advanced": 163020,
                        "needTime": 864965,
                        "needYield": 0,
                        "saveState": 1037,
                        "restoreState": 1037,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 163020,
                           "executionTimeMillisEstimate": 53,
                           "works": 1027986,
                           "advanced": 163020,
                           "needTime": 864965,
                           "needYield": 0,
                           "saveState": 1037,
                           "restoreState": 1037,
                           "isEOF": 1,
                           "chunkSkips": 35839,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 198859,
                              "executionTimeMillisEstimate": 38,
                              "works": 1027986,
                              "advanced": 198859,
                              "needTime": 829126,
                              "needYield": 0,
                              "saveState": 1037,
                              "restoreState": 1037,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027984
                           }
                        }
                     }
                  }
               },
               "nReturned": 163020,
               "executionTimeMillisEstimate": 884
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 350,
               "executionTimeMillisEstimate": 978
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425593,
         "i": 469
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425593,
            "i": 477
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 24167,
                     "executionTimeMillis": 115,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 24167,
                        "executionTimeMillisEstimate": 3,
                        "works": 127113,
                        "advanced": 24167,
                        "needTime": 102945,
                        "needYield": 0,
                        "saveState": 128,
                        "restoreState": 128,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 24167,
                           "executionTimeMillisEstimate": 3,
                           "works": 127113,
                           "advanced": 24167,
                           "needTime": 102945,
                           "needYield": 0,
                           "saveState": 128,
                           "restoreState": 128,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 24167,
                              "executionTimeMillisEstimate": 1,
                              "works": 127113,
                              "advanced": 24167,
                              "needTime": 102945,
                              "needYield": 0,
                              "saveState": 128,
                              "restoreState": 128,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 24167,
               "executionTimeMillisEstimate": 98
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 109
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 28328,
                     "executionTimeMillis": 126,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138192,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 28328,
                        "executionTimeMillisEstimate": 5,
                        "works": 138194,
                        "advanced": 28328,
                        "needTime": 109865,
                        "needYield": 0,
                        "saveState": 139,
                        "restoreState": 139,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 28328,
                           "executionTimeMillisEstimate": 4,
                           "works": 138194,
                           "advanced": 28328,
                           "needTime": 109865,
                           "needYield": 0,
                           "saveState": 139,
                           "restoreState": 139,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 28328,
                              "executionTimeMillisEstimate": 1,
                              "works": 138194,
                              "advanced": 28328,
                              "needTime": 109865,
                              "needYield": 0,
                              "saveState": 139,
                              "restoreState": 139,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138192
                           }
                        }
                     }
                  }
               },
               "nReturned": 28328,
               "executionTimeMillisEstimate": 106
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 118
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 163020,
                     "executionTimeMillis": 958,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 163020,
                        "executionTimeMillisEstimate": 57,
                        "works": 1027691,
                        "advanced": 163020,
                        "needTime": 864670,
                        "needYield": 0,
                        "saveState": 1036,
                        "restoreState": 1036,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 163020,
                           "executionTimeMillisEstimate": 50,
                           "works": 1027691,
                           "advanced": 163020,
                           "needTime": 864670,
                           "needYield": 0,
                           "saveState": 1036,
                           "restoreState": 1036,
                           "isEOF": 1,
                           "chunkSkips": 35800,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 198820,
                              "executionTimeMillisEstimate": 30,
                              "works": 1027691,
                              "advanced": 198820,
                              "needTime": 828870,
                              "needYield": 0,
                              "saveState": 1036,
                              "restoreState": 1036,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 163020,
               "executionTimeMillisEstimate": 849
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 952
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425594,
         "i": 245
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425594,
            "i": 245
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 39387,
                     "executionTimeMillis": 193,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 39387,
                        "executionTimeMillisEstimate": 60,
                        "works": 127113,
                        "advanced": 39387,
                        "needTime": 87725,
                        "needYield": 0,
                        "saveState": 129,
                        "restoreState": 129,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 39387,
                           "executionTimeMillisEstimate": 53,
                           "works": 127113,
                           "advanced": 39387,
                           "needTime": 87725,
                           "needYield": 0,
                           "saveState": 129,
                           "restoreState": 129,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 39387,
                              "executionTimeMillisEstimate": 26,
                              "works": 127113,
                              "advanced": 39387,
                              "needTime": 87725,
                              "needYield": 0,
                              "saveState": 129,
                              "restoreState": 129,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 39387,
               "executionTimeMillisEstimate": 156
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 93,
               "executionTimeMillisEstimate": 192
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 42198,
                     "executionTimeMillis": 206,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 42198,
                        "executionTimeMillisEstimate": 73,
                        "works": 138408,
                        "advanced": 42198,
                        "needTime": 96209,
                        "needYield": 0,
                        "saveState": 140,
                        "restoreState": 140,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 42198,
                           "executionTimeMillisEstimate": 66,
                           "works": 138408,
                           "advanced": 42198,
                           "needTime": 96209,
                           "needYield": 0,
                           "saveState": 140,
                           "restoreState": 140,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 42198,
                              "executionTimeMillisEstimate": 38,
                              "works": 138408,
                              "advanced": 42198,
                              "needTime": 96209,
                              "needYield": 0,
                              "saveState": 140,
                              "restoreState": 140,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 42198,
               "executionTimeMillisEstimate": 172
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 132,
               "executionTimeMillisEstimate": 203
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 263709,
                     "executionTimeMillis": 1210,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 263709,
                        "executionTimeMillisEstimate": 88,
                        "works": 1027691,
                        "advanced": 263709,
                        "needTime": 763981,
                        "needYield": 0,
                        "saveState": 1041,
                        "restoreState": 1041,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 263709,
                           "executionTimeMillisEstimate": 76,
                           "works": 1027691,
                           "advanced": 263709,
                           "needTime": 763981,
                           "needYield": 0,
                           "saveState": 1041,
                           "restoreState": 1041,
                           "isEOF": 1,
                           "chunkSkips": 56347,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 320056,
                              "executionTimeMillisEstimate": 41,
                              "works": 1027691,
                              "advanced": 320056,
                              "needTime": 707634,
                              "needYield": 0,
                              "saveState": 1041,
                              "restoreState": 1041,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 263709,
               "executionTimeMillisEstimate": 1041
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 196,
               "executionTimeMillisEstimate": 1208
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425594,
         "i": 254
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425594,
            "i": 255
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 39387,
                     "executionTimeMillis": 150,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 39387,
                        "executionTimeMillisEstimate": 7,
                        "works": 127113,
                        "advanced": 39387,
                        "needTime": 87725,
                        "needYield": 0,
                        "saveState": 129,
                        "restoreState": 129,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 39387,
                           "executionTimeMillisEstimate": 7,
                           "works": 127113,
                           "advanced": 39387,
                           "needTime": 87725,
                           "needYield": 0,
                           "saveState": 129,
                           "restoreState": 129,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 39387,
                              "executionTimeMillisEstimate": 2,
                              "works": 127113,
                              "advanced": 39387,
                              "needTime": 87725,
                              "needYield": 0,
                              "saveState": 129,
                              "restoreState": 129,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 39387,
               "executionTimeMillisEstimate": 125
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 157,
               "executionTimeMillisEstimate": 149
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 42198,
                     "executionTimeMillis": 157,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 42198,
                        "executionTimeMillisEstimate": 10,
                        "works": 138408,
                        "advanced": 42198,
                        "needTime": 96209,
                        "needYield": 0,
                        "saveState": 140,
                        "restoreState": 140,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 42198,
                           "executionTimeMillisEstimate": 10,
                           "works": 138408,
                           "advanced": 42198,
                           "needTime": 96209,
                           "needYield": 0,
                           "saveState": 140,
                           "restoreState": 140,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 42198,
                              "executionTimeMillisEstimate": 3,
                              "works": 138408,
                              "advanced": 42198,
                              "needTime": 96209,
                              "needYield": 0,
                              "saveState": 140,
                              "restoreState": 140,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 42198,
               "executionTimeMillisEstimate": 130
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 112,
               "executionTimeMillisEstimate": 156
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 263709,
                     "executionTimeMillis": 1328,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 263709,
                        "executionTimeMillisEstimate": 146,
                        "works": 1027691,
                        "advanced": 263709,
                        "needTime": 763981,
                        "needYield": 0,
                        "saveState": 1040,
                        "restoreState": 1040,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 263709,
                           "executionTimeMillisEstimate": 133,
                           "works": 1027691,
                           "advanced": 263709,
                           "needTime": 763981,
                           "needYield": 0,
                           "saveState": 1040,
                           "restoreState": 1040,
                           "isEOF": 1,
                           "chunkSkips": 56347,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 320056,
                              "executionTimeMillisEstimate": 67,
                              "works": 1027691,
                              "advanced": 320056,
                              "needTime": 707634,
                              "needYield": 0,
                              "saveState": 1040,
                              "restoreState": 1040,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 263709,
               "executionTimeMillisEstimate": 1123
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 348,
               "executionTimeMillisEstimate": 1322
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425596,
         "i": 7569
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425596,
            "i": 7577
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 39387,
                     "executionTimeMillis": 150,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 39387,
                        "executionTimeMillisEstimate": 10,
                        "works": 127113,
                        "advanced": 39387,
                        "needTime": 87725,
                        "needYield": 0,
                        "saveState": 129,
                        "restoreState": 129,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 39387,
                           "executionTimeMillisEstimate": 10,
                           "works": 127113,
                           "advanced": 39387,
                           "needTime": 87725,
                           "needYield": 0,
                           "saveState": 129,
                           "restoreState": 129,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 39387,
                              "executionTimeMillisEstimate": 4,
                              "works": 127113,
                              "advanced": 39387,
                              "needTime": 87725,
                              "needYield": 0,
                              "saveState": 129,
                              "restoreState": 129,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 39387,
               "executionTimeMillisEstimate": 124
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 149
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 42198,
                     "executionTimeMillis": 160,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 42198,
                        "executionTimeMillisEstimate": 10,
                        "works": 138408,
                        "advanced": 42198,
                        "needTime": 96209,
                        "needYield": 0,
                        "saveState": 141,
                        "restoreState": 141,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 42198,
                           "executionTimeMillisEstimate": 8,
                           "works": 138408,
                           "advanced": 42198,
                           "needTime": 96209,
                           "needYield": 0,
                           "saveState": 141,
                           "restoreState": 141,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 42198,
                              "executionTimeMillisEstimate": 4,
                              "works": 138408,
                              "advanced": 42198,
                              "needTime": 96209,
                              "needYield": 0,
                              "saveState": 141,
                              "restoreState": 141,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 42198,
               "executionTimeMillisEstimate": 133
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 159
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 263709,
                     "executionTimeMillis": 1242,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 263709,
                        "executionTimeMillisEstimate": 108,
                        "works": 1027691,
                        "advanced": 263709,
                        "needTime": 763981,
                        "needYield": 0,
                        "saveState": 1040,
                        "restoreState": 1040,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 263709,
                           "executionTimeMillisEstimate": 92,
                           "works": 1027691,
                           "advanced": 263709,
                           "needTime": 763981,
                           "needYield": 0,
                           "saveState": 1040,
                           "restoreState": 1040,
                           "isEOF": 1,
                           "chunkSkips": 56347,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 320056,
                              "executionTimeMillisEstimate": 44,
                              "works": 1027691,
                              "advanced": 320056,
                              "needTime": 707634,
                              "needYield": 0,
                              "saveState": 1040,
                              "restoreState": 1040,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 263709,
               "executionTimeMillisEstimate": 1052
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1242
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425598,
         "i": 1407
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425598,
            "i": 1408
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 127111,
                     "executionTimeMillis": 400,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 127111,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 127111,
                        "executionTimeMillisEstimate": 33,
                        "works": 127113,
                        "advanced": 127111,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 133,
                        "restoreState": 133,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 127111,
                           "executionTimeMillisEstimate": 28,
                           "works": 127113,
                           "advanced": 127111,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 133,
                           "restoreState": 133,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 127111,
                              "executionTimeMillisEstimate": 7,
                              "works": 127113,
                              "advanced": 127111,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 133,
                              "restoreState": 133,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 127111
                           }
                        }
                     }
                  }
               },
               "nReturned": 127111,
               "executionTimeMillisEstimate": 256
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 221,
               "executionTimeMillisEstimate": 399
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138406,
                     "executionTimeMillis": 438,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138406,
                        "executionTimeMillisEstimate": 35,
                        "works": 138408,
                        "advanced": 138406,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 145,
                        "restoreState": 145,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138406,
                           "executionTimeMillisEstimate": 27,
                           "works": 138408,
                           "advanced": 138406,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 145,
                           "restoreState": 145,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138406,
                              "executionTimeMillisEstimate": 6,
                              "works": 138408,
                              "advanced": 138406,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 145,
                              "restoreState": 145,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 138406,
               "executionTimeMillisEstimate": 276
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 336,
               "executionTimeMillisEstimate": 429
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 843902,
                     "executionTimeMillis": 3091,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 843902,
                        "executionTimeMillisEstimate": 225,
                        "works": 1027691,
                        "advanced": 843902,
                        "needTime": 183788,
                        "needYield": 0,
                        "saveState": 1079,
                        "restoreState": 1079,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 843902,
                           "executionTimeMillisEstimate": 187,
                           "works": 1027691,
                           "advanced": 843902,
                           "needTime": 183788,
                           "needYield": 0,
                           "saveState": 1079,
                           "restoreState": 1079,
                           "isEOF": 1,
                           "chunkSkips": 183787,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1027689,
                              "executionTimeMillisEstimate": 43,
                              "works": 1027691,
                              "advanced": 1027689,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1079,
                              "restoreState": 1079,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 843902,
               "executionTimeMillisEstimate": 2007
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 646,
               "executionTimeMillisEstimate": 3086
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425601,
         "i": 4848
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425601,
            "i": 4848
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 129581,
                     "executionTimeMillis": 417,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 129581,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 129581,
                        "executionTimeMillisEstimate": 25,
                        "works": 129583,
                        "advanced": 129581,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 138,
                        "restoreState": 138,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 129581,
                           "executionTimeMillisEstimate": 23,
                           "works": 129583,
                           "advanced": 129581,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 138,
                           "restoreState": 138,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 129581,
                              "executionTimeMillisEstimate": 6,
                              "works": 129583,
                              "advanced": 129581,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 138,
                              "restoreState": 138,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 129581
                           }
                        }
                     }
                  }
               },
               "nReturned": 129581,
               "executionTimeMillisEstimate": 276
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 361,
               "executionTimeMillisEstimate": 418
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138406,
                     "executionTimeMillis": 484,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138406,
                        "executionTimeMillisEstimate": 136,
                        "works": 138408,
                        "advanced": 138406,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 149,
                        "restoreState": 149,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138406,
                           "executionTimeMillisEstimate": 115,
                           "works": 138408,
                           "advanced": 138406,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 149,
                           "restoreState": 149,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138406,
                              "executionTimeMillisEstimate": 18,
                              "works": 138408,
                              "advanced": 138406,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 149,
                              "restoreState": 149,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 138406,
               "executionTimeMillisEstimate": 286
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 259,
               "executionTimeMillisEstimate": 481
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 841432,
                     "executionTimeMillis": 3076,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 841432,
                        "executionTimeMillisEstimate": 231,
                        "works": 1027691,
                        "advanced": 841432,
                        "needTime": 186258,
                        "needYield": 0,
                        "saveState": 1072,
                        "restoreState": 1072,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 841432,
                           "executionTimeMillisEstimate": 182,
                           "works": 1027691,
                           "advanced": 841432,
                           "needTime": 186258,
                           "needYield": 0,
                           "saveState": 1072,
                           "restoreState": 1072,
                           "isEOF": 1,
                           "chunkSkips": 186257,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1027689,
                              "executionTimeMillisEstimate": 42,
                              "works": 1027691,
                              "advanced": 1027689,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1072,
                              "restoreState": 1072,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 841432,
               "executionTimeMillisEstimate": 1996
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1118,
               "executionTimeMillisEstimate": 3069
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425604,
         "i": 4
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425604,
            "i": 12
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_X",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1584,
            "executionTimeMillis": 72,
            "totalKeysExamined": 0,
            "totalDocsExamined": 129581,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1584,
               "executionTimeMillisEstimate": 4,
               "works": 129583,
               "advanced": 1584,
               "needTime": 127998,
               "needYield": 0,
               "saveState": 129,
               "restoreState": 129,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 1584,
                  "executionTimeMillisEstimate": 4,
                  "works": 129583,
                  "advanced": 1584,
                  "needTime": 127998,
                  "needYield": 0,
                  "saveState": 129,
                  "restoreState": 129,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 129581
               }
            }
         }
      },
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_X",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 1947,
            "executionTimeMillis": 75,
            "totalKeysExamined": 0,
            "totalDocsExamined": 138406,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 1947,
               "executionTimeMillisEstimate": 2,
               "works": 138408,
               "advanced": 1947,
               "needTime": 136460,
               "needYield": 0,
               "saveState": 138,
               "restoreState": 138,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 1947,
                  "executionTimeMillisEstimate": 2,
                  "works": 138408,
                  "advanced": 1947,
                  "needTime": 136460,
                  "needYield": 0,
                  "saveState": 138,
                  "restoreState": 138,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 138406
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_X",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 11294,
            "executionTimeMillis": 505,
            "totalKeysExamined": 0,
            "totalDocsExamined": 1027689,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 11294,
               "executionTimeMillisEstimate": 17,
               "works": 1027691,
               "advanced": 11294,
               "needTime": 1016396,
               "needYield": 0,
               "saveState": 1027,
               "restoreState": 1027,
               "isEOF": 1,
               "chunkSkips": 2419,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 13713,
                  "executionTimeMillisEstimate": 17,
                  "works": 1027691,
                  "advanced": 13713,
                  "needTime": 1013977,
                  "needYield": 0,
                  "saveState": 1027,
                  "restoreState": 1027,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 1027689
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425604,
         "i": 11
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425604,
            "i": 12
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 129581,
                     "executionTimeMillis": 547,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 129581,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 129581,
                        "executionTimeMillisEstimate": 89,
                        "works": 129583,
                        "advanced": 129581,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 145,
                        "restoreState": 145,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 129581,
                           "executionTimeMillisEstimate": 28,
                           "works": 129583,
                           "advanced": 129581,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 145,
                           "restoreState": 145,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 129581,
                              "executionTimeMillisEstimate": 8,
                              "works": 129583,
                              "advanced": 129581,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 145,
                              "restoreState": 145,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 129581
                           }
                        }
                     }
                  }
               },
               "nReturned": 129581,
               "executionTimeMillisEstimate": 485
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 674,
               "executionTimeMillisEstimate": 547
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138406,
                     "executionTimeMillis": 581,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 138406,
                        "executionTimeMillisEstimate": 78,
                        "works": 138408,
                        "advanced": 138406,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 154,
                        "restoreState": 154,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138406,
                           "executionTimeMillisEstimate": 30,
                           "works": 138408,
                           "advanced": 138406,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 154,
                           "restoreState": 154,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138406,
                              "executionTimeMillisEstimate": 5,
                              "works": 138408,
                              "advanced": 138406,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 154,
                              "restoreState": 154,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 138406,
               "executionTimeMillisEstimate": 478
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 921,
               "executionTimeMillisEstimate": 580
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 841432,
                     "executionTimeMillis": 3936,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 841432,
                        "executionTimeMillisEstimate": 601,
                        "works": 1027691,
                        "advanced": 841432,
                        "needTime": 186258,
                        "needYield": 0,
                        "saveState": 1116,
                        "restoreState": 1116,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 841432,
                           "executionTimeMillisEstimate": 268,
                           "works": 1027691,
                           "advanced": 841432,
                           "needTime": 186258,
                           "needYield": 0,
                           "saveState": 1116,
                           "restoreState": 1116,
                           "isEOF": 1,
                           "chunkSkips": 186257,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1027689,
                              "executionTimeMillisEstimate": 52,
                              "works": 1027691,
                              "advanced": 1027689,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1116,
                              "restoreState": 1116,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 841432,
               "executionTimeMillisEstimate": 3354
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1342,
               "executionTimeMillisEstimate": 3930
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425609,
         "i": 12
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425609,
            "i": 20
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 129581,
                     "executionTimeMillis": 564,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 129581,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 129581,
                        "executionTimeMillisEstimate": 78,
                        "works": 129583,
                        "advanced": 129581,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 145,
                        "restoreState": 145,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 129581,
                           "executionTimeMillisEstimate": 28,
                           "works": 129583,
                           "advanced": 129581,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 145,
                           "restoreState": 145,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 129581,
                              "executionTimeMillisEstimate": 7,
                              "works": 129583,
                              "advanced": 129581,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 145,
                              "restoreState": 145,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 129581
                           }
                        }
                     }
                  }
               },
               "nReturned": 129581,
               "executionTimeMillisEstimate": 498
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1018,
               "executionTimeMillisEstimate": 559
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138406,
                     "executionTimeMillis": 600,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 138406,
                        "executionTimeMillisEstimate": 90,
                        "works": 138408,
                        "advanced": 138406,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 154,
                        "restoreState": 154,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138406,
                           "executionTimeMillisEstimate": 29,
                           "works": 138408,
                           "advanced": 138406,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 154,
                           "restoreState": 154,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138406,
                              "executionTimeMillisEstimate": 10,
                              "works": 138408,
                              "advanced": 138406,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 154,
                              "restoreState": 154,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 138406,
               "executionTimeMillisEstimate": 519
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 713,
               "executionTimeMillisEstimate": 593
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 841432,
                     "executionTimeMillis": 4134,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 841432,
                        "executionTimeMillisEstimate": 658,
                        "works": 1027691,
                        "advanced": 841432,
                        "needTime": 186258,
                        "needYield": 0,
                        "saveState": 1116,
                        "restoreState": 1116,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 841432,
                           "executionTimeMillisEstimate": 328,
                           "works": 1027691,
                           "advanced": 841432,
                           "needTime": 186258,
                           "needYield": 0,
                           "saveState": 1116,
                           "restoreState": 1116,
                           "isEOF": 1,
                           "chunkSkips": 186257,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1027689,
                              "executionTimeMillisEstimate": 70,
                              "works": 1027691,
                              "advanced": 1027689,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1116,
                              "restoreState": 1116,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 841432,
               "executionTimeMillisEstimate": 3511
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2433,
               "executionTimeMillisEstimate": 4123
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425613,
         "i": 1062
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425613,
            "i": 1062
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 129581,
                     "executionTimeMillis": 290,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 130635,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 129581,
                        "executionTimeMillisEstimate": 29,
                        "works": 130637,
                        "advanced": 129581,
                        "needTime": 1055,
                        "needYield": 0,
                        "saveState": 135,
                        "restoreState": 135,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 129581,
                           "executionTimeMillisEstimate": 23,
                           "works": 130637,
                           "advanced": 129581,
                           "needTime": 1055,
                           "needYield": 0,
                           "saveState": 135,
                           "restoreState": 135,
                           "isEOF": 1,
                           "chunkSkips": 1054,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 130635,
                              "executionTimeMillisEstimate": 5,
                              "works": 130637,
                              "advanced": 130635,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 135,
                              "restoreState": 135,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 130635
                           }
                        }
                     }
                  }
               },
               "nReturned": 129581,
               "executionTimeMillisEstimate": 227
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 286
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138406,
                     "executionTimeMillis": 303,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138406,
                        "executionTimeMillisEstimate": 23,
                        "works": 138408,
                        "advanced": 138406,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 144,
                        "restoreState": 144,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138406,
                           "executionTimeMillisEstimate": 17,
                           "works": 138408,
                           "advanced": 138406,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 144,
                           "restoreState": 144,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 138406,
                              "executionTimeMillisEstimate": 4,
                              "works": 138408,
                              "advanced": 138406,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 144,
                              "restoreState": 144,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 138406,
               "executionTimeMillisEstimate": 245
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 302
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 841432,
                     "executionTimeMillis": 2306,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 841432,
                        "executionTimeMillisEstimate": 205,
                        "works": 1027691,
                        "advanced": 841432,
                        "needTime": 186258,
                        "needYield": 0,
                        "saveState": 1066,
                        "restoreState": 1066,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 841432,
                           "executionTimeMillisEstimate": 179,
                           "works": 1027691,
                           "advanced": 841432,
                           "needTime": 186258,
                           "needYield": 0,
                           "saveState": 1066,
                           "restoreState": 1066,
                           "isEOF": 1,
                           "chunkSkips": 186257,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 1027689,
                              "executionTimeMillisEstimate": 38,
                              "works": 1027691,
                              "advanced": 1027689,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 1066,
                              "restoreState": 1066,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 841432,
               "executionTimeMillisEstimate": 1863
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 2299
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425615,
         "i": 2546
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425615,
            "i": 2553
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 21464,
                     "executionTimeMillis": 110,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 130635,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 21464,
                        "executionTimeMillisEstimate": 5,
                        "works": 130637,
                        "advanced": 21464,
                        "needTime": 109172,
                        "needYield": 0,
                        "saveState": 131,
                        "restoreState": 131,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 21464,
                           "executionTimeMillisEstimate": 4,
                           "works": 130637,
                           "advanced": 21464,
                           "needTime": 109172,
                           "needYield": 0,
                           "saveState": 131,
                           "restoreState": 131,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 21464,
                              "executionTimeMillisEstimate": 3,
                              "works": 130637,
                              "advanced": 21464,
                              "needTime": 109172,
                              "needYield": 0,
                              "saveState": 131,
                              "restoreState": 131,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 130635
                           }
                        }
                     }
                  }
               },
               "nReturned": 21464,
               "executionTimeMillisEstimate": 98
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 100,
               "executionTimeMillisEstimate": 106
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 23147,
                     "executionTimeMillis": 137,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 23147,
                        "executionTimeMillisEstimate": 59,
                        "works": 138408,
                        "advanced": 23147,
                        "needTime": 115260,
                        "needYield": 0,
                        "saveState": 139,
                        "restoreState": 139,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 23147,
                           "executionTimeMillisEstimate": 55,
                           "works": 138408,
                           "advanced": 23147,
                           "needTime": 115260,
                           "needYield": 0,
                           "saveState": 139,
                           "restoreState": 139,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 23147,
                              "executionTimeMillisEstimate": 34,
                              "works": 138408,
                              "advanced": 23147,
                              "needTime": 115260,
                              "needYield": 0,
                              "saveState": 139,
                              "restoreState": 139,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 23147,
               "executionTimeMillisEstimate": 112
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 131,
               "executionTimeMillisEstimate": 133
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138042,
                     "executionTimeMillis": 864,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138042,
                        "executionTimeMillisEstimate": 70,
                        "works": 1027691,
                        "advanced": 138042,
                        "needTime": 889648,
                        "needYield": 0,
                        "saveState": 1033,
                        "restoreState": 1033,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138042,
                           "executionTimeMillisEstimate": 68,
                           "works": 1027691,
                           "advanced": 138042,
                           "needTime": 889648,
                           "needYield": 0,
                           "saveState": 1033,
                           "restoreState": 1033,
                           "isEOF": 1,
                           "chunkSkips": 31015,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 169057,
                              "executionTimeMillisEstimate": 39,
                              "works": 1027691,
                              "advanced": 169057,
                              "needTime": 858633,
                              "needYield": 0,
                              "saveState": 1033,
                              "restoreState": 1033,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 138042,
               "executionTimeMillisEstimate": 783
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 189,
               "executionTimeMillisEstimate": 863
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425616,
         "i": 2529
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425616,
            "i": 2535
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 21464,
                     "executionTimeMillis": 119,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 130635,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 21464,
                        "executionTimeMillisEstimate": 13,
                        "works": 130637,
                        "advanced": 21464,
                        "needTime": 109172,
                        "needYield": 0,
                        "saveState": 131,
                        "restoreState": 131,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 21464,
                           "executionTimeMillisEstimate": 9,
                           "works": 130637,
                           "advanced": 21464,
                           "needTime": 109172,
                           "needYield": 0,
                           "saveState": 131,
                           "restoreState": 131,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 21464,
                              "executionTimeMillisEstimate": 7,
                              "works": 130637,
                              "advanced": 21464,
                              "needTime": 109172,
                              "needYield": 0,
                              "saveState": 131,
                              "restoreState": 131,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 130635
                           }
                        }
                     }
                  }
               },
               "nReturned": 21464,
               "executionTimeMillisEstimate": 107
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 160,
               "executionTimeMillisEstimate": 113
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 23147,
                     "executionTimeMillis": 128,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 138406,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 23147,
                        "executionTimeMillisEstimate": 8,
                        "works": 138408,
                        "advanced": 23147,
                        "needTime": 115260,
                        "needYield": 0,
                        "saveState": 139,
                        "restoreState": 139,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 23147,
                           "executionTimeMillisEstimate": 7,
                           "works": 138408,
                           "advanced": 23147,
                           "needTime": 115260,
                           "needYield": 0,
                           "saveState": 139,
                           "restoreState": 139,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 23147,
                              "executionTimeMillisEstimate": 7,
                              "works": 138408,
                              "advanced": 23147,
                              "needTime": 115260,
                              "needYield": 0,
                              "saveState": 139,
                              "restoreState": 139,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 138406
                           }
                        }
                     }
                  }
               },
               "nReturned": 23147,
               "executionTimeMillisEstimate": 114
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 105,
               "executionTimeMillisEstimate": 119
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_X",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 138042,
                     "executionTimeMillis": 862,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 1027689,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 138042,
                        "executionTimeMillisEstimate": 60,
                        "works": 1027691,
                        "advanced": 138042,
                        "needTime": 889648,
                        "needYield": 0,
                        "saveState": 1032,
                        "restoreState": 1032,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 138042,
                           "executionTimeMillisEstimate": 57,
                           "works": 1027691,
                           "advanced": 138042,
                           "needTime": 889648,
                           "needYield": 0,
                           "saveState": 1032,
                           "restoreState": 1032,
                           "isEOF": 1,
                           "chunkSkips": 31015,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 169057,
                              "executionTimeMillisEstimate": 35,
                              "works": 1027691,
                              "advanced": 169057,
                              "needTime": 858633,
                              "needYield": 0,
                              "saveState": 1032,
                              "restoreState": 1032,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 1027689
                           }
                        }
                     }
                  }
               },
               "nReturned": 138042,
               "executionTimeMillisEstimate": 790
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 345,
               "executionTimeMillisEstimate": 859
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425616,
         "i": 2552
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425616,
            "i": 2560
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

## AirlineData_range<a name="AirlineData_range"></a>

<a href="#top">Back to top</a>
- [Query 1](#Query1)
- [Query 2](#Query2)
- [Query 3](#Query3)
- [Query 4](#Query4)
- [Query 5](#Query5)
- [Query 6](#Query6)
- [Query 7](#Query7)
- [Query 8](#Query8)
- [Query 9](#Query9)
- [Query 10](#Query10)
- [Query 11](#Query11)
- [Query 12](#Query12)
- [Query 13](#Query13)
- [Query 14](#Query14)
- [Query 15](#Query15)
- [Query 16](#Query16)
- [Query 17](#Query17)
- [Query 18](#Query18)

<a href="#top">Back to top</a>
- Query 1<a name="Query1"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 2,
            "executionTimeMillis": 570,
            "totalKeysExamined": 0,
            "totalDocsExamined": 330796,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 2,
               "executionTimeMillisEstimate": 139,
               "works": 330798,
               "advanced": 2,
               "needTime": 330795,
               "needYield": 0,
               "saveState": 331,
               "restoreState": 331,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 2,
                  "executionTimeMillisEstimate": 139,
                  "works": 330798,
                  "advanced": 2,
                  "needTime": 330795,
                  "needYield": 0,
                  "saveState": 331,
                  "restoreState": 331,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 330796
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 587,
            "totalKeysExamined": 0,
            "totalDocsExamined": 332059,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 127,
               "works": 332061,
               "advanced": 0,
               "needTime": 332060,
               "needYield": 0,
               "saveState": 332,
               "restoreState": 332,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 126,
                  "works": 332061,
                  "advanced": 0,
                  "needTime": 332060,
                  "needYield": 0,
                  "saveState": 332,
                  "restoreState": 332,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 332059
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$eq": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 1000
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 1161,
            "totalKeysExamined": 0,
            "totalDocsExamined": 753064,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 180,
               "works": 753066,
               "advanced": 0,
               "needTime": 753065,
               "needYield": 0,
               "saveState": 753,
               "restoreState": 753,
               "isEOF": 1,
               "chunkSkips": 1,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$eq": {
                                 "$date": 1601510400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 1000
                           }
                        }
                     ]
                  },
                  "nReturned": 1,
                  "executionTimeMillisEstimate": 178,
                  "works": 753066,
                  "advanced": 1,
                  "needTime": 753064,
                  "needYield": 0,
                  "saveState": 753,
                  "restoreState": 753,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 753064
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425618,
         "i": 2550
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425618,
            "i": 2556
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 2<a name="Query2"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "carrier": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 334580,
                     "executionTimeMillis": 904,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 334580,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 334580,
                        "executionTimeMillisEstimate": 83,
                        "works": 334582,
                        "advanced": 334580,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 351,
                        "restoreState": 351,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 334580,
                           "executionTimeMillisEstimate": 59,
                           "works": 334582,
                           "advanced": 334580,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 351,
                           "restoreState": 351,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 334580,
                              "executionTimeMillisEstimate": 17,
                              "works": 334582,
                              "advanced": 334580,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 351,
                              "restoreState": 351,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 334580
                           }
                        }
                     }
                  }
               },
               "nReturned": 334580,
               "executionTimeMillisEstimate": 676
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 898
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 330796,
                     "executionTimeMillis": 980,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 330796,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 330796,
                        "executionTimeMillisEstimate": 319,
                        "works": 330798,
                        "advanced": 330796,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 347,
                        "restoreState": 347,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 330796,
                           "executionTimeMillisEstimate": 243,
                           "works": 330798,
                           "advanced": 330796,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 347,
                           "restoreState": 347,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 330796,
                              "executionTimeMillisEstimate": 65,
                              "works": 330798,
                              "advanced": 330796,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 347,
                              "restoreState": 347,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 330796
                           }
                        }
                     }
                  }
               },
               "nReturned": 330796,
               "executionTimeMillisEstimate": 647
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 979
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7759D437",
                     "planCacheKey": "7759D437",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 444043,
                     "executionTimeMillis": 1479,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 753064,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 444043,
                        "executionTimeMillisEstimate": 142,
                        "works": 753066,
                        "advanced": 444043,
                        "needTime": 309022,
                        "needYield": 0,
                        "saveState": 776,
                        "restoreState": 776,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 444043,
                           "executionTimeMillisEstimate": 117,
                           "works": 753066,
                           "advanced": 444043,
                           "needTime": 309022,
                           "needYield": 0,
                           "saveState": 776,
                           "restoreState": 776,
                           "isEOF": 1,
                           "chunkSkips": 309021,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 753064,
                              "executionTimeMillisEstimate": 50,
                              "works": 753066,
                              "advanced": 753064,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 776,
                              "restoreState": 776,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 753064
                           }
                        }
                     }
                  }
               },
               "nReturned": 444043,
               "executionTimeMillisEstimate": 1180
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1476
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425620,
         "i": 13
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425620,
            "i": 13
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 3<a name="Query3"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$ORIGIN",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 333317,
                     "executionTimeMillis": 765,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 333317,
                        "executionTimeMillisEstimate": 55,
                        "works": 333319,
                        "advanced": 333317,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 345,
                        "restoreState": 345,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 333317,
                           "executionTimeMillisEstimate": 46,
                           "works": 333319,
                           "advanced": 333317,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 345,
                           "restoreState": 345,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 333317,
                              "executionTimeMillisEstimate": 15,
                              "works": 333319,
                              "advanced": 333317,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 345,
                              "restoreState": 345,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 333317,
               "executionTimeMillisEstimate": 532
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 367,
               "executionTimeMillisEstimate": 757
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 334580,
                     "executionTimeMillis": 922,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 334580,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 334580,
                        "executionTimeMillisEstimate": 225,
                        "works": 334582,
                        "advanced": 334580,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 347,
                        "restoreState": 347,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 334580,
                           "executionTimeMillisEstimate": 178,
                           "works": 334582,
                           "advanced": 334580,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 347,
                           "restoreState": 347,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 334580,
                              "executionTimeMillisEstimate": 52,
                              "works": 334582,
                              "advanced": 334580,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 347,
                              "restoreState": 347,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 334580
                           }
                        }
                     }
                  }
               },
               "nReturned": 334580,
               "executionTimeMillisEstimate": 568
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 367,
               "executionTimeMillisEstimate": 922
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "CA8C2D65",
                     "planCacheKey": "CA8C2D65",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 441522,
                     "executionTimeMillis": 1302,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 441522,
                        "executionTimeMillisEstimate": 98,
                        "works": 750545,
                        "advanced": 441522,
                        "needTime": 309022,
                        "needYield": 0,
                        "saveState": 767,
                        "restoreState": 767,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 441522,
                           "executionTimeMillisEstimate": 86,
                           "works": 750545,
                           "advanced": 441522,
                           "needTime": 309022,
                           "needYield": 0,
                           "saveState": 767,
                           "restoreState": 767,
                           "isEOF": 1,
                           "chunkSkips": 309021,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 750543,
                              "executionTimeMillisEstimate": 21,
                              "works": 750545,
                              "advanced": 750543,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 767,
                              "restoreState": 767,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 441522,
               "executionTimeMillisEstimate": 1048
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 360,
               "executionTimeMillisEstimate": 1301
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425621,
         "i": 2881
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425621,
            "i": 2882
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 4<a name="Query4"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$DEST",
               "late": {
                  "$sum": {
                     "$cond": [
                        {
                           "$gt": [
                              "$ARR_DELAY",
                              {
                                 "$const": 0
                              }
                           ]
                        },
                        {
                           "$const": 1
                        },
                        {
                           "$const": 0
                        }
                     ]
                  }
               },
               "total": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "late": {
                  "$sum": "$$ROOT.late"
               },
               "total": {
                  "$sum": "$$ROOT.total"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "_id": true,
               "origin": {
                  "$const": "_id"
               },
               "late_percent": {
                  "$multiply": [
                     {
                        "$divide": [
                           "$late",
                           "$total"
                        ]
                     },
                     {
                        "$const": 100
                     }
                  ]
               }
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "late_percent": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 334580,
                     "executionTimeMillis": 773,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 337101,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 334580,
                        "executionTimeMillisEstimate": 60,
                        "works": 337103,
                        "advanced": 334580,
                        "needTime": 2522,
                        "needYield": 0,
                        "saveState": 355,
                        "restoreState": 355,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 334580,
                           "executionTimeMillisEstimate": 48,
                           "works": 337103,
                           "advanced": 334580,
                           "needTime": 2522,
                           "needYield": 0,
                           "saveState": 355,
                           "restoreState": 355,
                           "isEOF": 1,
                           "chunkSkips": 2521,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 337101,
                              "executionTimeMillisEstimate": 13,
                              "works": 337103,
                              "advanced": 337101,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 355,
                              "restoreState": 355,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 337101
                           }
                        }
                     }
                  }
               },
               "nReturned": 334580,
               "executionTimeMillisEstimate": 546
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 367,
               "executionTimeMillisEstimate": 771
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 333317,
                     "executionTimeMillis": 789,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 333317,
                        "executionTimeMillisEstimate": 48,
                        "works": 333319,
                        "advanced": 333317,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 351,
                        "restoreState": 351,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 333317,
                           "executionTimeMillisEstimate": 37,
                           "works": 333319,
                           "advanced": 333317,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 351,
                           "restoreState": 351,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 333317,
                              "executionTimeMillisEstimate": 11,
                              "works": 333319,
                              "advanced": 333317,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 351,
                              "restoreState": 351,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 333317,
               "executionTimeMillisEstimate": 571
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 367,
               "executionTimeMillisEstimate": 779
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "4BE44022",
                     "planCacheKey": "4BE44022",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 441522,
                     "executionTimeMillis": 1322,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 441522,
                        "executionTimeMillisEstimate": 88,
                        "works": 750545,
                        "advanced": 441522,
                        "needTime": 309022,
                        "needYield": 0,
                        "saveState": 775,
                        "restoreState": 775,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 441522,
                           "executionTimeMillisEstimate": 75,
                           "works": 750545,
                           "advanced": 441522,
                           "needTime": 309022,
                           "needYield": 0,
                           "saveState": 775,
                           "restoreState": 775,
                           "isEOF": 1,
                           "chunkSkips": 309021,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 750543,
                              "executionTimeMillisEstimate": 18,
                              "works": 750545,
                              "advanced": 750543,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 775,
                              "restoreState": 775,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 441522,
               "executionTimeMillisEstimate": 1100
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "late": {
                     "$sum": {
                        "$cond": [
                           {
                              "$gt": [
                                 "$ARR_DELAY",
                                 {
                                    "$const": 0
                                 }
                              ]
                           },
                           {
                              "$const": 1
                           },
                           {
                              "$const": 0
                           }
                        ]
                     }
                  },
                  "total": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 360,
               "executionTimeMillisEstimate": 1319
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425621,
         "i": 5556
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425621,
            "i": 5556
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 5<a name="Query5"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 62212,
                     "executionTimeMillis": 339,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 337101,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 62212,
                        "executionTimeMillisEstimate": 20,
                        "works": 337103,
                        "advanced": 62212,
                        "needTime": 274890,
                        "needYield": 0,
                        "saveState": 341,
                        "restoreState": 341,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 62212,
                           "executionTimeMillisEstimate": 19,
                           "works": 337103,
                           "advanced": 62212,
                           "needTime": 274890,
                           "needYield": 0,
                           "saveState": 341,
                           "restoreState": 341,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 62212,
                              "executionTimeMillisEstimate": 13,
                              "works": 337103,
                              "advanced": 62212,
                              "needTime": 274890,
                              "needYield": 0,
                              "saveState": 341,
                              "restoreState": 341,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 337101
                           }
                        }
                     }
                  }
               },
               "nReturned": 62212,
               "executionTimeMillisEstimate": 291
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 338
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 63104,
                     "executionTimeMillis": 378,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 63104,
                        "executionTimeMillisEstimate": 159,
                        "works": 333319,
                        "advanced": 63104,
                        "needTime": 270214,
                        "needYield": 0,
                        "saveState": 336,
                        "restoreState": 336,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 63104,
                           "executionTimeMillisEstimate": 142,
                           "works": 333319,
                           "advanced": 63104,
                           "needTime": 270214,
                           "needYield": 0,
                           "saveState": 336,
                           "restoreState": 336,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 63104,
                              "executionTimeMillisEstimate": 99,
                              "works": 333319,
                              "advanced": 63104,
                              "needTime": 270214,
                              "needYield": 0,
                              "saveState": 336,
                              "restoreState": 336,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 63104,
               "executionTimeMillisEstimate": 312
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 363,
               "executionTimeMillisEstimate": 378
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "371B563C",
                     "planCacheKey": "371B563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 90199,
                     "executionTimeMillis": 640,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 90199,
                        "executionTimeMillisEstimate": 54,
                        "works": 750545,
                        "advanced": 90199,
                        "needTime": 660345,
                        "needYield": 0,
                        "saveState": 754,
                        "restoreState": 754,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 90199,
                           "executionTimeMillisEstimate": 47,
                           "works": 750545,
                           "advanced": 90199,
                           "needTime": 660345,
                           "needYield": 0,
                           "saveState": 754,
                           "restoreState": 754,
                           "isEOF": 1,
                           "chunkSkips": 65154,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 155353,
                              "executionTimeMillisEstimate": 36,
                              "works": 750545,
                              "advanced": 155353,
                              "needTime": 595191,
                              "needYield": 0,
                              "saveState": 754,
                              "restoreState": 754,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 90199,
               "executionTimeMillisEstimate": 575
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 359,
               "executionTimeMillisEstimate": 637
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425623,
         "i": 2763
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425623,
            "i": 2763
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 6<a name="Query6"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 62212,
                     "executionTimeMillis": 288,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 337101,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 62212,
                        "executionTimeMillisEstimate": 12,
                        "works": 337103,
                        "advanced": 62212,
                        "needTime": 274890,
                        "needYield": 0,
                        "saveState": 339,
                        "restoreState": 339,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 62212,
                           "executionTimeMillisEstimate": 9,
                           "works": 337103,
                           "advanced": 62212,
                           "needTime": 274890,
                           "needYield": 0,
                           "saveState": 339,
                           "restoreState": 339,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 62212,
                              "executionTimeMillisEstimate": 7,
                              "works": 337103,
                              "advanced": 62212,
                              "needTime": 274890,
                              "needYield": 0,
                              "saveState": 339,
                              "restoreState": 339,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 337101
                           }
                        }
                     }
                  }
               },
               "nReturned": 62212,
               "executionTimeMillisEstimate": 245
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 286
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 63104,
                     "executionTimeMillis": 288,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 63104,
                        "executionTimeMillisEstimate": 24,
                        "works": 333319,
                        "advanced": 63104,
                        "needTime": 270214,
                        "needYield": 0,
                        "saveState": 337,
                        "restoreState": 337,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 63104,
                           "executionTimeMillisEstimate": 20,
                           "works": 333319,
                           "advanced": 63104,
                           "needTime": 270214,
                           "needYield": 0,
                           "saveState": 337,
                           "restoreState": 337,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 63104,
                              "executionTimeMillisEstimate": 15,
                              "works": 333319,
                              "advanced": 63104,
                              "needTime": 270214,
                              "needYield": 0,
                              "saveState": 337,
                              "restoreState": 337,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 63104,
               "executionTimeMillisEstimate": 242
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 362,
               "executionTimeMillisEstimate": 287
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "F8545D2F",
                     "planCacheKey": "F8545D2F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 90199,
                     "executionTimeMillis": 618,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 90199,
                        "executionTimeMillisEstimate": 50,
                        "works": 750545,
                        "advanced": 90199,
                        "needTime": 660345,
                        "needYield": 0,
                        "saveState": 755,
                        "restoreState": 755,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 90199,
                           "executionTimeMillisEstimate": 43,
                           "works": 750545,
                           "advanced": 90199,
                           "needTime": 660345,
                           "needYield": 0,
                           "saveState": 755,
                           "restoreState": 755,
                           "isEOF": 1,
                           "chunkSkips": 65154,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 155353,
                              "executionTimeMillisEstimate": 29,
                              "works": 750545,
                              "advanced": 155353,
                              "needTime": 595191,
                              "needYield": 0,
                              "saveState": 755,
                              "restoreState": 755,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 90199,
               "executionTimeMillisEstimate": 560
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 358,
               "executionTimeMillisEstimate": 610
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425623,
         "i": 7635
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425623,
            "i": 7643
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 7<a name="Query7"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "ARR_DELAY": {
                  "$gt": 0
               }
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 62212,
                     "executionTimeMillis": 297,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 337101,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 62212,
                        "executionTimeMillisEstimate": 16,
                        "works": 337103,
                        "advanced": 62212,
                        "needTime": 274890,
                        "needYield": 0,
                        "saveState": 341,
                        "restoreState": 341,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 62212,
                           "executionTimeMillisEstimate": 14,
                           "works": 337103,
                           "advanced": 62212,
                           "needTime": 274890,
                           "needYield": 0,
                           "saveState": 341,
                           "restoreState": 341,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 62212,
                              "executionTimeMillisEstimate": 7,
                              "works": 337103,
                              "advanced": 62212,
                              "needTime": 274890,
                              "needYield": 0,
                              "saveState": 341,
                              "restoreState": 341,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 337101
                           }
                        }
                     }
                  }
               },
               "nReturned": 62212,
               "executionTimeMillisEstimate": 259
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 294
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 63104,
                     "executionTimeMillis": 307,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 63104,
                        "executionTimeMillisEstimate": 17,
                        "works": 333319,
                        "advanced": 63104,
                        "needTime": 270214,
                        "needYield": 0,
                        "saveState": 337,
                        "restoreState": 337,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 63104,
                           "executionTimeMillisEstimate": 16,
                           "works": 333319,
                           "advanced": 63104,
                           "needTime": 270214,
                           "needYield": 0,
                           "saveState": 337,
                           "restoreState": 337,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 63104,
                              "executionTimeMillisEstimate": 12,
                              "works": 333319,
                              "advanced": 63104,
                              "needTime": 270214,
                              "needYield": 0,
                              "saveState": 337,
                              "restoreState": 337,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 63104,
               "executionTimeMillisEstimate": 267
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 304
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "ARR_DELAY": {
                           "$gt": 0
                        }
                     },
                     "queryHash": "B4AB563C",
                     "planCacheKey": "B4AB563C",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 90199,
                     "executionTimeMillis": 611,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 90199,
                        "executionTimeMillisEstimate": 30,
                        "works": 750545,
                        "advanced": 90199,
                        "needTime": 660345,
                        "needYield": 0,
                        "saveState": 755,
                        "restoreState": 755,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 90199,
                           "executionTimeMillisEstimate": 27,
                           "works": 750545,
                           "advanced": 90199,
                           "needTime": 660345,
                           "needYield": 0,
                           "saveState": 755,
                           "restoreState": 755,
                           "isEOF": 1,
                           "chunkSkips": 65154,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "ARR_DELAY": {
                                    "$gt": 0
                                 }
                              },
                              "nReturned": 155353,
                              "executionTimeMillisEstimate": 21,
                              "works": 750545,
                              "advanced": 155353,
                              "needTime": 595191,
                              "needYield": 0,
                              "saveState": 755,
                              "restoreState": 755,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 90199,
               "executionTimeMillisEstimate": 543
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 608
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425624,
         "i": 2
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425624,
            "i": 2
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 8<a name="Query8"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 317,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 9,
                        "works": 750545,
                        "advanced": 0,
                        "needTime": 750544,
                        "needYield": 0,
                        "saveState": 751,
                        "restoreState": 751,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 9,
                           "works": 750545,
                           "advanced": 0,
                           "needTime": 750544,
                           "needYield": 0,
                           "saveState": 751,
                           "restoreState": 751,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 9,
                              "works": 750545,
                              "advanced": 0,
                              "needTime": 750544,
                              "needYield": 0,
                              "saveState": 751,
                              "restoreState": 751,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 317
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 317
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 170399,
                     "executionTimeMillis": 522,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 337101,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 170399,
                        "executionTimeMillisEstimate": 44,
                        "works": 337103,
                        "advanced": 170399,
                        "needTime": 166703,
                        "needYield": 0,
                        "saveState": 343,
                        "restoreState": 343,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 170399,
                           "executionTimeMillisEstimate": 37,
                           "works": 337103,
                           "advanced": 170399,
                           "needTime": 166703,
                           "needYield": 0,
                           "saveState": 343,
                           "restoreState": 343,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 170399,
                              "executionTimeMillisEstimate": 16,
                              "works": 337103,
                              "advanced": 170399,
                              "needTime": 166703,
                              "needYield": 0,
                              "saveState": 343,
                              "restoreState": 343,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 337101
                           }
                        }
                     }
                  }
               },
               "nReturned": 170399,
               "executionTimeMillisEstimate": 410
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 517
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "2D41D3FF",
                     "planCacheKey": "2D41D3FF",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 174895,
                     "executionTimeMillis": 572,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 174895,
                        "executionTimeMillisEstimate": 54,
                        "works": 333319,
                        "advanced": 174895,
                        "needTime": 158423,
                        "needYield": 0,
                        "saveState": 340,
                        "restoreState": 340,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 174895,
                           "executionTimeMillisEstimate": 48,
                           "works": 333319,
                           "advanced": 174895,
                           "needTime": 158423,
                           "needYield": 0,
                           "saveState": 340,
                           "restoreState": 340,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 174895,
                              "executionTimeMillisEstimate": 15,
                              "works": 333319,
                              "advanced": 174895,
                              "needTime": 158423,
                              "needYield": 0,
                              "saveState": 340,
                              "restoreState": 340,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 174895,
               "executionTimeMillisEstimate": 443
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 569
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425625,
         "i": 2116
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425625,
            "i": 2118
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 9<a name="Query9"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 314,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 15,
                        "works": 750545,
                        "advanced": 0,
                        "needTime": 750544,
                        "needYield": 0,
                        "saveState": 751,
                        "restoreState": 751,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 15,
                           "works": 750545,
                           "advanced": 0,
                           "needTime": 750544,
                           "needYield": 0,
                           "saveState": 751,
                           "restoreState": 751,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 14,
                              "works": 750545,
                              "advanced": 0,
                              "needTime": 750544,
                              "needYield": 0,
                              "saveState": 751,
                              "restoreState": 751,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 313
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 313
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 170399,
                     "executionTimeMillis": 513,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 337101,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 170399,
                        "executionTimeMillisEstimate": 35,
                        "works": 337103,
                        "advanced": 170399,
                        "needTime": 166703,
                        "needYield": 0,
                        "saveState": 346,
                        "restoreState": 346,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 170399,
                           "executionTimeMillisEstimate": 23,
                           "works": 337103,
                           "advanced": 170399,
                           "needTime": 166703,
                           "needYield": 0,
                           "saveState": 346,
                           "restoreState": 346,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 170399,
                              "executionTimeMillisEstimate": 8,
                              "works": 337103,
                              "advanced": 170399,
                              "needTime": 166703,
                              "needYield": 0,
                              "saveState": 346,
                              "restoreState": 346,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 337101
                           }
                        }
                     }
                  }
               },
               "nReturned": 170399,
               "executionTimeMillisEstimate": 421
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 503
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "C599687E",
                     "planCacheKey": "C599687E",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 174895,
                     "executionTimeMillis": 545,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 174895,
                        "executionTimeMillisEstimate": 40,
                        "works": 333319,
                        "advanced": 174895,
                        "needTime": 158423,
                        "needYield": 0,
                        "saveState": 342,
                        "restoreState": 342,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 174895,
                           "executionTimeMillisEstimate": 34,
                           "works": 333319,
                           "advanced": 174895,
                           "needTime": 158423,
                           "needYield": 0,
                           "saveState": 342,
                           "restoreState": 342,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 174895,
                              "executionTimeMillisEstimate": 12,
                              "works": 333319,
                              "advanced": 174895,
                              "needTime": 158423,
                              "needYield": 0,
                              "saveState": 342,
                              "restoreState": 342,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 174895,
               "executionTimeMillisEstimate": 416
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 366,
               "executionTimeMillisEstimate": 533
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425625,
         "i": 2140
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425625,
            "i": 2140
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 10<a name="Query10"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1601510400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "avgDelay": -1
               }
            }
         }
      ]
   },
   "shards": {
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 313,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 4,
                        "works": 750545,
                        "advanced": 0,
                        "needTime": 750544,
                        "needYield": 0,
                        "saveState": 751,
                        "restoreState": 751,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 4,
                           "works": 750545,
                           "advanced": 0,
                           "needTime": 750544,
                           "needYield": 0,
                           "saveState": 751,
                           "restoreState": 751,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 0,
                              "executionTimeMillisEstimate": 4,
                              "works": 750545,
                              "advanced": 0,
                              "needTime": 750544,
                              "needYield": 0,
                              "saveState": 751,
                              "restoreState": 751,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 313
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 313
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 170399,
                     "executionTimeMillis": 513,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 337101,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 170399,
                        "executionTimeMillisEstimate": 25,
                        "works": 337103,
                        "advanced": 170399,
                        "needTime": 166703,
                        "needYield": 0,
                        "saveState": 345,
                        "restoreState": 345,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 170399,
                           "executionTimeMillisEstimate": 20,
                           "works": 337103,
                           "advanced": 170399,
                           "needTime": 166703,
                           "needYield": 0,
                           "saveState": 345,
                           "restoreState": 345,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 170399,
                              "executionTimeMillisEstimate": 9,
                              "works": 337103,
                              "advanced": 170399,
                              "needTime": 166703,
                              "needYield": 0,
                              "saveState": 345,
                              "restoreState": 345,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 337101
                           }
                        }
                     }
                  }
               },
               "nReturned": 170399,
               "executionTimeMillisEstimate": 408
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 507
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1601510400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1598918400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "72A83352",
                     "planCacheKey": "72A83352",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 174895,
                     "executionTimeMillis": 537,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 174895,
                        "executionTimeMillisEstimate": 40,
                        "works": 333319,
                        "advanced": 174895,
                        "needTime": 158423,
                        "needYield": 0,
                        "saveState": 343,
                        "restoreState": 343,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 174895,
                           "executionTimeMillisEstimate": 36,
                           "works": 333319,
                           "advanced": 174895,
                           "needTime": 158423,
                           "needYield": 0,
                           "saveState": 343,
                           "restoreState": 343,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1598918400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 174895,
                              "executionTimeMillisEstimate": 13,
                              "works": 333319,
                              "advanced": 174895,
                              "needTime": 158423,
                              "needYield": 0,
                              "saveState": 343,
                              "restoreState": 343,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 174895,
               "executionTimeMillisEstimate": 427
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 537
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425625,
         "i": 2140
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425625,
            "i": 2140
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 11<a name="Query11"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "ORIGIN": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 337101,
                     "executionTimeMillis": 929,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 339622,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 337101,
                        "executionTimeMillisEstimate": 56,
                        "works": 339624,
                        "advanced": 337101,
                        "needTime": 2522,
                        "needYield": 0,
                        "saveState": 357,
                        "restoreState": 357,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 337101,
                           "executionTimeMillisEstimate": 39,
                           "works": 339624,
                           "advanced": 337101,
                           "needTime": 2522,
                           "needYield": 0,
                           "saveState": 357,
                           "restoreState": 357,
                           "isEOF": 1,
                           "chunkSkips": 2521,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 339622,
                              "executionTimeMillisEstimate": 13,
                              "works": 339624,
                              "advanced": 339622,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 357,
                              "restoreState": 357,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 339622
                           }
                        }
                     }
                  }
               },
               "nReturned": 337101,
               "executionTimeMillisEstimate": 553
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1189,
               "executionTimeMillisEstimate": 929
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 333317,
                     "executionTimeMillis": 987,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 333317,
                        "executionTimeMillisEstimate": 61,
                        "works": 333319,
                        "advanced": 333317,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 349,
                        "restoreState": 349,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 333317,
                           "executionTimeMillisEstimate": 39,
                           "works": 333319,
                           "advanced": 333317,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 349,
                           "restoreState": 349,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 333317,
                              "executionTimeMillisEstimate": 10,
                              "works": 333319,
                              "advanced": 333317,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 349,
                              "restoreState": 349,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 333317,
               "executionTimeMillisEstimate": 600
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1187,
               "executionTimeMillisEstimate": 976
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "682B05B1",
                     "planCacheKey": "682B05B1",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 439001,
                     "executionTimeMillis": 1587,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 439001,
                        "executionTimeMillisEstimate": 99,
                        "works": 750545,
                        "advanced": 439001,
                        "needTime": 311543,
                        "needYield": 0,
                        "saveState": 773,
                        "restoreState": 773,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 439001,
                           "executionTimeMillisEstimate": 80,
                           "works": 750545,
                           "advanced": 439001,
                           "needTime": 311543,
                           "needYield": 0,
                           "saveState": 773,
                           "restoreState": 773,
                           "isEOF": 1,
                           "chunkSkips": 311542,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 750543,
                              "executionTimeMillisEstimate": 18,
                              "works": 750545,
                              "advanced": 750543,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 773,
                              "restoreState": 773,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 439001,
               "executionTimeMillisEstimate": 1011
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1174,
               "executionTimeMillisEstimate": 1582
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425627,
         "i": 21
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425627,
            "i": 21
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 12<a name="Query12"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$MKT_UNIQUE_CARRIER"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "MKT_UNIQUE_CARRIER": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         },
         {
            "$sort": {
               "sortKey": {
                  "DEST": 1
               }
            }
         }
      ]
   },
   "shards": {
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 339622,
                     "executionTimeMillis": 998,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 339622,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 339622,
                        "executionTimeMillisEstimate": 59,
                        "works": 339624,
                        "advanced": 339622,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 365,
                        "restoreState": 365,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 339622,
                           "executionTimeMillisEstimate": 35,
                           "works": 339624,
                           "advanced": 339622,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 365,
                           "restoreState": 365,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 339622,
                              "executionTimeMillisEstimate": 11,
                              "works": 339624,
                              "advanced": 339622,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 365,
                              "restoreState": 365,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 339622
                           }
                        }
                     }
                  }
               },
               "nReturned": 339622,
               "executionTimeMillisEstimate": 593
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1189,
               "executionTimeMillisEstimate": 993
            }
         ]
      },
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 333317,
                     "executionTimeMillis": 1205,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 333317,
                        "executionTimeMillisEstimate": 272,
                        "works": 333319,
                        "advanced": 333317,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 357,
                        "restoreState": 357,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 333317,
                           "executionTimeMillisEstimate": 189,
                           "works": 333319,
                           "advanced": 333317,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 357,
                           "restoreState": 357,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 333317,
                              "executionTimeMillisEstimate": 55,
                              "works": 333319,
                              "advanced": 333317,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 357,
                              "restoreState": 357,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 333317,
               "executionTimeMillisEstimate": 641
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1185,
               "executionTimeMillisEstimate": 1205
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "7047D1E8",
                     "planCacheKey": "7047D1E8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 436480,
                     "executionTimeMillis": 1773,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 436480,
                        "executionTimeMillisEstimate": 127,
                        "works": 750545,
                        "advanced": 436480,
                        "needTime": 314064,
                        "needYield": 0,
                        "saveState": 782,
                        "restoreState": 782,
                        "isEOF": 1,
                        "transformBy": {
                           "ARR_DELAY": 1,
                           "DEST": 1,
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 436480,
                           "executionTimeMillisEstimate": 101,
                           "works": 750545,
                           "advanced": 436480,
                           "needTime": 314064,
                           "needYield": 0,
                           "saveState": 782,
                           "restoreState": 782,
                           "isEOF": 1,
                           "chunkSkips": 314063,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 750543,
                              "executionTimeMillisEstimate": 21,
                              "works": 750545,
                              "advanced": 750543,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 782,
                              "restoreState": 782,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 436480,
               "executionTimeMillisEstimate": 1145
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$MKT_UNIQUE_CARRIER"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 1174,
               "executionTimeMillisEstimate": 1771
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425629,
         "i": 10
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425629,
            "i": 10
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 13<a name="Query13"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  }
               ]
            }
         }
      ],
      "mergerPart": []
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 7650,
            "executionTimeMillis": 170,
            "totalKeysExamined": 0,
            "totalDocsExamined": 333317,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 7650,
               "executionTimeMillisEstimate": 3,
               "works": 333319,
               "advanced": 7650,
               "needTime": 325668,
               "needYield": 0,
               "saveState": 333,
               "restoreState": 333,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 7650,
                  "executionTimeMillisEstimate": 3,
                  "works": 333319,
                  "advanced": 7650,
                  "needTime": 325668,
                  "needYield": 0,
                  "saveState": 333,
                  "restoreState": 333,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 333317
               }
            }
         }
      },
      "shard03": {
         "host": "localhost:27020",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 7175,
            "executionTimeMillis": 170,
            "totalKeysExamined": 0,
            "totalDocsExamined": 339622,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 7175,
               "executionTimeMillisEstimate": 9,
               "works": 339624,
               "advanced": 7175,
               "needTime": 332448,
               "needYield": 0,
               "saveState": 339,
               "restoreState": 339,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 7175,
                  "executionTimeMillisEstimate": 8,
                  "works": 339624,
                  "advanced": 7175,
                  "needTime": 332448,
                  "needYield": 0,
                  "saveState": 339,
                  "restoreState": 339,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 339622
               }
            }
         }
      },
      "shard01": {
         "host": "localhost:27018",
         "queryPlanner": {
            "plannerVersion": 1,
            "namespace": "SummerResearch.AirlineData_range",
            "indexFilterSet": false,
            "parsedQuery": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1600214400000
                        }
                     }
                  },
                  {
                     "ARR_DELAY": {
                        "$gt": 10
                     }
                  },
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1598918400000
                        }
                     }
                  }
               ]
            },
            "optimizedPipeline": true,
            "winningPlan": {
               "stage": "SHARDING_FILTER",
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "direction": "forward"
               }
            },
            "rejectedPlans": []
         },
         "executionStats": {
            "executionSuccess": true,
            "nReturned": 0,
            "executionTimeMillis": 314,
            "totalKeysExamined": 0,
            "totalDocsExamined": 750543,
            "executionStages": {
               "stage": "SHARDING_FILTER",
               "nReturned": 0,
               "executionTimeMillisEstimate": 15,
               "works": 750545,
               "advanced": 0,
               "needTime": 750544,
               "needYield": 0,
               "saveState": 750,
               "restoreState": 750,
               "isEOF": 1,
               "chunkSkips": 0,
               "inputStage": {
                  "stage": "COLLSCAN",
                  "filter": {
                     "$and": [
                        {
                           "FL_DATE": {
                              "$lt": {
                                 "$date": 1600214400000
                              }
                           }
                        },
                        {
                           "ARR_DELAY": {
                              "$gt": 10
                           }
                        },
                        {
                           "FL_DATE": {
                              "$gte": {
                                 "$date": 1598918400000
                              }
                           }
                        }
                     ]
                  },
                  "nReturned": 0,
                  "executionTimeMillisEstimate": 15,
                  "works": 750545,
                  "advanced": 0,
                  "needTime": 750544,
                  "needYield": 0,
                  "saveState": 750,
                  "restoreState": 750,
                  "isEOF": 1,
                  "direction": "forward",
                  "docsExamined": 750543
               }
            }
         }
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425630,
         "i": 1
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425630,
            "i": 3
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 14<a name="Query14"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "ORIGIN": "$ORIGIN",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$ORIGIN",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "ORIGIN": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 333317,
                     "executionTimeMillis": 1378,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333317,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 333317,
                        "executionTimeMillisEstimate": 152,
                        "works": 333319,
                        "advanced": 333317,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 373,
                        "restoreState": 373,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 333317,
                           "executionTimeMillisEstimate": 62,
                           "works": 333319,
                           "advanced": 333317,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 373,
                           "restoreState": 373,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 333317,
                              "executionTimeMillisEstimate": 10,
                              "works": 333319,
                              "advanced": 333317,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 373,
                              "restoreState": 373,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333317
                           }
                        }
                     }
                  }
               },
               "nReturned": 333317,
               "executionTimeMillisEstimate": 1167
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2494,
               "executionTimeMillisEstimate": 1369
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 339622,
                     "executionTimeMillis": 1382,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 339622,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 339622,
                        "executionTimeMillisEstimate": 193,
                        "works": 339624,
                        "advanced": 339622,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 379,
                        "restoreState": 379,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 339622,
                           "executionTimeMillisEstimate": 79,
                           "works": 339624,
                           "advanced": 339622,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 379,
                           "restoreState": 379,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 339622,
                              "executionTimeMillisEstimate": 24,
                              "works": 339624,
                              "advanced": 339622,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 379,
                              "restoreState": 379,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 339622
                           }
                        }
                     }
                  }
               },
               "nReturned": 339622,
               "executionTimeMillisEstimate": 1168
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2506,
               "executionTimeMillisEstimate": 1379
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "3AC8BC28",
                     "planCacheKey": "3AC8BC28",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 436480,
                     "executionTimeMillis": 2144,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 436480,
                        "executionTimeMillisEstimate": 328,
                        "works": 750545,
                        "advanced": 436480,
                        "needTime": 314064,
                        "needYield": 0,
                        "saveState": 802,
                        "restoreState": 802,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "ORIGIN": "$ORIGIN",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 436480,
                           "executionTimeMillisEstimate": 138,
                           "works": 750545,
                           "advanced": 436480,
                           "needTime": 314064,
                           "needYield": 0,
                           "saveState": 802,
                           "restoreState": 802,
                           "isEOF": 1,
                           "chunkSkips": 314063,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 750543,
                              "executionTimeMillisEstimate": 36,
                              "works": 750545,
                              "advanced": 750543,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 802,
                              "restoreState": 802,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 436480,
               "executionTimeMillisEstimate": 1818
            },
            {
               "$group": {
                  "_id": [
                     "$ORIGIN",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2473,
               "executionTimeMillisEstimate": 2135
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425632,
         "i": 999
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425632,
            "i": 1000
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 15<a name="Query15"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$project": {
               "_id": true,
               "DEST": "$DEST",
               "day": {
                  "$dayOfWeek": {
                     "date": "$FL_DATE"
                  }
               },
               "ARR_DELAY": "$ARR_DELAY"
            }
         },
         {
            "$group": {
               "_id": [
                  "$DEST",
                  "$day"
               ],
               "avgDelay": {
                  "$avg": "$ARR_DELAY"
               },
               "maxDelay": {
                  "$max": "$ARR_DELAY"
               },
               "minDelay": {
                  "$min": "$ARR_DELAY"
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "avgDelay": {
                  "$avg": "$$ROOT.avgDelay"
               },
               "maxDelay": {
                  "$max": "$$ROOT.maxDelay"
               },
               "minDelay": {
                  "$min": "$$ROOT.minDelay"
               },
               "$doingMerge": true
            }
         },
         {
            "$project": {
               "DEST": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 0
                     }
                  ]
               },
               "day": {
                  "$arrayElemAt": [
                     "$_id",
                     {
                        "$const": 1
                     }
                  ]
               },
               "avgDelay": "$avgDelay",
               "maxDelay": "$maxDelay",
               "minDelay": "$minDelay",
               "_id": false
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 333317,
                     "executionTimeMillis": 1351,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 333817,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 333317,
                        "executionTimeMillisEstimate": 165,
                        "works": 333819,
                        "advanced": 333317,
                        "needTime": 501,
                        "needYield": 0,
                        "saveState": 373,
                        "restoreState": 373,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 333317,
                           "executionTimeMillisEstimate": 78,
                           "works": 333819,
                           "advanced": 333317,
                           "needTime": 501,
                           "needYield": 0,
                           "saveState": 373,
                           "restoreState": 373,
                           "isEOF": 1,
                           "chunkSkips": 500,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 333817,
                              "executionTimeMillisEstimate": 32,
                              "works": 333819,
                              "advanced": 333817,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 373,
                              "restoreState": 373,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 333817
                           }
                        }
                     }
                  }
               },
               "nReturned": 333317,
               "executionTimeMillisEstimate": 1152
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2490,
               "executionTimeMillisEstimate": 1348
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 339622,
                     "executionTimeMillis": 1375,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 339622,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 339622,
                        "executionTimeMillisEstimate": 171,
                        "works": 339624,
                        "advanced": 339622,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 379,
                        "restoreState": 379,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 339622,
                           "executionTimeMillisEstimate": 63,
                           "works": 339624,
                           "advanced": 339622,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 379,
                           "restoreState": 379,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 339622,
                              "executionTimeMillisEstimate": 20,
                              "works": 339624,
                              "advanced": 339622,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 379,
                              "restoreState": 379,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 339622
                           }
                        }
                     }
                  }
               },
               "nReturned": 339622,
               "executionTimeMillisEstimate": 1160
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2505,
               "executionTimeMillisEstimate": 1375
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "6EFB5E20",
                     "planCacheKey": "6EFB5E20",
                     "winningPlan": {
                        "stage": "PROJECTION_DEFAULT",
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 436480,
                     "executionTimeMillis": 2100,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_DEFAULT",
                        "nReturned": 436480,
                        "executionTimeMillisEstimate": 288,
                        "works": 750545,
                        "advanced": 436480,
                        "needTime": 314064,
                        "needYield": 0,
                        "saveState": 802,
                        "restoreState": 802,
                        "isEOF": 1,
                        "transformBy": {
                           "_id": true,
                           "DEST": "$DEST",
                           "day": {
                              "$dayOfWeek": {
                                 "date": "$FL_DATE"
                              }
                           },
                           "ARR_DELAY": "$ARR_DELAY"
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 436480,
                           "executionTimeMillisEstimate": 131,
                           "works": 750545,
                           "advanced": 436480,
                           "needTime": 314064,
                           "needYield": 0,
                           "saveState": 802,
                           "restoreState": 802,
                           "isEOF": 1,
                           "chunkSkips": 314063,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 750543,
                              "executionTimeMillisEstimate": 31,
                              "works": 750545,
                              "advanced": 750543,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 802,
                              "restoreState": 802,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 436480,
               "executionTimeMillisEstimate": 1812
            },
            {
               "$group": {
                  "_id": [
                     "$DEST",
                     "$day"
                  ],
                  "avgDelay": {
                     "$avg": "$ARR_DELAY"
                  },
                  "maxDelay": {
                     "$max": "$ARR_DELAY"
                  },
                  "minDelay": {
                     "$min": "$ARR_DELAY"
                  }
               },
               "nReturned": 2473,
               "executionTimeMillisEstimate": 2088
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425634,
         "i": 1
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425634,
            "i": 9
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 16<a name="Query16"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$group": {
               "_id": "$MKT_UNIQUE_CARRIER",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 335838,
                     "executionTimeMillis": 712,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 335838,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 335838,
                        "executionTimeMillisEstimate": 45,
                        "works": 335840,
                        "advanced": 335838,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 349,
                        "restoreState": 349,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 335838,
                           "executionTimeMillisEstimate": 36,
                           "works": 335840,
                           "advanced": 335838,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 349,
                           "restoreState": 349,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 335838,
                              "executionTimeMillisEstimate": 7,
                              "works": 335840,
                              "advanced": 335838,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 349,
                              "restoreState": 349,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 335838
                           }
                        }
                     }
                  }
               },
               "nReturned": 335838,
               "executionTimeMillisEstimate": 550
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 708
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 339622,
                     "executionTimeMillis": 859,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 339622,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 339622,
                        "executionTimeMillisEstimate": 241,
                        "works": 339624,
                        "advanced": 339622,
                        "needTime": 1,
                        "needYield": 0,
                        "saveState": 352,
                        "restoreState": 352,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 339622,
                           "executionTimeMillisEstimate": 208,
                           "works": 339624,
                           "advanced": 339622,
                           "needTime": 1,
                           "needYield": 0,
                           "saveState": 352,
                           "restoreState": 352,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 339622,
                              "executionTimeMillisEstimate": 71,
                              "works": 339624,
                              "advanced": 339622,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 352,
                              "restoreState": 352,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 339622
                           }
                        }
                     }
                  }
               },
               "nReturned": 339622,
               "executionTimeMillisEstimate": 570
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 851
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {},
                     "queryHash": "C995A0D8",
                     "planCacheKey": "C995A0D8",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 433959,
                     "executionTimeMillis": 1254,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 433959,
                        "executionTimeMillisEstimate": 83,
                        "works": 750545,
                        "advanced": 433959,
                        "needTime": 316585,
                        "needYield": 0,
                        "saveState": 767,
                        "restoreState": 767,
                        "isEOF": 1,
                        "transformBy": {
                           "MKT_UNIQUE_CARRIER": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 433959,
                           "executionTimeMillisEstimate": 66,
                           "works": 750545,
                           "advanced": 433959,
                           "needTime": 316585,
                           "needYield": 0,
                           "saveState": 767,
                           "restoreState": 767,
                           "isEOF": 1,
                           "chunkSkips": 316584,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "nReturned": 750543,
                              "executionTimeMillisEstimate": 16,
                              "works": 750545,
                              "advanced": 750543,
                              "needTime": 1,
                              "needYield": 0,
                              "saveState": 767,
                              "restoreState": 767,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 433959,
               "executionTimeMillisEstimate": 1004
            },
            {
               "$group": {
                  "_id": "$MKT_UNIQUE_CARRIER",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 10,
               "executionTimeMillisEstimate": 1252
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425635,
         "i": 113
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425635,
            "i": 113
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 17<a name="Query17"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$ORIGIN",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 86608,
                     "executionTimeMillis": 364,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 335838,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 86608,
                        "executionTimeMillisEstimate": 20,
                        "works": 335840,
                        "advanced": 86608,
                        "needTime": 249231,
                        "needYield": 0,
                        "saveState": 339,
                        "restoreState": 339,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 86608,
                           "executionTimeMillisEstimate": 20,
                           "works": 335840,
                           "advanced": 86608,
                           "needTime": 249231,
                           "needYield": 0,
                           "saveState": 339,
                           "restoreState": 339,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 86608,
                              "executionTimeMillisEstimate": 9,
                              "works": 335840,
                              "advanced": 86608,
                              "needTime": 249231,
                              "needYield": 0,
                              "saveState": 339,
                              "restoreState": 339,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 335838
                           }
                        }
                     }
                  }
               },
               "nReturned": 86608,
               "executionTimeMillisEstimate": 319
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 365
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 96045,
                     "executionTimeMillis": 391,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 339622,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 96045,
                        "executionTimeMillisEstimate": 22,
                        "works": 339624,
                        "advanced": 96045,
                        "needTime": 243578,
                        "needYield": 0,
                        "saveState": 343,
                        "restoreState": 343,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 96045,
                           "executionTimeMillisEstimate": 18,
                           "works": 339624,
                           "advanced": 96045,
                           "needTime": 243578,
                           "needYield": 0,
                           "saveState": 343,
                           "restoreState": 343,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 96045,
                              "executionTimeMillisEstimate": 14,
                              "works": 339624,
                              "advanced": 96045,
                              "needTime": 243578,
                              "needYield": 0,
                              "saveState": 343,
                              "restoreState": 343,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 339622
                           }
                        }
                     }
                  }
               },
               "nReturned": 96045,
               "executionTimeMillisEstimate": 337
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 387
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "31CD4C21",
                     "planCacheKey": "31CD4C21",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 473,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 34,
                        "works": 750545,
                        "advanced": 0,
                        "needTime": 750544,
                        "needYield": 0,
                        "saveState": 751,
                        "restoreState": 751,
                        "isEOF": 1,
                        "transformBy": {
                           "ORIGIN": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 34,
                           "works": 750545,
                           "advanced": 0,
                           "needTime": 750544,
                           "needYield": 0,
                           "saveState": 751,
                           "restoreState": 751,
                           "isEOF": 1,
                           "chunkSkips": 169071,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 169071,
                              "executionTimeMillisEstimate": 19,
                              "works": 750545,
                              "advanced": 169071,
                              "needTime": 581473,
                              "needYield": 0,
                              "saveState": 751,
                              "restoreState": 751,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 473
            },
            {
               "$group": {
                  "_id": "$ORIGIN",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 473
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425636,
         "i": 1071
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425636,
            "i": 1071
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

<a href="#top">Back to top</a>
- Query 18<a name="Query18"></a>
```
{
   "serverInfo": {
      "host": "Ronalds-MBP",
      "port": 27017,
      "version": "4.4.1",
      "gitVersion": "ad91a93a5a31e175f5cbf8c69561e788bbc55ce1"
   },
   "mergeType": "mongos",
   "splitPipeline": {
      "shardsPart": [
         {
            "$match": {
               "$and": [
                  {
                     "FL_DATE": {
                        "$gte": {
                           "$date": 1601510400000
                        }
                     }
                  },
                  {
                     "FL_DATE": {
                        "$lt": {
                           "$date": 1602806400000
                        }
                     }
                  }
               ]
            }
         },
         {
            "$group": {
               "_id": "$DEST",
               "count": {
                  "$sum": {
                     "$const": 1
                  }
               }
            }
         }
      ],
      "mergerPart": [
         {
            "$group": {
               "_id": "$$ROOT._id",
               "count": {
                  "$sum": "$$ROOT.count"
               },
               "$doingMerge": true
            }
         }
      ]
   },
   "shards": {
      "shard02": {
         "host": "localhost:27019",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 86608,
                     "executionTimeMillis": 399,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 335838,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 86608,
                        "executionTimeMillisEstimate": 24,
                        "works": 335840,
                        "advanced": 86608,
                        "needTime": 249231,
                        "needYield": 0,
                        "saveState": 339,
                        "restoreState": 339,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 86608,
                           "executionTimeMillisEstimate": 22,
                           "works": 335840,
                           "advanced": 86608,
                           "needTime": 249231,
                           "needYield": 0,
                           "saveState": 339,
                           "restoreState": 339,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 86608,
                              "executionTimeMillisEstimate": 9,
                              "works": 335840,
                              "advanced": 86608,
                              "needTime": 249231,
                              "needYield": 0,
                              "saveState": 339,
                              "restoreState": 339,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 335838
                           }
                        }
                     }
                  }
               },
               "nReturned": 86608,
               "executionTimeMillisEstimate": 343
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 364,
               "executionTimeMillisEstimate": 395
            }
         ]
      },
      "shard03": {
         "host": "localhost:27020",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 96045,
                     "executionTimeMillis": 428,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 339622,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 96045,
                        "executionTimeMillisEstimate": 37,
                        "works": 339624,
                        "advanced": 96045,
                        "needTime": 243578,
                        "needYield": 0,
                        "saveState": 343,
                        "restoreState": 343,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 96045,
                           "executionTimeMillisEstimate": 31,
                           "works": 339624,
                           "advanced": 96045,
                           "needTime": 243578,
                           "needYield": 0,
                           "saveState": 343,
                           "restoreState": 343,
                           "isEOF": 1,
                           "chunkSkips": 0,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 96045,
                              "executionTimeMillisEstimate": 19,
                              "works": 339624,
                              "advanced": 96045,
                              "needTime": 243578,
                              "needYield": 0,
                              "saveState": 343,
                              "restoreState": 343,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 339622
                           }
                        }
                     }
                  }
               },
               "nReturned": 96045,
               "executionTimeMillisEstimate": 366
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 365,
               "executionTimeMillisEstimate": 422
            }
         ]
      },
      "shard01": {
         "host": "localhost:27018",
         "stages": [
            {
               "$cursor": {
                  "queryPlanner": {
                     "plannerVersion": 1,
                     "namespace": "SummerResearch.AirlineData_range",
                     "indexFilterSet": false,
                     "parsedQuery": {
                        "$and": [
                           {
                              "FL_DATE": {
                                 "$lt": {
                                    "$date": 1602806400000
                                 }
                              }
                           },
                           {
                              "FL_DATE": {
                                 "$gte": {
                                    "$date": 1601510400000
                                 }
                              }
                           }
                        ]
                     },
                     "queryHash": "93BDA55F",
                     "planCacheKey": "93BDA55F",
                     "winningPlan": {
                        "stage": "PROJECTION_SIMPLE",
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "direction": "forward"
                           }
                        }
                     },
                     "rejectedPlans": []
                  },
                  "executionStats": {
                     "executionSuccess": true,
                     "nReturned": 0,
                     "executionTimeMillis": 524,
                     "totalKeysExamined": 0,
                     "totalDocsExamined": 750543,
                     "executionStages": {
                        "stage": "PROJECTION_SIMPLE",
                        "nReturned": 0,
                        "executionTimeMillisEstimate": 32,
                        "works": 750545,
                        "advanced": 0,
                        "needTime": 750544,
                        "needYield": 0,
                        "saveState": 751,
                        "restoreState": 751,
                        "isEOF": 1,
                        "transformBy": {
                           "DEST": 1,
                           "_id": 0
                        },
                        "inputStage": {
                           "stage": "SHARDING_FILTER",
                           "nReturned": 0,
                           "executionTimeMillisEstimate": 32,
                           "works": 750545,
                           "advanced": 0,
                           "needTime": 750544,
                           "needYield": 0,
                           "saveState": 751,
                           "restoreState": 751,
                           "isEOF": 1,
                           "chunkSkips": 169071,
                           "inputStage": {
                              "stage": "COLLSCAN",
                              "filter": {
                                 "$and": [
                                    {
                                       "FL_DATE": {
                                          "$lt": {
                                             "$date": 1602806400000
                                          }
                                       }
                                    },
                                    {
                                       "FL_DATE": {
                                          "$gte": {
                                             "$date": 1601510400000
                                          }
                                       }
                                    }
                                 ]
                              },
                              "nReturned": 169071,
                              "executionTimeMillisEstimate": 16,
                              "works": 750545,
                              "advanced": 169071,
                              "needTime": 581473,
                              "needYield": 0,
                              "saveState": 751,
                              "restoreState": 751,
                              "isEOF": 1,
                              "direction": "forward",
                              "docsExamined": 750543
                           }
                        }
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 524
            },
            {
               "$group": {
                  "_id": "$DEST",
                  "count": {
                     "$sum": {
                        "$const": 1
                     }
                  }
               },
               "nReturned": 0,
               "executionTimeMillisEstimate": 524
            }
         ]
      }
   },
   "ok": 1.0,
   "operationTime": {
      "$timestamp": {
         "t": 1613425636,
         "i": 1071
      }
   },
   "$clusterTime": {
      "clusterTime": {
         "$timestamp": {
            "t": 1613425636,
            "i": 1073
         }
      },
      "signature": {
         "hash": {
            "$binary": "AAAAAAAAAAAAAAAAAAAAAAAAAAA=",
            "$type": "00"
         },
         "keyId": 0
      }
   }
}
```

